var version='1.0.3';var cheat=false;var isMobileDevice=isMobileDevice();if(isMobileDevice){console.log('Detected mobile device.');$('.game-icons').css({'top':'3em'})}$('#version').text(version);var App=function(){var k;var J=false;var y=false;var I=null;var u=false;var S=1;var Y=0;var N=4;var O=4;var K=200;var T=[400,600,800,1500,5000];var L=2000;var D;var U=[200,200,200,300,400,400,600,500,400,600];var E=1000;var s;var F=[];var V;var l=0;var P;var r=100;var W;var v=1;var z=null;var p=false;var d={logo:'../img/logo.png',ship:'../img/ship.png',boom:{0:{file:'../img/animations/explosion/explode_4x4_ship.png',speed:30,x:4,y:4},1:{file:'../img/animations/explosion/explode_4x4_ring.png',speed:30,x:4,y:4},2:{file:'../img/animations/explosion/explode_5x3_enemy.png',speed:30,x:5,y:3}},fly_left:'../img/animations/ship/fly_left.png',fly_right:'../img/animations/ship/fly_right.png',shipBullet:'../img/bullets/bullet_ship.png',enemyBullets:{0:{file:'../img/bullets/bullet0.png',delay:600,damage:1},1:{file:'../img/bullets/bullet1.png',delay:500,damage:3},2:{file:'../img/bullets/bullet2.png',delay:400,damage:5},3:{file:'../img/bullets/bullet3.png',delay:300,damage:10},4:{file:'../img/bullets/bullet4.png',delay:200,damage:20}},enemies:{0:'../img/enemies/enemy0.png',1:'../img/enemies/enemy1.png',2:'../img/enemies/enemy2.png',3:'../img/enemies/enemy3.png',4:'../img/enemies/enemy4.png'},asteroids:{0:'../img/asteroids/asteroid0.png',1:'../img/asteroids/asteroid1.png',2:'../img/asteroids/asteroid2.png',3:'../img/asteroids/asteroid3.png',4:'../img/asteroids/asteroid4.png',5:'../img/asteroids/asteroid5.png',6:'../img/asteroids/asteroid6.png',7:'../img/asteroids/asteroid7.png',8:'../img/asteroids/asteroid8.png',9:'../img/asteroids/asteroid9.png'},healthIcon:'../img/icons/heart.png',levelIcon:'../img/icons/star.png',scoreIcon:'../img/icons/trophy.png'};var t={shoot:'../sounds/shoot.mp3',hit:'../sounds/hit.mp3',explode:'../sounds/explode.mp3',loop:'../sounds/loop.mp3'};var Z=document.getElementById('toggleRendererTitle');var Q=$('#toggleRendererBtn');var R=document.getElementById('toggleMusicTitle');var A=$('#toggleMusicBtn');wade.setLoadingBar(true,{x:0,y:0},'#333333','#222222');wade.setLoadingImages('../img/loading.svg');this.load=function(){var a;wade.loadImage(d.logo);wade.loadImage(d.ship);wade.loadImage(d.shipBullet);for(a=0;a<Object.keys(d.enemyBullets).length;a++){wade.loadImage(d.enemyBullets[a].file)}for(a=0;a<Object.keys(d.boom).length;a++){wade.loadImage(d.boom[a].file)}wade.loadImage(d.fly_left);wade.loadImage(d.fly_right);wade.loadImage(d.healthIcon);wade.loadImage(d.levelIcon);wade.loadImage(d.scoreIcon);for(a=0;a<Object.keys(d.enemies).length;a++){wade.loadImage(d.enemies[a])}for(a=0;a<Object.keys(d.asteroids).length;a++){wade.loadImage(d.asteroids[a])}wade.loadAudio(t.shoot);wade.loadAudio(t.hit);wade.loadAudio(t.explode);wade.loadAudio(t.loop)};this.init=function(){var a=wade.retrieveLocalObject('force2d');u=(a&&a.force2d)||u;u=(getCookie('force2d')=='true')||u;if(u){wade.setLayerRenderMode(S,'2d');Q.removeClass('fa-toggle-on');Q.addClass('fa-toggle-off');Z.title='Enable WebGL'}else{wade.setLayerRenderMode(S,'webgl');Q.removeClass('fa-toggle-off');Q.addClass('fa-toggle-on');Z.title='Disable WebGL'}if(wade.isWebAudioSupported()){var c=wade.retrieveLocalObject('music');p=(c&&c.music)||p;p=(getCookie('music')=='true')||p;if(p){A.removeClass('music-off');A.addClass('music-on');R.title='Disable music'}}else{p=false}wade.setMinScreenSize($(window).width(),$(window).height());wade.setMaxScreenSize($(window).width(),$(window).height());wade.setResolutionFactor(1);if(isMobileDevice){wade.setMinScreenSize($(window).width()*3,$(window).height()*3);wade.setMaxScreenSize($(window).width()*3,$(window).height()*3);wade.setResolutionFactor(0.5)}var e=wade.getLayerRenderMode(S);if(debug){log('browser screen size: '+$(window).width()+'x'+$(window).height()+', actual min screen size: '+wade.getMinScreenWidth()+'x'+wade.getMinScreenHeight()+', actual max screen size: '+wade.getMaxScreenWidth()+'x'+wade.getMaxScreenHeight()+', render-mode: '+e+', force2d: '+u+', isMobile: '+isMobileDevice)}var b=wade.retrieveLocalObject('shooterData');var f=(b&&b.oldHighScore)||0;var g=(b&&b.newHighScore)||0;var h=document.getElementById('game');var m=document.getElementById('game-icons');var i=f;var G='overkill_highscore';var B=getCookie(G);if(typeof(B)!='undefined'&&B!=null){if(B>f){f=B}}if(g>f){i=g}var j={insertCoin:'- INSERT COIN -',highscoreIs:'HIGHSCORE IS %i POINTS',youScored:'YOU %s %i POINTS'};if(e=='webgl'){j=padStrings(j)}var w=new TextSprite(j.insertCoin,'36pt Highspeed','white','center');w.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,w.draw));var q=new SceneObject();q.addSprite(w,{y:320});if(l>0){var H='SCORED';if(cheat){H='CHEATED'}var n=j.youScored.replace('%s',H);n=n.replace('%i',l);if(e=='webgl'){n=padStrings(n)}q.addSprite(new TextSprite(n,'24pt Highspeed','white','center'),{y:120});if(g>f){var x='NEW HIGHSCORE';if(cheat){x+=' NOT SAVED'}x+='!';if(e=='webgl'){x=padStrings(x)}var M=new TextSprite(x,'24pt Highspeed','yellow','center');q.addSprite(M,{y:160})}}if(l<=0||f>=g){j.highscoreIs=j.highscoreIs.replace('%i',i);q.addSprite(new TextSprite(j.highscoreIs,'24pt Highspeed','yellow','center'),{y:160})}if(!cheat){setCookie(G,i,365);b={oldHighScore:i,newHighScore:g};wade.storeLocalObject('shooterData',b)}q.addSprite(new Sprite(d.logo),{y:-200});I=new SceneObject();var C=new TextSprite('PAUSED','32pt Highspeed','yellow','center');C.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,C.draw));I.addSprite(new Sprite(d.logo),{y:-200});I.addSprite(C,{y:160});m.style.display='block';game.style.cursor='default';wade.addSceneObject(q);s=setTimeout(wade.app.spawnAsteroid,E);if(wade.isWebAudioSupported()){if(p&&z==null){z=wade.playAudio(t.loop,true);if(z<0){A.removeClass('music-on');A.addClass('music-off');R.title='Enable music';p=false}}}wade.app.onMouseDown=function(){if(wade.isMouseDown(0)||(wade.isMouseDown()&&isMobileDevice)){m.style.display='none';game.style.cursor='none';clearTimeout(s);wade.removeSceneObject(q);wade.clearScene();wade.app.startGame();wade.app.onMouseDown=0}}};this.startGame=function(){var B=new Sprite(d.ship);var j=wade.getMousePosition();k=new SceneObject(B,0,j.x,j.y);wade.addSceneObject(k);wade.setMainLoop(function(){O=N;if(wade.isMouseDown(2)&&cheat){O=50}var a=Y+1/O;var c=wade.getAppTime();if((wade.isMouseDown(0)||wade.isMouseDown(2)||(wade.isMouseDown()&&isMobileDevice))&&c>=a){Y=c;var e=k.getPosition();var b=k.getSprite().getSize();var f=new Sprite(d.shipBullet);var g=new SceneObject(f,0,e.x,e.y-b.y/2);wade.addSceneObject(g);wade.playAudio(t.shoot,false);F.push(g);g.moveTo(e.x,-500,600);g.onMoveComplete=function(){wade.removeSceneObject(this);wade.removeObjectFromArray(this,F)};if(l>0&&!cheat&&O<60){l-=10}if(l<0||l=='NaN'){l=0}}if(F.length>0){for(var h=F.length-1;h>=0;h--){var m=F[h].getOverlappingObjects();if(m.length>0){for(var i=0;i<m.length;i++){if(m[i].isEnemy){var G=m[i].getPosition();wade.app.explosion(G,1);wade.playAudio(t.hit,false);if(m[i].health>0){m[i].health-=K}if(m[i].health<=0){wade.app.explosion(G,2);wade.playAudio(t.explode,false);wade.removeSceneObject(m[i]);l+=Math.floor(m[i].initialHealth/10)*v}wade.removeSceneObject(F[h]);wade.removeObjectFromArrayByIndex(h,F);break}}}}}if(Math.floor(l/1000)>v-1&&v<5){v+=1;if(!cheat){r=100}if(L>200){L-=100}if(E>400){E-=100}if(N<50){N+=1}if(K<600){K+=(v*10)}}P.getSprite().setText(r);W.getSprite().setText(v);V.getSprite().setText(Math.floor(l))},'fire');wade.setMainLoop(function(){var a=k.getOverlappingObjects(false,'axis-aligned');var c=false;var e=1;if(a.length>0){for(var b=0;b<a.length;b++){if(typeof(a[b])!='undefined'){if(a[b].isEnemy||a[b].isEnemyBullet){if(typeof(a[b])!='undefined'&&k.overlapsObject(a[b],'pixel')){if(a[b].health>0){a[b].health-=Math.floor(K/10)}if(typeof(a[b])!='undefined'&&(a[b].isEnemyBullet||a[b].health<=0)){wade.removeSceneObject(a[b]);wade.removeObjectFromArrayByIndex(b,a)}if(typeof(a[b])!='undefined'){e=a[b].damage||e}c=true;break}}}}}if(c){c=false;wade.app.explosion(k.getPosition(),0);wade.playAudio(t.hit,false);if(r>0){r-=e}if(r<0||r=='NaN'){r=0}P.getSprite().setText(r);if(r<=0){wade.app.explosion(k.getPosition(),2);wade.playAudio(t.explode,false);wade.removeSceneObject(k);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');var f=wade.retrieveLocalObject('shooterData');var g=(f&&f.oldHighScore)||0;if(l>g){f={oldHighScore:g,newHighScore:l};wade.storeLocalObject('shooterData',f)}var h=setTimeout(function(){y=false;clearTimeout(D);clearTimeout(s);wade.clearScene();wade.app.init()},250)}}},'die');if(!y){if(cheat){r=999}else{r=100}l=0;v=1;N=4;K=200;y=true}var w=new Sprite(d.scoreIcon);var q=new SceneObject(w,0,wade.getScreenWidth()/2-20,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(q);var H=new TextSprite(l.toString(),'32pt Highspeed','#f88','right');V=new SceneObject(H,0,wade.getScreenWidth()/2-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(V);var n=new Sprite(d.healthIcon);var x=new SceneObject(n,0,-120,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(x);var M=new TextSprite(r.toString(),'32pt Highspeed','#f88','center');P=new SceneObject(M,0,-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(P);var C=new Sprite(d.levelIcon);var X=new SceneObject(C,0,20-(wade.getScreenWidth()/2),-12-wade.getScreenHeight()/2+30);wade.addSceneObject(X);var o=new TextSprite(v,'32pt Highspeed','#f88','left');W=new SceneObject(o,0,40-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(W);D=setTimeout(wade.app.spawnEnemy,L);s=setTimeout(wade.app.spawnAsteroid,E)};$(window).blur(function(){if(y&&!J){console.log('Game paused due to focus loss.');J=true;wade.pauseSimulation();clearTimeout(D);clearTimeout(s);wade.app.onMouseMove=null;wade.addSceneObject(I);game.style.cursor='default'}else{if(!y){console.log('Asteroid timeout cleared due to focus loss.');clearTimeout(s)}}return false});$(window).focus(function(){if(!y){s=setTimeout(wade.app.spawnAsteroid,E)}});this.onKeyDown=function(c){if(y&&c.keyCode==32){J=!J;if(J){wade.pauseSimulation();clearTimeout(D);clearTimeout(s);wade.app.onMouseMove=null;wade.addSceneObject(I);game.style.cursor='default'}else{game.style.cursor='none';D=setTimeout(wade.app.spawnEnemy,L);s=setTimeout(wade.app.spawnAsteroid,E);wade.removeSceneObject(I);wade.resumeSimulation();wade.app.onMouseMove=function(a){if(typeof(k)!='undefined'){handleMouseMove(k,d,a)}}}}return false};this.onMouseMove=function(a){if(typeof(k)!='undefined'){return handleMouseMove(k,d,a)}};this.explosion=function(a,c){if(typeof(c)=='undefined'||c==null||typeof(d.boom[c])=='undefined'){c=0}var e=new Animation(d.boom[c].file,d.boom[c].x,d.boom[c].y,d.boom[c].speed);var b=new Sprite();b.setSize(100,100);b.addAnimation('boom',e);var f=new SceneObject(b,0,a.x,a.y);wade.addSceneObject(f);f.playAnimation('boom');f.onAnimationEnd=function(){wade.removeSceneObject(this)}};this.spawnAsteroid=function(){var a;var c=getRandomInt(0,9);a=new Sprite(d.asteroids[c]);var e=(Math.random()-0.5)*wade.getScreenWidth();var b=(Math.random()-0.5)*wade.getScreenWidth();var f=-wade.getScreenHeight()/2-a.getSize().y/2;var g=-f;var h=new SceneObject(a,0,e,f);wade.addSceneObject(h);h.moveTo(b,g,200);h.isEnemy=true;h.isAsteroid=true;h.health=U[c];h.initialHealth=U[c];h.damage=Math.floor(U[c]/100);h.onMoveComplete=function(){wade.removeSceneObject(this)};s=setTimeout(wade.app.spawnAsteroid,E)};this.spawnEnemy=function(){var w;var q=v-1;var H=Object.keys(d.enemies).length-1;if(q>H){q=H}var n=getRandomInt(0,q);w=new Sprite(d.enemies[n]);var x=(Math.random()-0.5)*wade.getScreenWidth();var M=(Math.random()-0.5)*wade.getScreenWidth();var C=-wade.getScreenHeight()/2-w.getSize().y/2;var X=-C;var o=new SceneObject(w,0,x,C);wade.addSceneObject(o);o.moveTo(M,X,200);o.isEnemy=true;o.isAsteroid=false;o.health=T[n];o.initialHealth=T[n];o.damage=Math.floor(T[n]/100);o.onMoveComplete=function(){wade.removeSceneObject(this)};o.originalStep=o.step;o.step=function(){this.originalStep();var a=this.getPosition();var c=k.getPosition();var e=Math.atan2(c.y-a.y,c.x-a.x)-3.14/2;this.setRotation(e)};o.fire=function(){var a=this.getSprite().getSize();var c=this.getPosition();var e=k.getPosition();var b=e.x-c.x;var f=e.y-c.y;var g=Math.sqrt(b*b+f*f);b/=g;f/=g;var h=c.x+b*a.x/2;var m=c.y+f*a.y/2;var i=h+b*3000;var G=m+f*3000;var B=new Sprite(d.enemyBullets[n].file);var j=new SceneObject(B,0,h,m);j.isEnemyBullet=true;j.damage=d.enemyBullets[n].damage;wade.addSceneObject(j);j.moveTo(i,G,200);j.onMoveComplete=function(){wade.removeSceneObject(this)};this.schedule(d.enemyBullets[n].delay,'fire')};o.schedule(300,'fire');D=setTimeout(wade.app.spawnEnemy,L)};this.toggleRenderer=function(){u=!u;var a={force2d:u};wade.storeLocalObject('force2d',a);setCookie('force2d',u,365);clearTimeout(D);clearTimeout(s);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');y=false;wade.clearScene();wade.app.init()};this.toggleMusic=function(){if(wade.isWebAudioSupported()){if(p){if(z>-1){wade.stopAudio(z)}else{wade.stopAudio()}p=false;A.removeClass('music-on');A.addClass('music-off');R.title='Enable music'}else{if(z>-1){wade.stopAudio(z)}else{wade.stopAudio()}z=wade.playAudio(t.loop,true);p=true;A.removeClass('music-off');A.addClass('music-on');R.title='Disable music'}var a={music:p};wade.storeLocalObject('music',a);setCookie('music',p,365)}}};function getRandomInt(a,c){return Math.floor(Math.random()*(c-a+1))+a}function padStrings(a){var c='       ';var e;if(typeof(a)=='object'){e={};for(var b in a){e[b]=c+a[b]+c}}else{e=c+a+c}return e}function handleMouseMove(a,c,e){var b=a.getPosition();var f=a.getSprite();var g=null;if(b.x<0){if(b.x>e.screenPosition.x){g=new Animation(c.fly_left,5,1,30)}else if(b.x<e.screenPosition.x){g=new Animation(c.fly_right,5,1,30)}}else if(b.x>0){if(b.x<e.screenPosition.x){g=new Animation(c.fly_right,5,1,30)}else if(b.x>e.screenPosition.x){g=new Animation(c.fly_left,5,1,30)}}if(g!=null){f.addAnimation('fly',g);a.playAnimation('fly');a.onAnimationEnd=function(){f.setImageFile(c.ship)}}return a&&a.setPosition(e.screenPosition.x,e.screenPosition.y)}