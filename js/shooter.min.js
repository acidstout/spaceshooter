var version="1.1.0";$("#version").text(version);var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var a="";var k,h,f,j,g,e,d;var b=0;c=Base64._utf8_encode(c);while(b<c.length){k=c.charCodeAt(b++);h=c.charCodeAt(b++);f=c.charCodeAt(b++);j=k>>2;g=((k&3)<<4)|(h>>4);e=((h&15)<<2)|(f>>6);d=f&63;if(isNaN(h)){e=d=64}else{if(isNaN(f)){d=64}}a=a+this._keyStr.charAt(j)+this._keyStr.charAt(g)+this._keyStr.charAt(e)+this._keyStr.charAt(d)}return a},decode:function(c){var a="";var k,h,f;var j,g,e,d;var b=0;c=c.replace("/[^A-Za-z0-9+/=]/g","");while(b<c.length){j=this._keyStr.indexOf(c.charAt(b++));g=this._keyStr.indexOf(c.charAt(b++));e=this._keyStr.indexOf(c.charAt(b++));d=this._keyStr.indexOf(c.charAt(b++));k=(j<<2)|(g>>4);h=((g&15)<<4)|(e>>2);f=((e&3)<<6)|d;a=a+String.fromCharCode(k);if(e!=64){a=a+String.fromCharCode(h)}if(d!=64){a=a+String.fromCharCode(f)}}a=Base64._utf8_decode(a);return a},_utf8_encode:function(b){b=b.replace("/\r\n/g","\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},_utf8_decode:function(a){var c="";var e=0,f=0,d=0,b=0;while(e<a.length){f=a.charCodeAt(e);if(f<128){c+=String.fromCharCode(f);e++}else{if((f>191)&&(f<224)){b=a.charCodeAt(e+1);c+=String.fromCharCode(((f&31)<<6)|(b&63));e+=2}else{b=a.charCodeAt(e+1);d=a.charCodeAt(e+2);c+=String.fromCharCode(((f&15)<<12)|((b&63)<<6)|(d&63));e+=3}}}return c}};function getRandomInt(b,a){return Math.floor(Math.random()*(a-b+1))+b}function padStrings(d){var c="       ";var b;if(typeof(d)==="object"){b={};for(var a in d){if({}.hasOwnProperty.call(d,a)){b[a]=c+d[a]+c}}}else{b=c+d+c}return b}function handleMouseMove(f,a,d){var c=f.getPosition();var b=f.getSprite();var e=null;if(c.x<0){if(c.x>d.screenPosition.x){e=new Animation(a.flyLeft,5,1,30)}else{if(c.x<d.screenPosition.x){e=new Animation(a.flyRight,5,1,30)}}}else{if(c.x>0){if(c.x<d.screenPosition.x){e=new Animation(a.flyRight,5,1,30)}else{if(c.x>d.screenPosition.x){e=new Animation(a.flyLeft,5,1,30)}}}}if(e!==null){b.addAnimation("fly",e);f.playAnimation("fly");f.onAnimationEnd=function(){b.setImageFile(a.ship)}}return f&&f.setPosition(d.screenPosition.x,d.screenPosition.y)}var App=function(){var l=false||checkForMobileDevice();var r=false||getBrowserVersion("Trident/([0-9]{1,}[.0-9]{0,})");var D;var L=false;var n=false;var M=null;var H=false;var K=1;var s=0;var I=4;var q=4;var t=200;var A=[400,600,800,1500,5000];var G=2000;var z;var i=[200,200,200,300,400,400,600,500,400,600];var e=1000;var J;var v=[];var C;var b=0;var g={data:"overkill"};var y;var h=100;var k;var f=1;var a=null;var d=false;var F=wade.retrieveLocalObject(g.data);const u=(F&&F.sissy)||false;var m=(F&&F.highscore)||0;var c={logo:"../img/logo.png",ship:"../img/ship.png",boom:{0:{file:"../img/animations/explosion/explode_4x4_ship.png",speed:30,x:4,y:4},1:{file:"../img/animations/explosion/explode_4x4_ring.png",speed:30,x:4,y:4},2:{file:"../img/animations/explosion/explode_5x3_enemy.png",speed:30,x:5,y:3}},flyLeft:"../img/animations/ship/fly_left.png",flyRight:"../img/animations/ship/fly_right.png",shipBullet:"../img/bullets/bullet_ship.png",enemyBullets:{0:{file:"../img/bullets/bullet0.png",delay:600,damage:1},1:{file:"../img/bullets/bullet1.png",delay:500,damage:3},2:{file:"../img/bullets/bullet2.png",delay:400,damage:5},3:{file:"../img/bullets/bullet3.png",delay:300,damage:10},4:{file:"../img/bullets/bullet4.png",delay:200,damage:20}},enemies:{0:"../img/enemies/enemy0.png",1:"../img/enemies/enemy1.png",2:"../img/enemies/enemy2.png",3:"../img/enemies/enemy3.png",4:"../img/enemies/enemy4.png"},asteroids:{0:"../img/asteroids/asteroid0.png",1:"../img/asteroids/asteroid1.png",2:"../img/asteroids/asteroid2.png",3:"../img/asteroids/asteroid3.png",4:"../img/asteroids/asteroid4.png",5:"../img/asteroids/asteroid5.png",6:"../img/asteroids/asteroid6.png",7:"../img/asteroids/asteroid7.png",8:"../img/asteroids/asteroid8.png",9:"../img/asteroids/asteroid9.png"},healthIcon:"../img/icons/heart.png",levelIcon:"../img/icons/star.png",scoreIcon:"../img/icons/trophy.png"};var o={shoot:"../sounds/shoot.mp3",hit:"../sounds/hit.mp3",explode:"../sounds/explode.mp3",loop:"../sounds/loop.mp3"};var x=document.getElementById("toggleRendererTitle");var p=$("#toggleRendererBtn");var w=document.getElementById("toggleMusicTitle");var j=$("#toggleMusicBtn");var B=document.getElementById("game");var E=document.getElementById("game-icons");wade.preventIframe();wade.setLoadingBar(true,{x:0,y:0},"#333333","#222222");wade.setLoadingImages("../img/loading.svg");this.load=function(){var N=0;wade.loadImage(c.logo);wade.loadImage(c.ship);wade.loadImage(c.shipBullet);for(N=0;N<Object.keys(c.enemyBullets).length;N++){wade.loadImage(c.enemyBullets[N].file)}for(N=0;N<Object.keys(c.boom).length;N++){wade.loadImage(c.boom[N].file)}wade.loadImage(c.flyLeft);wade.loadImage(c.flyRight);wade.loadImage(c.healthIcon);wade.loadImage(c.levelIcon);wade.loadImage(c.scoreIcon);for(N=0;N<Object.keys(c.enemies).length;N++){wade.loadImage(c.enemies[N])}for(N=0;N<Object.keys(c.asteroids).length;N++){wade.loadImage(c.asteroids[N])}var O=wade.isWebAudioSupported()?"loadAudio":"preloadAudio";wade[O](o.shoot);wade[O](o.hit);wade[O](o.explode);wade[O](o.loop)};this.init=function(){F=wade.retrieveLocalObject(g.data);H=(F&&F.force2d)||H;if(H){wade.setLayerRenderMode(K,"2d");p.removeClass("fa-toggle-on");p.addClass("fa-toggle-off");x.title="Enable WebGL"}else{wade.setLayerRenderMode(K,"webgl");p.removeClass("fa-toggle-off");p.addClass("fa-toggle-on");x.title="Disable WebGL"}if(wade.isWebAudioSupported()){d=(F&&F.music)||d;if(d){j.removeClass("music-off");j.addClass("music-on");w.title="Disable music"}}else{d=false}wade.setMinScreenSize($(window).width(),$(window).height());wade.setMaxScreenSize($(window).width(),$(window).height());wade.setResolutionFactor(1);if(l){wade.setMinScreenSize($(window).width()*3,$(window).height()*3);wade.setMaxScreenSize($(window).width()*3,$(window).height()*3);wade.setResolutionFactor(0.5)}var V=wade.getLayerRenderMode(K);if(debug){log("\n\t\tbrowser screen size   : "+$(window).width()+"x"+$(window).height()+"\n\t\tactual min screen size: "+wade.getMinScreenWidth()+"x"+wade.getMinScreenHeight()+"\n\t\tactual max screen size: "+wade.getMaxScreenWidth()+"x"+wade.getMaxScreenHeight()+"\n\t\trender-mode           : "+V+"\n\t\tforce2D               : "+H+"\n\t\tisMobile              : "+l+"\n\t\tisSissy               : "+u+"\n\t\tcurrent score         : "+b+"\n\t\thighscore             : "+m+"\n\t\tlevel                 : "+f+"\n\t\tplayer health         : "+h+"\n\t\tfire rate             : "+I+"\n\t\tfire damage           : "+t)}var S={insertCoin:"- INSERT COIN -",highscoreIs:"HIGHSCORE IS %i POINTS",youScored:"YOU %s %i POINTS"};if(V==="webgl"){S=padStrings(S)}var T=new TextSprite(S.insertCoin,"36pt Highspeed","white","center");T.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,T.draw));var Q=new SceneObject();Q.addSprite(T,{y:320});if(b<=0||m>=b){S.highscoreIs=S.highscoreIs.replace("%i",m);Q.addSprite(new TextSprite(S.highscoreIs,"24pt Highspeed","yellow","center"),{y:160})}if(b>0){var U=Base64.decode("U0NPUkVE");if(u){U=Base64.decode("Q0hFQVRFRA==")}var N=S.youScored.replace("%s",U);N=N.replace("%i",b);if(V==="webgl"){N=padStrings(N)}Q.addSprite(new TextSprite(N,"24pt Highspeed","white","center"),{y:120});if(b>m){var P=Base64.decode("TkVXIEhJR0hTQ09SRQ==");m=b;if(u){P+=Base64.decode("IE5PVCBTQVZFRA==")}P+="!";if(V==="webgl"){P=padStrings(P)}var R=new TextSprite(P,"24pt Highspeed","yellow","center");Q.addSprite(R,{y:160})}}if(!u){F={force2d:H,music:d,highscore:m};wade.storeLocalObject(g.data,F)}Q.addSprite(new Sprite(c.logo),{y:-200});M=new SceneObject();var O=new TextSprite("PAUSED","32pt Highspeed","yellow","center");O.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,O.draw));M.addSprite(new Sprite(c.logo),{y:-200});M.addSprite(O,{y:160});E.style.display="block";B.style.cursor="default";wade.addSceneObject(Q);J=setTimeout(wade.app.spawnAsteroid,e);if(wade.isWebAudioSupported()){if(d&&a===null){a=wade.playAudio(o.loop,true);if(a<0){j.removeClass("music-on");j.addClass("music-off");w.title="Enable music";d=false}}}wade.app.onMouseDown=function(){if(wade.isMouseDown(0)||(wade.isMouseDown()&&(l||r))){E.style.display="none";B.style.cursor="none";clearTimeout(J);wade.removeSceneObject(Q);wade.clearScene();wade.removeUnusedLayers([1]);wade.app.startGame();wade.app.onMouseDown=0}}};this.startGame=function(){var U=new Sprite(c.ship);var X=wade.getMousePosition();D=new SceneObject(U,0,X.x,X.y);wade.addSceneObject(D);wade.setMainLoop(function(){q=I;if(wade.isMouseDown(2)&&u){q=50}var ag=s+1/q;var Z=wade.getAppTime();if((wade.isMouseDown(0)||wade.isMouseDown(2)||(wade.isMouseDown()&&(l||r)))&&Z>=ag){s=Z;var ab=D.getPosition();var ae=D.getSprite().getSize();var ah=new Sprite(c.shipBullet);var Y=new SceneObject(ah,0,ab.x,ab.y-ae.y/2);wade.addSceneObject(Y);wade.playAudio(o.shoot,false);v.push(Y);Y.moveTo(ab.x,-500,600);Y.onMoveComplete=function(){wade.removeSceneObject(this);wade.removeObjectFromArray(this,v)};if(b>0&&!u&&q<60){b-=10}if(b<0||b==="NaN"){b=0}}if(v.length>0){for(var ac=v.length-1;ac>=0;ac--){var af=v[ac].getOverlappingObjects();if(af.length>0){for(var aa=0;aa<af.length;aa++){if(af[aa].isEnemy){var ad=af[aa].getPosition();wade.app.explosion(ad,1);wade.playAudio(o.hit,false);if(af[aa].health>0){af[aa].health-=t}if(af[aa].health<=0){wade.app.explosion(ad,2);wade.playAudio(o.explode,false);wade.removeSceneObject(af[aa]);b+=Math.floor(af[aa].initialHealth/10)*f}wade.removeSceneObject(v[ac]);wade.removeObjectFromArrayByIndex(ac,v);break}}}}}if(Math.floor(b/1000)>f-1&&f<5){f+=1;if(!u){h=100}if(G>200){G-=100}if(e>400){e-=100}if(I<50){I+=1}if(t<600){t+=(f*10)}}y.getSprite().setText(h);k.getSprite().setText(f);C.getSprite().setText(Math.floor(b))},"fire");wade.setMainLoop(function(){var Z=D.getOverlappingObjects(false,"axis-aligned");var ac=false;var Y=1;if(Z.length>0){for(var aa=0;aa<Z.length;aa++){if(typeof(Z[aa])!=="undefined"){if(Z[aa].isEnemy||Z[aa].isEnemyBullet){if(typeof(Z[aa])!=="undefined"&&D.overlapsObject(Z[aa],"pixel")){if(Z[aa].health>0){Z[aa].health-=Math.floor(t/10)}if(typeof(Z[aa])!=="undefined"&&(Z[aa].isEnemyBullet||Z[aa].health<=0)){wade.removeSceneObject(Z[aa]);wade.removeObjectFromArrayByIndex(aa,Z)}if(typeof(Z[aa])!=="undefined"){Y=Z[aa].damage||Y}ac=true;break}}}}}if(ac){ac=false;wade.app.explosion(D.getPosition(),0);wade.playAudio(o.hit,false);if(h>0){h-=Y}if(h<0||h==="NaN"){h=0}y.getSprite().setText(h)}if(h<=0){var ad=wade.app.explosion(D.getPosition(),2);wade.playAudio(o.explode,false);wade.removeSceneObject(D);wade.setMainLoop(null,"fire");wade.setMainLoop(null,"die");if(!u&&b>m){F={force2d:H,music:d,highscore:b};wade.storeLocalObject(g.data,F)}var ab=setInterval(function(){if(!ad.isPlaying()){n=false;clearInterval(ab);clearTimeout(z);clearTimeout(J);wade.clearScene();wade.app.init()}},100)}},"die");if(!n){if(u){h=999}else{h=100}b=0;f=1;I=4;t=200;n=true}var S=new Sprite(c.scoreIcon);var T=new SceneObject(S,0,wade.getScreenWidth()/2-20,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(T);var V=new TextSprite(b.toString(),"32pt Highspeed","#f88","right");C=new SceneObject(V,0,wade.getScreenWidth()/2-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(C);var O=new Sprite(c.healthIcon);var P=new SceneObject(O,0,-120,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(P);var W=new TextSprite(h.toString(),"32pt Highspeed","#f88","center");y=new SceneObject(W,0,-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(y);var Q=new Sprite(c.levelIcon);var N=new SceneObject(Q,0,20-(wade.getScreenWidth()/2),-12-wade.getScreenHeight()/2+30);wade.addSceneObject(N);var R=new TextSprite(f,"32pt Highspeed","#f88","left");k=new SceneObject(R,0,40-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(k);z=setTimeout(wade.app.spawnEnemy,G);J=setTimeout(wade.app.spawnAsteroid,e)};this.pauseGame=function(){wade.pauseSimulation();clearTimeout(z);clearTimeout(J);wade.app.onMouseMove=null;wade.addSceneObject(M);B.style.cursor="default";return false};$(window).blur(function(){if(n&&!L){console.log("Game paused due to focus loss.");L=true;wade.app.pauseGame()}else{if(!n){console.log("Asteroid timeout cleared due to focus loss.");clearTimeout(J)}}return false});$(window).focus(function(){if(!n){J=setTimeout(wade.app.spawnAsteroid,e)}});this.onKeyDown=function(N){if(n&&N.keyCode===32){L=!L;if(L){wade.app.pauseGame()}else{B.style.cursor="none";z=setTimeout(wade.app.spawnEnemy,G);J=setTimeout(wade.app.spawnAsteroid,e);wade.removeSceneObject(M);wade.resumeSimulation();wade.app.onMouseMove=function(O){if(typeof(D)!=="undefined"){handleMouseMove(D,c,O)}}}}return false};this.onMouseMove=function(N){if(typeof(D)!=="undefined"){return handleMouseMove(D,c,N)}};this.explosion=function(O,P){if(typeof(P)==="undefined"||P===null||typeof(c.boom[P])==="undefined"){P=0}var Q=new Animation(c.boom[P].file,c.boom[P].x,c.boom[P].y,c.boom[P].speed);var N=new Sprite();N.setSize(100,100);N.addAnimation("boom",Q);var R=new SceneObject(N,0,O.x,O.y);wade.addSceneObject(R);R.playAnimation("boom");R.onAnimationEnd=function(){wade.removeSceneObject(this)};return Q};this.getRandomCoords=function(N){return{x1:(Math.random()-0.5)*wade.getScreenWidth(),y1:-wade.getScreenHeight()/2-N.getSize().y/2,x2:(Math.random()-0.5)*wade.getScreenWidth(),y2:Math.abs(wade.getScreenHeight()/2-N.getSize().y/2)}};this.spawnAsteroid=function(){var O;var P=getRandomInt(0,9);O=new Sprite(c.asteroids[P]);var Q=wade.app.getRandomCoords(O);var N=new SceneObject(O,0,Q.x1,Q.y1);wade.addSceneObject(N);N.moveTo(Q.x2,Q.y2,200);N.isEnemy=true;N.isAsteroid=true;N.health=i[P];N.initialHealth=i[P];N.damage=Math.floor(i[P]/100);N.onMoveComplete=function(){wade.removeSceneObject(this)};J=setTimeout(wade.app.spawnAsteroid,e)};this.spawnEnemy=function(){var P;var O=f-1;var Q=Object.keys(c.enemies).length-1;if(O>Q){O=Q}var S=getRandomInt(0,O);P=new Sprite(c.enemies[S]);var R=wade.app.getRandomCoords(P);var N=new SceneObject(P,0,R.x1,R.y1);wade.addSceneObject(N);N.moveTo(R.x2,R.y2,200);N.isEnemy=true;N.isAsteroid=false;N.health=A[S];N.initialHealth=A[S];N.damage=Math.floor(A[S]/100);N.onMoveComplete=function(){wade.removeSceneObject(this)};N.originalStep=N.step;N.step=function(){this.originalStep();var T=this.getPosition();var U=D.getPosition();var V=Math.atan2(U.y-T.y,U.x-T.x)-3.14/2;this.setRotation(V)};N.fire=function(){var ad=this.getSprite().getSize();var Z=this.getPosition();var X=D.getPosition();var ae=X.x-Z.x;var ac=X.y-Z.y;var U=Math.sqrt(ae*ae+ac*ac);ae/=U;ac/=U;var W=Z.x+ae*ad.x/2;var V=Z.y+ac*ad.y/2;var ab=W+ae*3000;var aa=V+ac*3000;var Y=new Sprite(c.enemyBullets[S].file);var T=new SceneObject(Y,0,W,V);T.isEnemyBullet=true;T.damage=c.enemyBullets[S].damage;wade.addSceneObject(T);T.moveTo(ab,aa,200);T.onMoveComplete=function(){wade.removeSceneObject(this)};this.schedule(c.enemyBullets[S].delay,"fire")};N.schedule(300,"fire");z=setTimeout(wade.app.spawnEnemy,G)};this.toggleRenderer=function(){H=!H;F={force2d:H,music:d,highscore:m};wade.storeLocalObject(g.data,F);clearTimeout(z);clearTimeout(J);wade.setMainLoop(null,"fire");wade.setMainLoop(null,"die");n=false;wade.clearScene();wade.app.init()};this.toggleMusic=function(){if(d){d=false;j.removeClass("music-on");j.addClass("music-off");w.title="Enable music";if(r){F={force2d:H,music:d,highscore:m};wade.storeLocalObject(g.data,F);location.reload()}else{if(a>-1){wade.stopAudio(a)}else{wade.stopAudio()}}}else{if(a>-1){wade.stopAudio(a)}else{wade.stopAudio()}a=wade.playAudio(o.loop,true);d=true;j.removeClass("music-off");j.addClass("music-on");w.title="Disable music"}F={force2d:H,music:d,highscore:m};wade.storeLocalObject(g.data,F);return false}};