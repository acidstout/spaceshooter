var version='1.1.4';var Base64={_0:'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',encode(input){'use strict';var output='';var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=Base64._1(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64}else if(isNaN(chr3)){enc4=64}output=output+this._0.charAt(enc1)+this._0.charAt(enc2)+this._0.charAt(enc3)+this._0.charAt(enc4)}return output},decode(input){'use strict';var output='';var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace('/[^A-Za-z0-9+/=]/g','');while(i<input.length){enc1=this._0.indexOf(input.charAt(i++));enc2=this._0.indexOf(input.charAt(i++));enc3=this._0.indexOf(input.charAt(i++));enc4=this._0.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!==64){output=output+String.fromCharCode(chr2)}if(enc4!==64){output=output+String.fromCharCode(chr3)}}output=Base64._2(output);return output},_1(string){'use strict';string=string.replace('/\r\n/g','\n');var utftext='';for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c)}else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128)}else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128)}}return utftext},_2(utftext){'use strict';var string='';var i=0,c1=0,c2=0,c3=0;while(i<utftext.length){c1=utftext.charCodeAt(i);if(c1<128){string+=String.fromCharCode(c1);i++}else if((c1>191)&&(c1<224)){c3=utftext.charCodeAt(i+1);string+=String.fromCharCode(((c1&31)<<6)|(c3&63));i+=2}else{c3=utftext.charCodeAt(i+1);c2=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c1&15)<<12)|((c3&63)<<6)|(c2&63));i+=3}}return string}};var App=function(){'use strict';var Y=false||checkForMobileDevice();var be=false||getBrowserVersion('Trident/([0-9]{1,}[.0-9]{0,})');var q;var B=false;var v=false;var L=null;var w=false;var H=1;var bf=0;var Q=4;var R=4;var M=200;var Z=[400,600,800,1500,5000];var N=2000;var I;var ba=[200,200,200,300,400,400,600,500,400,600];var C=1000;var x;var D=[];var bb;var j=0;var S=1000;var J={data:'overkill'};var T;var s=100;var bc;var u=1;var E=null;var l=false;var o=wade.retrieveLocalObject(J.data);const sissy=(o&&o.sissy)||false;var F=(o&&o.highscore)||0;var f={logo:'../img/logo.png',ship:'../img/ship.png',boom:{0:{file:'../img/animations/explosion/explode_4x4_ship.png',speed:30,x:4,y:4},1:{file:'../img/animations/explosion/explode_4x4_ring.png',speed:30,x:4,y:4},2:{file:'../img/animations/explosion/explode_5x3_enemy.png',speed:30,x:5,y:3}},flyLeft:'../img/animations/ship/fly_left.png',flyRight:'../img/animations/ship/fly_right.png',shipBullet:'../img/bullets/bullet_ship.png',enemyBullets:{0:{file:'../img/bullets/bullet0.png',delay:600,damage:1},1:{file:'../img/bullets/bullet1.png',delay:500,damage:3},2:{file:'../img/bullets/bullet2.png',delay:400,damage:5},3:{file:'../img/bullets/bullet3.png',delay:300,damage:10},4:{file:'../img/bullets/bullet4.png',delay:200,damage:20}},enemies:{0:'../img/enemies/enemy0.png',1:'../img/enemies/enemy1.png',2:'../img/enemies/enemy2.png',3:'../img/enemies/enemy3.png',4:'../img/enemies/enemy4.png'},asteroids:{0:'../img/asteroids/asteroid0.png',1:'../img/asteroids/asteroid1.png',2:'../img/asteroids/asteroid2.png',3:'../img/asteroids/asteroid3.png',4:'../img/asteroids/asteroid4.png',5:'../img/asteroids/asteroid5.png',6:'../img/asteroids/asteroid6.png',7:'../img/asteroids/asteroid7.png',8:'../img/asteroids/asteroid8.png',9:'../img/asteroids/asteroid9.png'},healthIcon:'../img/icons/heart.png',levelIcon:'../img/icons/star.png',scoreIcon:'../img/icons/trophy.png'};var t={shoot:'../sounds/shoot.mp3',hit:'../sounds/hit.mp3',explode:'../sounds/explode.mp3',loop:'../sounds/loop.mp3',menu:'../sounds/menu.mp3'};var bg=document.getElementById('toggleRendererTitle');var U=$('#toggleRendererBtn');var V=document.getElementById('toggleMusicTitle');var z=$('#toggleMusicBtn');var W=document.getElementById('game');var bh=document.getElementById('game-icons');$('#version').text(version+', WADE '+wade.getVersion());$(window).blur(function(){console.log('Game paused due to focus loss.');wade.app.pauseGame();if(v&&!B){B=true}});$(window).focus(function(){if(!v){console.log('Game resumed due to focus gain.');x=setTimeout(wade.app.spawnAsteroid,C);if(l){wade.app.musicOn()}wade.resumeSimulation()}});wade.preventIframe();wade.setLoadingBar(true,{x:0,y:0},'#333333','#222222');wade.setLoadingImages('../img/loading.svg');this.padStrings=function(a){var b='       ';var e;if(typeof(a)==='object'){e={};for(var d in a){if({}.hasOwnProperty.call(a,d)){e[d]=b+a[d]+b}}}else{e=b+a+b}return e};this.load=function(){var a=0;for(a=0;a<Object.keys(f.asteroids).length;a++){wade.loadImage(f.asteroids[a])}wade.loadImage(f.logo);for(a=0;a<Object.keys(f.boom).length;a++){wade.loadImage(f.boom[a].file)}wade.loadImage(f.shipBullet);for(a=0;a<Object.keys(f.enemyBullets).length;a++){wade.loadImage(f.enemyBullets[a].file)}for(a=0;a<Object.keys(f.enemies).length;a++){wade.loadImage(f.enemies[a])}wade.loadImage(f.ship);wade.loadImage(f.flyLeft);wade.loadImage(f.flyRight);wade.loadImage(f.healthIcon);wade.loadImage(f.levelIcon);wade.loadImage(f.scoreIcon);var b=wade.isWebAudioSupported()?'loadAudio':'preloadAudio';wade[b](t.shoot);wade[b](t.hit);wade[b](t.explode);wade[b](t.loop);wade[b](t.menu);var e=null;e=setInterval(function(){console.log('Loaded '+Math.round(wade.getLoadingPercentage())+'% of data.');if(wade.getLoadingPercentage()>=100){clearInterval(e)}},1000)};this.init=function(){o=wade.retrieveLocalObject(J.data);w=(o&&o.force2d)||w;wade.setLayerRenderMode(H,'2d');wade.useQuadtree(H,false);U.removeClass('fa-toggle-on');U.addClass('fa-toggle-off');bg.title='Enable WebGL';if(!w){wade.setLayerRenderMode(H,'webgl');U.removeClass('fa-toggle-off');U.addClass('fa-toggle-on');bg.title='Disable WebGL'}if(wade.isWebAudioSupported()){l=(o&&o.music)||l;if(wade.getWebAudioContext().state=='suspended'){l=false}if(l){z.removeClass('music-off');z.addClass('music-on');V.title='Disable music'}}else{l=false}wade.setMinScreenSize($(window).width(),$(window).height());wade.setMaxScreenSize($(window).width(),$(window).height());wade.setResolutionFactor(1);if(Y){wade.setMinScreenSize($(window).width()*3,$(window).height()*3);wade.setMaxScreenSize($(window).width()*3,$(window).height()*3);wade.setResolutionFactor(0.5)}var a=wade.getLayerRenderMode(H);var b={insertCoin:'- INSERT COIN -',highscoreIs:'HIGHSCORE IS %i POINTS',youScored:'YOU %s %i POINTS'};if(a==='webgl'){b=wade.app.padStrings(b)}var e=new TextSprite(b.insertCoin,'36pt Highspeed','white','center');e.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,e.draw));var d=new SceneObject();d.addSprite(e,{y:320});wade.app.getHighestScore(j,d,b);if(j>0){var h=Base64.decode('U0NPUkVE');if(sissy){h=Base64.decode('Q0hFQVRFRA==')}else{wade.app.saveHighscore(j)}var g=b.youScored.replace('%s',h);g=g.replace('%i',j);if(a==='webgl'){g=wade.app.padStrings(g)}d.addSprite(new TextSprite(g,'24pt Highspeed','white','center'),{y:120});if(j>F){var k=Base64.decode('TkVXIEhJR0hTQ09SRQ==');F=j;j=0;if(sissy){k+=Base64.decode('IE5PVCBTQVZFRA==')}k+='!';if(a==='webgl'){k=wade.app.padStrings(k)}var p=new TextSprite(k,'24pt Highspeed','yellow','center');d.addSprite(p,{y:160})}}d.addSprite(new Sprite(f.logo),{y:-200});L=new SceneObject();var m=new TextSprite('PAUSED','32pt Highspeed','yellow','center');m.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,m.draw));L.addSprite(new Sprite(f.logo),{y:-200});L.addSprite(m,{y:160});bh.style.display='block';W.style.cursor='default';wade.addSceneObject(d);var G=null;G=setTimeout(function(){if(wade.getLoadingPercentage()>=100){console.log('Initializing asteroids on main screen.');x=setTimeout(wade.app.spawnAsteroid,C);clearInterval(G)}},1000);if(l){wade.app.musicOn()}wade.app.onMouseDown=function(){if(wade.isMouseDown(0)||(wade.isMouseDown()&&(Y||be))){bh.style.display='none';W.style.cursor='none';clearTimeout(x);wade.removeSceneObject(d);wade.clearScene();wade.removeUnusedLayers([1]);wade.clearCanvas(H);wade.app.onMouseDown=0;wade.app.startGame()}}};this.getHighestScore=function(d,h,g){var k=setInterval(function(){var a={'action':'getHighestScore'};var b=JSON.stringify(a);var e=Base64.encode(b);$.ajax({url:'php/backend.php',type:'POST',data:'data='+e,success(result){if(result==null||result==''||result=='FAILED'){result=F}if(d<=0||result>d){g.highscoreIs=g.highscoreIs.replace('%i',result);h.addSprite(new TextSprite(g.highscoreIs,'24pt Highspeed','yellow','center'),{y:160})}F=result;clearTimeout(k)},error(xhr,status,code){console.warn('getHighestScore(): AJAX call returned: '+status+': '+code)}})},1000)};this.loadHighscore=function(){var e={'action':'loadScore'};var d=JSON.stringify(e);var h=Base64.encode(d);var g='Highscore not loaded!';var k=(typeof(k)!=='undefined')?k:false;$.ajax({url:'php/backend.php',type:'POST',data:'data='+h,success(result){if(result!='FAILED'){var p=JSON.parse(result);var m='';$.each(p,function(a,b){m+='<tr><td>'+b.player+'</td><td>'+b.score+'</td></tr>'});$('#highscoreTable').html(m)}},error(xhr,status,code){console.warn('AJAX call returned: '+status+': '+code);$('.msg').html(g)}})};this.saveHighscore=function(a,b){a=(typeof(a)!=='undefined')?a:j;b=(typeof(b)!=='undefined')?b:'Player';var e='Highscore not saved!';var d={'action':'saveScore','player':b,'score':a};var h=JSON.stringify(d);var g=Base64.encode(h);$.ajax({url:'php/backend.php',type:'POST',data:'data='+g,success(result){if(result=='OK'){e='Highscore saved!'}else{o={force2d:w,music:l,highscore:a};wade.storeLocalObject(J.data,o)}$('.msg').html(e)},error(xhr,status,code){console.warn('saveHighscore() returned: '+status+': '+code);$('.msg').html(e)}})};this.handleMouseMove=function(a,b,e){var d=a.getPosition();var h=a.getSprite();var g=null;if(d.x<0){if(d.x>e.screenPosition.x){g=new Animation(b.flyLeft,5,1,30)}else if(d.x<e.screenPosition.x){g=new Animation(b.flyRight,5,1,30)}}else if(d.x>0){if(d.x<e.screenPosition.x){g=new Animation(b.flyRight,5,1,30)}else if(d.x>e.screenPosition.x){g=new Animation(b.flyLeft,5,1,30)}}if(g!==null){h.addAnimation('fly',g);a.playAnimation('fly');a.onAnimationEnd=function(){h.setImageFile(b.ship)}}return a&&a.setPosition(e.screenPosition.x,e.screenPosition.y)};this.startGame=function(){console.log('Re-enabling quadtree optimizations.');wade.useQuadtree(H,true);var bd=new Sprite(f.ship);var A=wade.getMousePosition();q=new SceneObject(bd,0,A.x,A.y);wade.addSceneObject(q);wade.setMainLoop(function(){R=Q;if(wade.isMouseDown(2)&&sissy){R=50}var a=bf+1/R;var b=wade.getAppTime();if((wade.isMouseDown(0)||wade.isMouseDown(2)||(wade.isMouseDown()&&(Y||be)))&&b>=a){bf=b;var e=q.getPosition();var d=q.getSprite().getSize();var h=new Sprite(f.shipBullet);var g=new SceneObject(h,0,e.x,e.y-d.y/2);wade.addSceneObject(g);wade.playAudio(t.shoot,false);D.push(g);g.moveTo(e.x,-500,600);g.onMoveComplete=function(){wade.removeSceneObject(this);wade.removeObjectFromArray(this,D)};if(j>0&&!sissy&&R<60){j-=10}if(j<0||j==='NaN'){j=0}}if(D.length>0){for(var k=D.length-1;k>=0;k--){var p=D[k].getOverlappingObjects();if(p.length>0){for(var m=0;m<p.length;m++){if(p[m].isEnemy){var G=p[m].getPosition();wade.app.explosion(G,1);wade.playAudio(t.hit,false);if(p[m].health>0){p[m].health-=M}if(p[m].health<=0){wade.app.explosion(G,2);wade.playAudio(t.explode,false);wade.removeSceneObject(p[m]);j+=Math.floor(p[m].initialHealth/10)*u}wade.removeSceneObject(D[k]);wade.removeObjectFromArrayByIndex(k,D);break}}}}}if(Math.floor(j/S)>u-1&&u<5){S=S*Math.pow(10,u);u+=1;if(!sissy){s=100}if(N>200){N-=100}if(C>400){C-=100}if(Q<50){Q+=1}if(M<600){M+=(u*10)}}T.getSprite().setText(s);bc.getSprite().setText(u);bb.getSprite().setText(Math.floor(j)+', Left: '+(S-Math.floor(j)))},'fire');wade.setMainLoop(function(){var a=q.getOverlappingObjects(false,'axis-aligned');var b=false;var e=1;if(a.length>0){for(var d=0;d<a.length;d++){if(typeof(a[d])!=='undefined'){if(a[d].isEnemy||a[d].isEnemyBullet){if(typeof(a[d])!=='undefined'&&q.overlapsObject(a[d],'pixel')){if(a[d].health>0){a[d].health-=Math.floor(M/10)}if(typeof(a[d])!=='undefined'&&(a[d].isEnemyBullet||a[d].health<=0)){wade.removeSceneObject(a[d]);wade.removeObjectFromArrayByIndex(d,a)}if(typeof(a[d])!=='undefined'){e=a[d].damage||e}b=true;break}}}}}if(b){b=false;wade.app.explosion(q.getPosition(),0);wade.playAudio(t.hit,false);if(s>0){s-=e}if(s<0||s==='NaN'){s=0}T.getSprite().setText(s)}if(s<=0){var h=wade.app.explosion(q.getPosition(),2);wade.playAudio(t.explode,false);wade.removeSceneObject(q);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');if(!sissy&&j>F){o={force2d:w,music:l,highscore:j};wade.storeLocalObject(J.data,o)}var g=setInterval(function(){if(!h.isPlaying()){v=false;if(l){wade.app.musicOn()}clearInterval(g);clearTimeout(I);clearTimeout(x);wade.clearScene();wade.app.init()}},100)}},'die');if(!v){if(sissy){s=999}else{s=100}j=0;u=1;Q=4;M=200;v=true;if(l){wade.app.musicOn()}}var O=new Sprite(f.scoreIcon);var P=new SceneObject(O,0,wade.getScreenWidth()/2-20,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(P);var X=new TextSprite(j.toString(),'32pt Highspeed','#f88','right');bb=new SceneObject(X,0,wade.getScreenWidth()/2-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(bb);var y=new Sprite(f.healthIcon);var K=new SceneObject(y,0,-120,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(K);var r=new TextSprite(s.toString(),'32pt Highspeed','#f88','center');T=new SceneObject(r,0,-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(T);var bi=new Sprite(f.levelIcon);var bj=new SceneObject(bi,0,20-(wade.getScreenWidth()/2),-12-wade.getScreenHeight()/2+30);wade.addSceneObject(bj);var bk=new TextSprite(u,'32pt Highspeed','#f88','left');bc=new SceneObject(bk,0,40-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(bc);I=setTimeout(wade.app.spawnEnemy,N);x=setTimeout(wade.app.spawnAsteroid,C)};this.pauseGame=function(){clearTimeout(x);wade.app.musicOff();if(v){clearTimeout(I);wade.app.onMouseMove=null;wade.addSceneObject(L);W.style.cursor='default'}wade.pauseSimulation();return false};this.onKeyDown=function(b){if(v&&b.keyCode===32){B=!B;if(B){console.log('Game paused by user.');wade.app.pauseGame()}else{console.log('Game resumed by user.');W.style.cursor='none';I=setTimeout(wade.app.spawnEnemy,N);x=setTimeout(wade.app.spawnAsteroid,C);wade.removeSceneObject(L);if(l){wade.app.musicOn()}wade.resumeSimulation();wade.app.onMouseMove=function(a){if(typeof(q)!=='undefined'){wade.app.handleMouseMove(q,f,a)}}}}return false};this.onMouseMove=function(a){if(typeof(q)!=='undefined'){return wade.app.handleMouseMove(q,f,a)}};this.explosion=function(a,b){if(typeof(b)==='undefined'||b===null||typeof(f.boom[b])==='undefined'){b=0}var e=new Animation(f.boom[b].file,f.boom[b].x,f.boom[b].y,f.boom[b].speed);var d=new Sprite();d.setSize(100,100);d.addAnimation('boom',e);var h=new SceneObject(d,0,a.x,a.y);wade.addSceneObject(h);h.playAnimation('boom');h.onAnimationEnd=function(){wade.removeSceneObject(this)};return e};this.getRandomCoords=function(a){return{x1:(Math.random()-0.5)*wade.getScreenWidth(),y1:-wade.getScreenHeight()/2-a.getSize().y/2,x2:(Math.random()-0.5)*wade.getScreenWidth(),y2:Math.abs(wade.getScreenHeight()/2-a.getSize().y/2)}};this.getRandomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};this.spawnAsteroid=function(){if(B){return false}var a;var b=wade.app.getRandomInt(0,9);a=new Sprite(f.asteroids[b]);var e=wade.app.getRandomCoords(a);var d=new SceneObject(a,0,e.x1,e.y1);wade.addSceneObject(d);d.moveTo(e.x2,e.y2,200);d.isEnemy=true;d.isAsteroid=true;d.health=ba[b];d.initialHealth=ba[b];d.damage=Math.floor(ba[b]/100);d.onMoveComplete=function(){wade.removeSceneObject(this)};x=setTimeout(wade.app.spawnAsteroid,C)};this.spawnEnemy=function(){if(B){return false}var O;var P=u-1;var X=Object.keys(f.enemies).length-1;if(P>X){P=X}var y=wade.app.getRandomInt(0,P);O=new Sprite(f.enemies[y]);var K=wade.app.getRandomCoords(O);var r=new SceneObject(O,0,K.x1,K.y1);wade.addSceneObject(r);r.moveTo(K.x2,K.y2,200);r.isEnemy=true;r.isAsteroid=false;r.health=Z[y];r.initialHealth=Z[y];r.damage=Math.floor(Z[y]/100);r.onMoveComplete=function(){wade.removeSceneObject(this)};r.originalStep=r.step;r.step=function(){this.originalStep();var a=this.getPosition();var b=q.getPosition();var e=Math.atan2(b.y-a.y,b.x-a.x)-3.14/2;this.setRotation(e)};r.fire=function(){var a=this.getSprite().getSize();var b=this.getPosition();var e=q.getPosition();var d=e.x-b.x;var h=e.y-b.y;var g=Math.sqrt(d*d+h*h);d/=g;h/=g;var k=b.x+d*a.x/2;var p=b.y+h*a.y/2;var m=k+d*3000;var G=p+h*3000;var bd=new Sprite(f.enemyBullets[y].file);var A=new SceneObject(bd,0,k,p);A.isEnemyBullet=true;A.damage=f.enemyBullets[y].damage;wade.addSceneObject(A);A.moveTo(m,G,200);A.onMoveComplete=function(){wade.removeSceneObject(this)};this.schedule(f.enemyBullets[y].delay,'fire')};r.schedule(300,'fire');I=setTimeout(wade.app.spawnEnemy,N)};this.toggleRenderer=function(){w=!w;o={force2d:w,music:l,highscore:F};wade.storeLocalObject(J.data,o);clearTimeout(I);clearTimeout(x);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');v=false;wade.clearScene();wade.app.init()};this.musicOn=function(){if(E>-1){wade.stopAudio(E)}else{wade.stopAudio()}if(v){E=wade.playAudio(t.loop,true)}else{E=wade.playAudio(t.menu,true)}if(E<0){z.removeClass('music-on');z.addClass('music-off');V.title='Enable music';l=false}return false};this.musicOff=function(){if(E>-1){wade.stopAudio(E)}else{wade.stopAudio()}return false};this.toggleMusic=function(){var a=wade.getWebAudioContext();if(a.state=='suspended'){a.resume().then(()=>{console.log('Audio context resumed.')})}if(l){l=false;z.removeClass('music-on');z.addClass('music-off');V.title='Enable music';wade.app.musicOff()}else{l=true;z.removeClass('music-off');z.addClass('music-on');V.title='Disable music';wade.app.musicOn()}o={force2d:w,music:l,highscore:F};wade.storeLocalObject(J.data,o);return false}};