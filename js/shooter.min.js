var cheat=false;var App=function(){var b;var a=false;var A=false;var e=null;var w=false;var d=1;var o=0;var p=4;var s=4;var y=200;var n=[400,600,800,1500,5000];var q=2000;var f;var v=[200,200,200,300,400,400,600,500,400,600];var t=1000;var i;var j=[];var x;var r=0;var z;var u=100;var h;var c=1;var l={logo:"../img/logo.png",ship:"../img/ship.png",boom:{0:{file:"../img/animations/explode_4x4_ship.png",speed:30,x:4,y:4},1:{file:"../img/animations/explode_4x4_ring.png",speed:30,x:4,y:4},2:{file:"../img/animations/explode_5x3_enemy.png",speed:30,x:5,y:3}},shipBullet:"../img/bullets/bullet_ship.png",enemyBullets:{0:{file:"../img/bullets/bullet0.png",delay:600,damage:1},1:{file:"../img/bullets/bullet1.png",delay:500,damage:3},2:{file:"../img/bullets/bullet2.png",delay:400,damage:5},3:{file:"../img/bullets/bullet3.png",delay:300,damage:10},4:{file:"../img/bullets/bullet4.png",delay:200,damage:20}},enemies:{0:"../img/enemies/enemy0.png",1:"../img/enemies/enemy1.png",2:"../img/enemies/enemy2.png",3:"../img/enemies/enemy3.png",4:"../img/enemies/enemy4.png"},asteroids:{0:"../img/asteroids/asteroid0.png",1:"../img/asteroids/asteroid1.png",2:"../img/asteroids/asteroid2.png",3:"../img/asteroids/asteroid3.png",4:"../img/asteroids/asteroid4.png",5:"../img/asteroids/asteroid5.png",6:"../img/asteroids/asteroid6.png",7:"../img/asteroids/asteroid7.png",8:"../img/asteroids/asteroid8.png",9:"../img/asteroids/asteroid9.png"},healthIcon:"../img/icons/heart.png",levelIcon:"../img/icons/star.png",scoreIcon:"../img/icons/trophy.png"};var m={shoot:"../sounds/shoot.mp3",hit:"../sounds/hit.mp3",explode:"../sounds/explode.mp3"};var g=document.getElementById("toggleTitle");var k=$("#toggleRendererBtn");this.load=function(){wade.loadImage(l.logo);wade.loadImage(l.ship);wade.loadImage(l.shipBullet);for(var B=0;B<Object.keys(l.enemyBullets).length;B++){wade.loadImage(l.enemyBullets[B].file)}for(var B=0;B<Object.keys(l.boom).length;B++){wade.loadImage(l.boom[B].file)}wade.loadImage(l.healthIcon);wade.loadImage(l.levelIcon);wade.loadImage(l.scoreIcon);for(var B=0;B<Object.keys(l.enemies).length;B++){wade.loadImage(l.enemies[B])}for(var B=0;B<Object.keys(l.asteroids).length;B++){wade.loadImage(l.asteroids[B])}wade.loadAudio(m.shoot);wade.loadAudio(m.hit);wade.loadAudio(m.explode)};this.init=function(){var C=wade.retrieveLocalObject("force2d");w=(C&&C.force2d)||w;w=(getCookie("force2d")=="true")||w;if(w){wade.setLayerRenderMode(d,"2d");k.removeClass("fa-toggle-on");k.addClass("fa-toggle-off");g.title="Enable WebGL"}else{wade.setLayerRenderMode(d,"webgl");k.removeClass("fa-toggle-off");k.addClass("fa-toggle-on");g.title="Disable WebGL"}wade.setMinScreenSize($(window).width(),$(window).height());wade.setMaxScreenSize($(window).width(),$(window).height());var R=wade.getLayerRenderMode(d);var M=wade.retrieveLocalObject("shooterData");var Q=(M&&M.oldHighScore)||0;var L=(M&&M.newHighScore)||0;var G=document.getElementById("game");var P=document.getElementById("game-icons");var B=Q;var N="overkill_highscore";var I=getCookie(N);if(typeof(I)!="undefined"&&I!=null){if(I>Q){Q=I}}if(L>Q){B=L}var H={insertCoin:"- INSERT COIN -",highscoreIs:"HIGHSCORE IS %i POINTS",youScored:"YOU %s %i POINTS"};if(R=="webgl"){H=padStrings(H)}var F=new TextSprite(H.insertCoin,"36pt Highspeed","white","center");F.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,F.draw));var S=new SceneObject();S.addSprite(F,{y:320});if(r>0){var O="SCORED";if(cheat){O="CHEATED"}var E=H.youScored.replace("%s",O);E=E.replace("%i",r);if(R=="webgl"){E=padStrings(E)}S.addSprite(new TextSprite(E,"24pt Highspeed","white","center"),{y:120});if(L>Q){var D="NEW HIGHSCORE";if(cheat){D+=" NOT SAVED"}D+="!";if(R=="webgl"){D=padStrings(D)}var K=new TextSprite(D,"24pt Highspeed","yellow","center");S.addSprite(K,{y:160})}}if(r<=0||Q>=L){H.highscoreIs=H.highscoreIs.replace("%i",B);S.addSprite(new TextSprite(H.highscoreIs,"24pt Highspeed","yellow","center"),{y:160})}if(!cheat){setCookie(N,B,365);M={oldHighScore:B,newHighScore:L};wade.storeLocalObject("shooterData",M)}S.addSprite(new Sprite(l.logo),{y:-200});e=new SceneObject();var J=new TextSprite("PAUSED","32pt Highspeed","yellow","center");J.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,J.draw));e.addSprite(new Sprite(l.logo),{y:-200});e.addSprite(J,{y:160});P.style.display="block";game.style.cursor="default";wade.addSceneObject(S);i=setTimeout(wade.app.spawnAsteroid,t);wade.app.onMouseDown=function(){if(wade.isMouseDown("0")){P.style.display="none";game.style.cursor="none";clearTimeout(i);wade.removeSceneObject(S);wade.clearScene();wade.app.startGame();wade.app.onMouseDown=0}}};this.startGame=function(){var I=new Sprite(l.ship);var L=wade.getMousePosition();b=new SceneObject(I,0,L.x,L.y);wade.addSceneObject(b);wade.setMainLoop(function(){s=p;if(wade.isMouseDown("2")&&cheat){s=50}var U=o+1/s;var N=wade.getAppTime();if((wade.isMouseDown("0")||wade.isMouseDown("2"))&&N>=U){o=N;var P=b.getPosition();var S=b.getSprite().getSize();var V=new Sprite(l.shipBullet);var M=new SceneObject(V,0,P.x,P.y-S.y/2);wade.addSceneObject(M);wade.playAudio(m.shoot,false);j.push(M);M.moveTo(P.x,-500,600);M.onMoveComplete=function(){wade.removeSceneObject(this);wade.removeObjectFromArray(this,j)};if(r>0&&!cheat&&s<60){r-=10}if(r<0||r=="NaN"){r=0}}if(j.length>0){for(var Q=j.length-1;Q>=0;Q--){var T=j[Q].getOverlappingObjects();if(T.length>0){for(var O=0;O<T.length;O++){if(T[O].isEnemy){var R=T[O].getPosition();wade.app.explosion(R,1);wade.playAudio(m.hit,false);if(T[O].health>0){T[O].health-=y}if(T[O].health<=0){wade.app.explosion(R,2);wade.playAudio(m.explode,false);wade.removeSceneObject(T[O]);r+=Math.floor(T[O].initialHealth/10)*c}wade.removeSceneObject(j[Q]);wade.removeObjectFromArrayByIndex(Q,j);break}}}}}if(Math.floor(r/1000)>c&&c<5){c+=1;if(!cheat){u=100}if(q>200){q-=100}if(t>400){t-=100}if(p<50){p+=1}if(y<600){y+=(c*10)}}z.getSprite().setText(u);h.getSprite().setText(c);x.getSprite().setText(Math.floor(r))},"fire");wade.setMainLoop(function(){var N=b.getOverlappingObjects(false,"axis-aligned");var S=false;var M=1;if(N.length>0){for(var Q=0;Q<N.length;Q++){if(typeof(N[Q])!="undefined"){if(N[Q].isEnemy||N[Q].isEnemyBullet){if(typeof(N[Q])!="undefined"&&b.overlapsObject(N[Q],"pixel")){if(N[Q].health>0){N[Q].health-=Math.floor(y/10)}if(typeof(N[Q])!="undefined"&&(N[Q].isEnemyBullet||N[Q].health<=0)){wade.removeSceneObject(N[Q]);wade.removeObjectFromArrayByIndex(Q,N)}if(typeof(N[Q])!="undefined"){M=N[Q].damage||M}S=true;break}}}}}if(S){S=false;wade.app.explosion(b.getPosition(),0);wade.playAudio(m.hit,false);if(u>0){u-=M}if(u<0||u=="NaN"){u=0}z.getSprite().setText(u);if(u<=0){wade.app.explosion(b.getPosition(),2);wade.playAudio(m.explode,false);wade.removeSceneObject(b);wade.setMainLoop(null,"fire");wade.setMainLoop(null,"die");var O=wade.retrieveLocalObject("shooterData");var R=(O&&O.oldHighScore)||0;if(r>R){O={oldHighScore:R,newHighScore:r};wade.storeLocalObject("shooterData",O)}var P=setTimeout(function(){A=false;clearTimeout(f);clearTimeout(i);wade.clearScene();wade.app.init()},250)}}},"die");if(!A){if(cheat){u=999}else{u=100}r=0;c=1;A=true}var G=new Sprite(l.scoreIcon);var H=new SceneObject(G,0,wade.getScreenWidth()/2-20,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(H);var J=new TextSprite(r.toString(),"32pt Highspeed","#f88","right");x=new SceneObject(J,0,wade.getScreenWidth()/2-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(x);var C=new Sprite(l.healthIcon);var D=new SceneObject(C,0,-120,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(D);var K=new TextSprite(u.toString(),"32pt Highspeed","#f88","center");z=new SceneObject(K,0,-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(z);var E=new Sprite(l.levelIcon);var B=new SceneObject(E,0,20-(wade.getScreenWidth()/2),-12-wade.getScreenHeight()/2+30);wade.addSceneObject(B);var F=new TextSprite(c,"32pt Highspeed","#f88","left");h=new SceneObject(F,0,40-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(h);f=setTimeout(wade.app.spawnEnemy,q);i=setTimeout(wade.app.spawnAsteroid,t)};$(window).blur(function(){if(A&&!a){console.log("Game paused due to focus loss.");a=true;wade.pauseSimulation();clearTimeout(f);clearTimeout(i);wade.app.onMouseMove=null;wade.addSceneObject(e);game.style.cursor="default"}else{if(!A){console.log("Asteroid timeout cleared due to focus loss.");clearTimeout(i)}}return false});$(window).focus(function(){if(!A){i=setTimeout(wade.app.spawnAsteroid,t)}});this.onKeyDown=function(B){if(A&&B.keyCode==32){a=!a;if(a){wade.pauseSimulation();clearTimeout(f);clearTimeout(i);wade.app.onMouseMove=null;wade.addSceneObject(e);game.style.cursor="default"}else{game.style.cursor="none";f=setTimeout(wade.app.spawnEnemy,q);i=setTimeout(wade.app.spawnAsteroid,t);wade.removeSceneObject(e);wade.resumeSimulation();wade.app.onMouseMove=function(C){b&&b.setPosition(C.screenPosition.x,C.screenPosition.y)}}}return false};this.onMouseMove=function(B){b&&b.setPosition(B.screenPosition.x,B.screenPosition.y)};this.explosion=function(C,D){if(typeof(D)=="undefined"||D==null||typeof(l.boom[D])=="undefined"){D=0}var E=new Animation(l.boom[D].file,l.boom[D].x,l.boom[D].y,l.boom[D].speed);var B=new Sprite();B.setSize(100,100);B.addAnimation("boom",E);var F=new SceneObject(B,0,C.x,C.y);wade.addSceneObject(F);F.playAnimation("boom");F.onAnimationEnd=function(){wade.removeSceneObject(this)}};this.spawnAsteroid=function(){var E;var G=getRandomInt(0,9);E=new Sprite(l.asteroids[G]);var C=(Math.random()-0.5)*wade.getScreenWidth();var H=(Math.random()-0.5)*wade.getScreenWidth();var B=-wade.getScreenHeight()/2-E.getSize().y/2;var F=-B;var D=new SceneObject(E,0,C,B);wade.addSceneObject(D);D.moveTo(H,F,200);D.isEnemy=true;D.isAsteroid=true;D.health=v[G];D.initialHealth=v[G];D.damage=Math.floor(v[G]/100);D.onMoveComplete=function(){wade.removeSceneObject(this)};i=setTimeout(wade.app.spawnAsteroid,t)};this.spawnEnemy=function(){var G;var B=c-1;var E=Object.keys(l.enemies).length-1;if(B>E){B=E}var I=getRandomInt(0,B);G=new Sprite(l.enemies[I]);var F=(Math.random()-0.5)*wade.getScreenWidth();var J=(Math.random()-0.5)*wade.getScreenWidth();var D=-wade.getScreenHeight()/2-G.getSize().y/2;var H=-D;var C=new SceneObject(G,0,F,D);wade.addSceneObject(C);C.moveTo(J,H,200);C.isEnemy=true;C.isAsteroid=false;C.health=n[I];C.initialHealth=n[I];C.damage=Math.floor(n[I]/100);C.onMoveComplete=function(){wade.removeSceneObject(this)};C.originalStep=C.step;C.step=function(){this.originalStep();var K=this.getPosition();var L=b.getPosition();var M=Math.atan2(L.y-K.y,L.x-K.x)-3.14/2;this.setRotation(M)};C.fire=function(){var U=this.getSprite().getSize();var Q=this.getPosition();var O=b.getPosition();var V=O.x-Q.x;var T=O.y-Q.y;var L=Math.sqrt(V*V+T*T);V/=L;T/=L;var N=Q.x+V*U.x/2;var M=Q.y+T*U.y/2;var S=N+V*3000;var R=M+T*3000;var P=new Sprite(l.enemyBullets[I].file);var K=new SceneObject(P,0,N,M);K.isEnemyBullet=true;K.damage=l.enemyBullets[I].damage;wade.addSceneObject(K);K.moveTo(S,R,200);K.onMoveComplete=function(){wade.removeSceneObject(this)};this.schedule(l.enemyBullets[I].delay,"fire")};C.schedule(300,"fire");f=setTimeout(wade.app.spawnEnemy,q)};this.toggleRenderer=function(){w=!w;var B={force2d:w};wade.storeLocalObject("force2d",B);setCookie("force2d",w,365);clearTimeout(f);clearTimeout(i);wade.setMainLoop(null,"fire");wade.setMainLoop(null,"die");A=false;wade.clearScene();wade.app.init()}};function getRandomInt(b,a){return Math.floor(Math.random()*(a-b+1))+b}function padStrings(d){var c="       ";if(typeof(d)=="object"){var b={};for(var a in d){b[a]=c+d[a]+c}}else{b=c+d+c}return b};