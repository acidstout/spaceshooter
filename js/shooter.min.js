var version='1.1.9';var App=function(){'use strict';var bf=false||checkForMobileDevice();var bj=false||getBrowserVersion('Trident/([0-9]{1,}[.0-9]{0,})');var q;var y=false;var z=false;var P=null;var A=false;var L=1;var bk=0;var V=4;var W=4;var Q=200;var bn=1000;var t={missiles:{fired:0,hit:0},bullets:{fired:-1,hit:0}};var bg=[400,600,800,1500,5000];var M=2000;var N;var bh=[200,200,200,300,400,400,600,500,400,600];var B=1000;var C;var D={cannister:{images:['../img/powerups/cannister0.png','../img/powerups/cannister1.png','../img/powerups/cannister2.png'],values:[100,1000,10000],name:'cannister'},heart:{images:['../img/powerups/heart0.png','../img/powerups/heart1.png','../img/powerups/heart2.png'],values:[5,10,20],name:'heart'},missiles:{images:['../img/powerups/missiles0.png','../img/powerups/missiles1.png','../img/powerups/missiles2.png'],values:[25,50,100],name:'missiles'},shield:{images:['../img/powerups/shield0.png','../img/powerups/shield1.png','../img/powerups/shield2.png'],values:[4,7,10],name:'shield'},targeting:{images:['../img/powerups/targeting0.png','../img/powerups/targeting1.png','../img/powerups/targeting2.png'],values:[10,20,30],name:'targeting'}};var H=[];var x=0;var u=0;var E=0;var X;var i=0;var R=1000;var O={data:'overkill'};var Y;var Z;var ba;var S;var s=100;var bi;var v=1;var I=null;var m=false;var o=wade.retrieveLocalObject(O.data);const sissy=(o&&o.sissy)||false;var J=(o&&o.highscore)||0;var e={logo:'../img/logo.png',ship:'../img/ship.png',boom:{0:{file:'../img/animations/explosion/explode_4x4_ship.png',speed:30,x:4,y:4},1:{file:'../img/animations/explosion/explode_4x4_ring.png',speed:30,x:4,y:4},2:{file:'../img/animations/explosion/explode_5x3_enemy.png',speed:30,x:5,y:3}},flyLeft:'../img/animations/ship/fly_left.png',flyRight:'../img/animations/ship/fly_right.png',shipBullet:'../img/bullets/bullet_ship.png',shipMissile:'../img/bullets/missile_ship.png',enemyBullets:{0:{file:'../img/bullets/bullet0.png',delay:600,damage:1},1:{file:'../img/bullets/bullet1.png',delay:500,damage:3},2:{file:'../img/bullets/bullet2.png',delay:400,damage:5},3:{file:'../img/bullets/bullet3.png',delay:300,damage:10},4:{file:'../img/bullets/bullet4.png',delay:200,damage:20}},enemies:{0:'../img/enemies/enemy0.png',1:'../img/enemies/enemy1.png',2:'../img/enemies/enemy2.png',3:'../img/enemies/enemy3.png',4:'../img/enemies/enemy4.png'},asteroids:{0:'../img/asteroids/asteroid0.png',1:'../img/asteroids/asteroid1.png',2:'../img/asteroids/asteroid2.png',3:'../img/asteroids/asteroid3.png',4:'../img/asteroids/asteroid4.png',5:'../img/asteroids/asteroid5.png',6:'../img/asteroids/asteroid6.png',7:'../img/asteroids/asteroid7.png',8:'../img/asteroids/asteroid8.png',9:'../img/asteroids/asteroid9.png'},healthIcon:'../img/icons/heart.png',levelIcon:'../img/icons/star.png',scoreIcon:'../img/icons/trophy.png',missilesIcon:'../img/icons/missiles.png',shieldsIcon:'../img/icons/shields.png',targetingIcon:'../img/icons/targeting.png'};var n={shoot:'../sounds/shoot.mp3',missile:'../sounds/missile.mp3',hit:'../sounds/hit.mp3',explode:'../sounds/explode.mp3',loop:'../sounds/loop.mp3',menu:'../sounds/menu.mp3',spawn:'../sounds/spawn.mp3',powerup:'../sounds/powerup.mp3'};var bl=document.getElementById('toggleRendererTitle');var bb=$('#toggleRendererBtn');var bc=document.getElementById('toggleMusicTitle');var F=$('#toggleMusicBtn');var bd=document.getElementById('game');var bm=document.getElementById('game-icons');$('#version').text(version+', WADE '+wade.getVersion());$(window).blur(function(){if(z&&!y){console.log('Game paused due to focus loss.')}wade.app.pauseGame()});$(window).focus(function(){if(!z){console.log('Game resumed due to focus gain.');C=wade.setTimeout(wade.app.spawnAsteroid,B);if(m){wade.app.musicOn()}wade.resumeSimulation()}});wade.preventIframe();wade.setLoadingBar(true,{x:0,y:0},'#333333','#222222');wade.setLoadingImages('../img/loading.svg');this.padStrings=function(a){var b='       ';var d;if(typeof(a)==='object'){d={};for(var c in a){if({}.hasOwnProperty.call(a,c)){d[c]=b+a[c]+b}}}else{d=b+a+b}return d};this.load=function(){var a=0;for(a=0;a<Object.keys(e.asteroids).length;a++){wade.loadImage(e.asteroids[a])}wade.loadImage(e.logo);for(a=0;a<Object.keys(e.boom).length;a++){wade.loadImage(e.boom[a].file)}wade.loadImage(e.shipBullet);wade.loadImage(e.shipMissile);for(a=0;a<Object.keys(e.enemyBullets).length;a++){wade.loadImage(e.enemyBullets[a].file)}for(a=0;a<Object.keys(e.enemies).length;a++){wade.loadImage(e.enemies[a])}Object.keys(D).forEach(key=>{for(a=0;a<D[key].images.length;a++){wade.loadImage(D[key].images[a])}});wade.loadImage(e.ship);wade.loadImage(e.flyLeft);wade.loadImage(e.flyRight);wade.loadImage(e.healthIcon);wade.loadImage(e.levelIcon);wade.loadImage(e.scoreIcon);wade.loadImage(e.missilesIcon);wade.loadImage(e.shieldsIcon);wade.loadImage(e.targetingIcon);var b=wade.isWebAudioSupported()?'loadAudio':'preloadAudio';wade[b](n.shoot);wade[b](n.missile);wade[b](n.hit);wade[b](n.explode);wade[b](n.loop);wade[b](n.menu);wade[b](n.spawn);wade[b](n.powerup);var d=null;d=setInterval(function(){console.log('Loaded '+Math.round(wade.getLoadingPercentage())+'% of data.');if(wade.getLoadingPercentage()>=100){clearInterval(d)}},1000)};this.init=function(){o=wade.retrieveLocalObject(O.data);A=(o&&o.force2d)||A;wade.setLayerRenderMode(L,'2d');wade.useQuadtree(L,false);bb.removeClass('fa-toggle-on');bb.addClass('fa-toggle-off');bl.title='Enable WebGL';if(!A){wade.setLayerRenderMode(L,'webgl');bb.removeClass('fa-toggle-off');bb.addClass('fa-toggle-on');bl.title='Disable WebGL'}if(wade.isWebAudioSupported()){m=(o&&o.music)||m;if(wade.getWebAudioContext().state==='suspended'){m=false}if(m){F.removeClass('music-off');F.addClass('music-on');bc.title='Disable music'}}else{m=false}wade.setMinScreenSize($(window).width(),$(window).height());wade.setMaxScreenSize($(window).width(),$(window).height());wade.setResolutionFactor(1);if(bf){wade.setMinScreenSize($(window).width()*3,$(window).height()*3);wade.setMaxScreenSize($(window).width()*3,$(window).height()*3);wade.setResolutionFactor(0.5)}var a=wade.getLayerRenderMode(L);var b={insertCoin:'- INSERT COIN -',highscoreIs:'HIGHSCORE IS %i POINTS',youScored:'YOU %s %i POINTS'};if(a==='webgl'){b=wade.app.padStrings(b)}var d=new TextSprite(b.insertCoin,'36pt Highspeed','white','center');d.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,d.draw));var c=new SceneObject();c.addSprite(d,{y:320});wade.app.getHighestScore(i,c,b);if(i>0){var f=Base64.decode('U0NPUkVE');if(sissy){f=Base64.decode('Q0hFQVRFRA==')}else{$('#highscoreWrapper').fadeToggle();wade.app.loadHighscore(i)}var g=b.youScored.replace('%s',f);g=g.replace('%i',i);if(a==='webgl'){g=wade.app.padStrings(g)}c.addSprite(new TextSprite(g,'24pt Highspeed','white','center'),{y:120});if(i>J){var h=Base64.decode('TkVXIEhJR0hTQ09SRQ==');J=i;i=0;if(sissy){h+=Base64.decode('IE5PVCBTQVZFRA==')}h+='!';if(a==='webgl'){h=wade.app.padStrings(h)}var k=new TextSprite(h,'24pt Highspeed','yellow','center');c.addSprite(k,{y:160})}}c.addSprite(new Sprite(e.logo),{y:-200});P=new SceneObject();var j=new TextSprite('PAUSED','32pt Highspeed','yellow','center');j.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,j.draw));P.addSprite(new Sprite(e.logo),{y:-200});P.addSprite(j,{y:160});bm.style.display='block';bd.style.cursor='default';wade.addSceneObject(c);var l=null;l=setInterval(function(){if(wade.getLoadingPercentage()>=100){console.log('Initializing asteroids on main screen.');C=wade.setTimeout(wade.app.spawnAsteroid,B);clearInterval(l)}},1000);if(m){wade.app.musicOn()}wade.app.onMouseDown=function(){if(wade.isMouseDown(0)||(wade.isMouseDown()&&(bf||bj))){bm.style.display='none';bd.style.cursor='none';R=1000;B=1000;M=1000;t={missiles:{fired:0,hit:0},bullets:{fired:-1,hit:0}};wade.clearTimeout(C);wade.removeSceneObject(c);wade.clearScene();wade.removeUnusedLayers([1]);wade.clearCanvas(L);wade.app.onMouseDown=0;wade.app.startGame()}}};this.getHighestScore=function(c,f,g){var h=setInterval(function(){var a={'action':'getHighestScore'};var b=JSON.stringify(a);var d=Base64.encode(b);$.ajax({url:'php/backend.php',type:'POST',data:'data='+d,success(result){if(result===null||result===''||result==='FAILED'){result=J}if(c<=0||result>c){g.highscoreIs=g.highscoreIs.replace('%i',result);f.addSprite(new TextSprite(g.highscoreIs,'24pt Highspeed','yellow','center'),{y:160})}J=result;clearInterval(h)},error(xhr,status,code){console.warn('getHighestScore(): AJAX call returned: '+status+': '+code)}})},1000)};this.loadHighscore=function(d){var c={'action':'loadScore'};var f=JSON.stringify(c);var g=Base64.encode(f);var h='Highscore not loaded!';d=(typeof(d)!=='undefined')?d:i;$.ajax({url:'php/backend.php',type:'POST',data:'data='+g,success(result){if(result!=='FAILED'){var k='';var j='<tr><td id="playerNameCell"><input type="text" class="highscore" id="playerName" maxlength="20" value="" placeholder="Enter your name"/></td><td>'+d+'</td></tr>';var l=JSON.parse(result);var K=Object.keys(l).length;var r=false;$.each(l,function(a,b){if(d>0&&d>=b.score&&!r){k+=j;r=true}if(a<9||!r){k+='<tr><td>'+b.player+'</td><td>'+b.score+'</td></tr>'}});if(K<10&&!r&&d>0){k+=j;r=true}$('#highscoreTable').html(k);if(r){$('#playerName').focus();$('#playerName').on('keypress',function(a){if(a.keyCode===13){a.preventDefault();var b=$('#playerName').val();if(b.length>0){$(this).prop('disabled',true);wade.app.saveHighscore(d,b);i=0;$('#playerName').remove();$('#playerNameCell').text(b)}return false}})}}else{console.warn('AJAX call by loadHighscore() returned: '+result)}},error(xhr,status,code){console.warn('AJAX call by loadHighscore() returned: '+status+': '+code);$('.msg').html(h)}})};this.saveHighscore=function(a,b){a=(typeof(a)!=='undefined')?a:i;b=(typeof(b)!=='undefined')?b:'Player';var d='Highscore not saved!';var c={'action':'saveScore','player':b,'score':a};var f=JSON.stringify(c);var g=Base64.encode(f);$.ajax({url:'php/backend.php',type:'POST',data:'data='+g,success(result){if(result==='OK'){d='Highscore saved!'}else{o={force2d:A,music:m,highscore:a};wade.storeLocalObject(O.data,o)}$('.msg').html(d)},error(xhr,status,code){console.warn('saveHighscore() returned: '+status+': '+code);$('.msg').html(d)}})};this.handleMouseMove=function(a,b,d){var c=a.getPosition();var f=a.getSprite();var g=null;if(c.x<0){if(c.x>d.screenPosition.x){g=new Animation(b.flyLeft,5,1,30)}else if(c.x<d.screenPosition.x){g=new Animation(b.flyRight,5,1,30)}}else if(c.x>0){if(c.x<d.screenPosition.x){g=new Animation(b.flyRight,5,1,30)}else if(c.x>d.screenPosition.x){g=new Animation(b.flyLeft,5,1,30)}}if(g!==null){f.addAnimation('fly',g);a.playAnimation('fly');a.onAnimationEnd=function(){f.setImageFile(b.ship)}}return a&&a.setPosition(d.screenPosition.x,d.screenPosition.y)};this.startGame=function(){console.log('Re-enabling quadtree optimizations.');wade.useQuadtree(L,true);var be=new Sprite(e.ship);var w=wade.getMousePosition();q=new SceneObject(be,0,w.x,w.y);wade.addSceneObject(q);var G=false;wade.setMainLoop(function(){W=V;if(wade.isMouseDown(2)&&sissy){W=50}var a=bk+1/W;var b=wade.getAppTime();if((wade.isMouseDown(0)||wade.isMouseDown(2)||(wade.isMouseDown()&&(bf||bj)))&&b>=a){bk=b;var d=q.getPosition();var c=q.getSprite().getSize();var f;var g;if(u>0){t.missiles.fired++;u--;g=n.missile;f=new Sprite(e.shipMissile);G=true}else{t.bullets.fired++;g=n.shoot;f=new Sprite(e.shipBullet);G=false}var h=new SceneObject(f,0,d.x,d.y-c.y/2);wade.addSceneObject(h);wade.playAudio(g,false);H.push(h);h.moveTo(d.x,-500,600);h.onMoveComplete=function(){wade.removeSceneObject(this);wade.removeObjectFromArray(this,H)};if(i>0&&!sissy&&W<60){i-=10}if(i<0||i==='NaN'){i=0}}if(H.length>0){for(var k=H.length-1;k>=0;k--){var j=H[k].getOverlappingObjects();if(j.length>0){for(var l=0;l<j.length;l++){if(j[l].isEnemy){if(u>0){t.missiles.hit++}else{t.bullets.hit++}var K=j[l].getPosition();wade.app.explosion(K,1);wade.playAudio(n.hit,false);if(j[l].health>0){if(G){j[l].health-=bn}else{j[l].health-=Q}}if(j[l].health<=0){wade.app.explosion(K,2);wade.playAudio(n.explode,false);var r=j[l].isAsteroid;wade.removeSceneObject(j[l]);i+=Math.floor(j[l].initialHealth/10)*v;var T=wade.app.getRandomInt(0,9);var U=[4,9];if(r&&U.indexOf(T)>-1){wade.app.spawnPowerUp(K)}}wade.removeSceneObject(H[k]);wade.removeObjectFromArrayByIndex(k,H);break}}}}}if(Math.floor(i/R)>0){if(i>=R){v+=1;R=Math.pow(10,v+2)}if(!sissy){s+=100}if(M>200){M-=100}if(B>400){B-=100}if(v>=5){B=200}if(V<50){V+=1}if(Q<600){Q+=(v*10)}}Y.getSprite().setText(s);bi.getSprite().setText(v);Z.getSprite().setText(u);if(v>=5){X.getSprite().setText(Math.floor(i)+' / OVERKILL!')}else{X.getSprite().setText(Math.floor(i)+' / '+(R-Math.floor(i)))}ba.getSprite().setText(x);S.getSprite().setText(E)},'fire');wade.setMainLoop(function(){var a=q.getOverlappingObjects(false,'axis-aligned');var b=false;var d=1;if(a.length>0){for(var c=0;c<a.length;c++){if(typeof(a[c])!=='undefined'){if(a[c].isEnemy||a[c].isEnemyBullet||a[c].isPowerUp){if(q.overlapsObject(a[c],'pixel')){if(a[c].isPowerUp){wade.playAudio(n.powerup,false);switch(a[c].name){case'cannister':i+=a[c].initialValue;break;case'heart':s+=a[c].initialValue;break;case'missiles':if(u<250){u+=a[c].initialValue}break;case'shield':if(x<100){x+=a[c].initialValue}break;case'targeting':if(E<10){E+=a[c].initialValue}break}wade.removeSceneObject(a[c]);wade.removeObjectFromArrayByIndex(c,a);b=false;break}if(a[c].health>0){a[c].health-=Math.floor(Q/10)}d=a[c].damage||d;if(a[c].isEnemyBullet||a[c].health<=0){wade.removeSceneObject(a[c]);wade.removeObjectFromArrayByIndex(c,a)}b=true;break}}}b=false}}if(b){b=false;wade.app.explosion(q.getPosition(),0);wade.playAudio(n.hit,false);if(s>0){if(x>0){x-=d}else{s-=d}}if(x<0||x==='NaN'){x=0}if(s<0||s==='NaN'){s=0}if(u<0||u==='NaN'){u=0}Y.getSprite().setText(s);Z.getSprite().setText(u);ba.getSprite().setText(x);S.getSprite().setText(E)}if(s<=0){var f=wade.app.explosion(q.getPosition(),2);wade.playAudio(n.explode,false);wade.removeSceneObject(q);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');var g=(t.bullets.fired==0)?0:Math.round((t.bullets.hit/t.bullets.fired)*100);var h=(t.missiles.fired==0)?0:Math.round((t.missiles.hit/t.missiles.fired)*100);var k=(g+h)*100;k=Math.max(Math.round(k/1000)*1000,1000);console.log(k);if(!sissy&&i>J){o={force2d:A,music:m,highscore:i};wade.storeLocalObject(O.data,o)}var j=setInterval(function(){if(!f.isPlaying()){z=false;if(m){wade.app.musicOn()}wade.clearTimeout(N);wade.clearTimeout(C);clearInterval(j);wade.clearScene();wade.app.init()}},100)}},'die');if(!z){if(sissy){s=999}else{s=100}i=0;v=1;V=4;Q=200;z=true;if(m){wade.app.musicOn()}}var p=new Sprite(e.levelIcon);var bo=new SceneObject(p,0,20-(wade.getScreenWidth()/2),-12-wade.getScreenHeight()/2+30);wade.addSceneObject(bo);var bp=new TextSprite(v,'32pt Highspeed','#f88','left');bi=new SceneObject(bp,0,40-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(bi);var bq=new Sprite(e.targetingIcon);var br=new SceneObject(bq,0,110-(wade.getScreenWidth()/2),-10-wade.getScreenHeight()/2+30);wade.addSceneObject(br);var bs=new TextSprite(E.toString(),'32pt Highspeed','#f88','center');S=new SceneObject(bs,0,170-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(S);var bt=new Sprite(e.missilesIcon);var bu=new SceneObject(bt,0,250-(wade.getScreenWidth()/2),-10-wade.getScreenHeight()/2+30);wade.addSceneObject(bu);var bv=new TextSprite(u.toString(),'32pt Highspeed','#f88','center');Z=new SceneObject(bv,0,310-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(Z);var bw=new Sprite(e.shieldsIcon);var bx=new SceneObject(bw,0,390-(wade.getScreenWidth()/2),-10-wade.getScreenHeight()/2+30);wade.addSceneObject(bx);var by=new TextSprite(x.toString(),'32pt Highspeed','#f88','center');ba=new SceneObject(by,0,450-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(ba);var bz=new Sprite(e.healthIcon);var bA=new SceneObject(bz,0,-120,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(bA);var bB=new TextSprite(s.toString(),'32pt Highspeed','#f88','center');Y=new SceneObject(bB,0,-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(Y);var bC=new Sprite(e.scoreIcon);var bD=new SceneObject(bC,0,wade.getScreenWidth()/2-20,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(bD);var bE=new TextSprite(i.toString(),'32pt Highspeed','#f88','right');X=new SceneObject(bE,0,wade.getScreenWidth()/2-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(X);N=wade.setTimeout(wade.app.spawnEnemy,M);C=wade.setTimeout(wade.app.spawnAsteroid,B)};this.pauseGame=function(){wade.clearTimeout(C);wade.app.musicOff();if(z&&!y){y=true;wade.clearTimeout(N);wade.app.onMouseMove=null;wade.addSceneObject(P);bd.style.cursor='default'}wade.pauseSimulation()};this.onKeyDown=function(b){if(z&&b.keyCode===32){if(!y){console.log('Game paused by user.');wade.app.pauseGame();y=true}else{y=false;console.log('Game resumed by user.');bd.style.cursor='none';N=wade.setTimeout(wade.app.spawnEnemy,M);C=wade.setTimeout(wade.app.spawnAsteroid,B);wade.removeSceneObject(P);if(m){wade.app.musicOn()}wade.resumeSimulation();wade.app.onMouseMove=function(a){if(typeof(q)!=='undefined'){wade.app.handleMouseMove(q,e,a)}}}}return false};this.onMouseMove=function(a){if(typeof(q)!=='undefined'){return wade.app.handleMouseMove(q,e,a)}};this.explosion=function(a,b){if(typeof(b)==='undefined'||b===null||typeof(e.boom[b])==='undefined'){b=0}var d=new Animation(e.boom[b].file,e.boom[b].x,e.boom[b].y,e.boom[b].speed);var c=new Sprite();c.setSize(100,100);c.addAnimation('boom',d);var f=new SceneObject(c,0,a.x,a.y);wade.addSceneObject(f);f.playAnimation('boom');f.onAnimationEnd=function(){wade.removeSceneObject(this)};return d};this.getRandomCoords=function(a){return{x1:(Math.random()-0.5)*wade.getScreenWidth(),y1:-wade.getScreenHeight()/2-a.getSize().y/2,x2:(Math.random()-0.5)*wade.getScreenWidth(),y2:Math.abs(wade.getScreenHeight()/2-a.getSize().y/2)}};this.getRandomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};this.spawnPowerUp=function(a){var b;var d=wade.app.getRandomInt(0,2);var c=wade.app.getRandomInt(0,4);var f;switch(c){case 1:f=D.heart;break;case 2:f=D.missiles;break;case 3:f=D.shield;break;case 4:f=D.targeting;break;default:f=D.cannister;break}if(f!==D.targeting||E<=0){b=new Sprite(f.images[d]);var g=wade.app.getRandomCoords(b);var h=new SceneObject(b,0,a.x,a.y);wade.addSceneObject(h);h.moveTo(g.x2,g.y2,200);h.isEnemy=false;h.isAsteroid=false;h.isPowerUp=true;h.initialValue=f.values[d];h.name=f.name;h.damage=0;wade.playAudio(n.spawn,false);h.onMoveComplete=function(){wade.removeSceneObject(this)}}};this.spawnAsteroid=function(){console.log('spawnAsteroid, Game paused = '+y);if(y){return false}var a;var b=wade.app.getRandomInt(0,9);a=new Sprite(e.asteroids[b]);var d=wade.app.getRandomCoords(a);var c=new SceneObject(a,0,d.x1,d.y1);wade.addSceneObject(c);c.moveTo(d.x2,d.y2,200);c.isEnemy=true;c.isAsteroid=true;c.isPowerUp=false;c.health=bh[b];c.initialHealth=bh[b];c.damage=Math.floor(bh[b]/100);c.onMoveComplete=function(){wade.removeSceneObject(this)};C=wade.setTimeout(wade.app.spawnAsteroid,B)};this.spawnEnemy=function(){if(y){return false}var T;var U=v-1;var be=Object.keys(e.enemies).length-1;if(U>be){U=be}var w=wade.app.getRandomInt(0,U);if(v>=5){w=4}T=new Sprite(e.enemies[w]);var G=wade.app.getRandomCoords(T);var p=new SceneObject(T,0,G.x1,G.y1);wade.addSceneObject(p);p.moveTo(G.x2,G.y2,200);p.isEnemy=true;p.isAsteroid=false;p.isPowerUp=false;p.health=bg[w];p.initialHealth=bg[w];p.damage=Math.floor(bg[w]/100);p.onMoveComplete=function(){wade.removeSceneObject(this)};p.originalStep=p.step;p.step=function(){this.originalStep();var a=this.getPosition();var b=q.getPosition();var d=Math.atan2(b.y-a.y,b.x-a.x)-3.14/2;this.setRotation(d)};p.fire=function(){var a=this.getSprite().getSize();var b=this.getPosition();var d=q.getPosition();var c=d.x-b.x;var f=d.y-b.y;var g=Math.sqrt(c*c+f*f);c/=g;f/=g;var h=b.x+c*a.x/2;var k=b.y+f*a.y/2;var j=h+c*3000;var l=k+f*3000;var K=new Sprite(e.enemyBullets[w].file);var r=new SceneObject(K,0,h,k);r.isEnemyBullet=true;r.damage=e.enemyBullets[w].damage;wade.addSceneObject(r);r.moveTo(j,l,200);r.onMoveComplete=function(){wade.removeSceneObject(this)};this.schedule(e.enemyBullets[w].delay,'fire')};if(E>0){wade.setTimeout(function(){E--;S.getSprite().setText(E)},1000)}else{p.schedule(300,'fire')}N=wade.setTimeout(wade.app.spawnEnemy,M)};this.toggleRenderer=function(){A=!A;o={force2d:A,music:m,highscore:J};wade.storeLocalObject(O.data,o);wade.clearTimeout(N);wade.clearTimeout(C);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');z=false;wade.clearScene();wade.app.init()};this.musicOn=function(){if(I>-1){wade.stopAudio(I)}else{wade.stopAudio()}if(z){I=wade.playAudio(n.loop,true)}else{I=wade.playAudio(n.menu,true)}if(I<0){F.removeClass('music-on');F.addClass('music-off');bc.title='Enable music';m=false}return false};this.musicOff=function(){if(I>-1){wade.stopAudio(I)}else{wade.stopAudio()}return false};this.toggleMusic=function(){var a=wade.getWebAudioContext();if(a.state==='suspended'){a.resume().then(()=>{console.log('Audio context resumed.')})}if(m){m=false;F.removeClass('music-on');F.addClass('music-off');bc.title='Enable music';wade.app.musicOff()}else{m=true;F.removeClass('music-off');F.addClass('music-on');bc.title='Disable music';wade.app.musicOn()}o={force2d:A,music:m,highscore:J};wade.storeLocalObject(O.data,o);return false}};