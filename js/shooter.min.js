var version='1.0.9';$('#version').text(version);var Base64={_0:'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',encode:function(a){'use strict';var b='';var d,c,g,f,j,i,h;var m=0;a=Base64._1(a);while(m<a.length){d=a.charCodeAt(m++);c=a.charCodeAt(m++);g=a.charCodeAt(m++);f=d>>2;j=((d&3)<<4)|(c>>4);i=((c&15)<<2)|(g>>6);h=g&63;if(isNaN(c)){i=h=64}else if(isNaN(g)){h=64}b=b+this._0.charAt(f)+this._0.charAt(j)+this._0.charAt(i)+this._0.charAt(h)}return b},decode:function(a){'use strict';var b='';var d,c,g;var f,j,i,h;var m=0;a=a.replace('/[^A-Za-z0-9+/=]/g','');while(m<a.length){f=this._0.indexOf(a.charAt(m++));j=this._0.indexOf(a.charAt(m++));i=this._0.indexOf(a.charAt(m++));h=this._0.indexOf(a.charAt(m++));d=(f<<2)|(j>>4);c=((j&15)<<4)|(i>>2);g=((i&3)<<6)|h;b=b+String.fromCharCode(d);if(i!=64){b=b+String.fromCharCode(c)}if(h!=64){b=b+String.fromCharCode(g)}}b=Base64._2(b);return b},_1:function(a){'use strict';a=a.replace('/\r\n/g','\n');var b='';for(var d=0;d<a.length;d++){var c=a.charCodeAt(d);if(c<128){b+=String.fromCharCode(c)}else if((c>127)&&(c<2048)){b+=String.fromCharCode((c>>6)|192);b+=String.fromCharCode((c&63)|128)}else{b+=String.fromCharCode((c>>12)|224);b+=String.fromCharCode(((c>>6)&63)|128);b+=String.fromCharCode((c&63)|128)}}return b},_2:function(a){'use strict';var b='';var d=0,c=0,g=0,f=0;while(d<a.length){c=a.charCodeAt(d);if(c<128){b+=String.fromCharCode(c);d++}else if((c>191)&&(c<224)){f=a.charCodeAt(d+1);b+=String.fromCharCode(((c&31)<<6)|(f&63));d+=2}else{f=a.charCodeAt(d+1);g=a.charCodeAt(d+2);b+=String.fromCharCode(((c&15)<<12)|((f&63)<<6)|(g&63));d+=3}}return b}};function getRandomInt(a,b){'use strict';return Math.floor(Math.random()*(b-a+1))+a}function padStrings(a){'use strict';var b='       ';var d;if(typeof(a)==='object'){d={};for(var c in a){if({}.hasOwnProperty.call(a,c)){d[c]=b+a[c]+b}}}else{d=b+a+b}return d}function handleMouseMove(a,b,d){'use strict';var c=a.getPosition();var g=a.getSprite();var f=null;if(c.x<0){if(c.x>d.screenPosition.x){f=new Animation(b.flyLeft,5,1,30)}else if(c.x<d.screenPosition.x){f=new Animation(b.flyRight,5,1,30)}}else if(c.x>0){if(c.x<d.screenPosition.x){f=new Animation(b.flyRight,5,1,30)}else if(c.x>d.screenPosition.x){f=new Animation(b.flyLeft,5,1,30)}}if(f!==null){g.addAnimation('fly',f);a.playAnimation('fly');a.onAnimationEnd=function(){g.setImageFile(b.ship)}}return a&&a.setPosition(d.screenPosition.x,d.screenPosition.y)}var App=function(){'use strict';var N=false||checkForMobileDevice();var U=false||getBrowserVersion('Trident/([0-9]{1,}[.0-9]{0,})');var n;var H=false;var x=false;var I=null;var r=false;var V=1;var bb=0;var J=4;var O=4;var E=200;var W=[400,600,800,1500,5000];var K=2000;var F;var X=[200,200,200,300,400,400,600,500,400,600];var B=1000;var t;var C=[];var Y;var k=0;var D={data:'overkill'};var P;var q=100;var Z;var u=1;var y=null;var p=false;var l=wade.retrieveLocalObject(D.data);const sissy=(l&&l.sissy)||false;var v=(l&&l.highscore)||0;var e={logo:'../img/logo.png',ship:'../img/ship.png',boom:{0:{file:'../img/animations/explosion/explode_4x4_ship.png',speed:30,x:4,y:4},1:{file:'../img/animations/explosion/explode_4x4_ring.png',speed:30,x:4,y:4},2:{file:'../img/animations/explosion/explode_5x3_enemy.png',speed:30,x:5,y:3}},flyLeft:'../img/animations/ship/fly_left.png',flyRight:'../img/animations/ship/fly_right.png',shipBullet:'../img/bullets/bullet_ship.png',enemyBullets:{0:{file:'../img/bullets/bullet0.png',delay:600,damage:1},1:{file:'../img/bullets/bullet1.png',delay:500,damage:3},2:{file:'../img/bullets/bullet2.png',delay:400,damage:5},3:{file:'../img/bullets/bullet3.png',delay:300,damage:10},4:{file:'../img/bullets/bullet4.png',delay:200,damage:20}},enemies:{0:'../img/enemies/enemy0.png',1:'../img/enemies/enemy1.png',2:'../img/enemies/enemy2.png',3:'../img/enemies/enemy3.png',4:'../img/enemies/enemy4.png'},asteroids:{0:'../img/asteroids/asteroid0.png',1:'../img/asteroids/asteroid1.png',2:'../img/asteroids/asteroid2.png',3:'../img/asteroids/asteroid3.png',4:'../img/asteroids/asteroid4.png',5:'../img/asteroids/asteroid5.png',6:'../img/asteroids/asteroid6.png',7:'../img/asteroids/asteroid7.png',8:'../img/asteroids/asteroid8.png',9:'../img/asteroids/asteroid9.png'},healthIcon:'../img/icons/heart.png',levelIcon:'../img/icons/star.png',scoreIcon:'../img/icons/trophy.png'};var s={shoot:'../sounds/shoot.mp3',hit:'../sounds/hit.mp3',explode:'../sounds/explode.mp3',loop:'../sounds/loop.mp3'};var bc=document.getElementById('toggleRendererTitle');var Q=$('#toggleRendererBtn');var R=document.getElementById('toggleMusicTitle');var z=$('#toggleMusicBtn');var S=document.getElementById('game');var bd=document.getElementById('game-icons');wade.preventIframe();wade.setLoadingBar(true,{x:0,y:0},'#333333','#222222');wade.setLoadingImages('../img/loading.svg');this.load=function(){var a=0;wade.loadImage(e.logo);wade.loadImage(e.ship);wade.loadImage(e.shipBullet);for(a=0;a<Object.keys(e.enemyBullets).length;a++){wade.loadImage(e.enemyBullets[a].file)}for(a=0;a<Object.keys(e.boom).length;a++){wade.loadImage(e.boom[a].file)}wade.loadImage(e.flyLeft);wade.loadImage(e.flyRight);wade.loadImage(e.healthIcon);wade.loadImage(e.levelIcon);wade.loadImage(e.scoreIcon);for(a=0;a<Object.keys(e.enemies).length;a++){wade.loadImage(e.enemies[a])}for(a=0;a<Object.keys(e.asteroids).length;a++){wade.loadImage(e.asteroids[a])}var b=wade.isWebAudioSupported()?'loadAudio':'preloadAudio';wade[b](s.shoot);wade[b](s.hit);wade[b](s.explode);wade[b](s.loop)};this.init=function(){l=wade.retrieveLocalObject(D.data);r=(l&&l.force2d)||r;if(r){wade.setLayerRenderMode(V,'2d');Q.removeClass('fa-toggle-on');Q.addClass('fa-toggle-off');bc.title='Enable WebGL'}else{wade.setLayerRenderMode(V,'webgl');Q.removeClass('fa-toggle-off');Q.addClass('fa-toggle-on');bc.title='Disable WebGL'}if(wade.isWebAudioSupported()){p=(l&&l.music)||p;if(p){z.removeClass('music-off');z.addClass('music-on');R.title='Disable music'}}else{p=false}wade.setMinScreenSize($(window).width(),$(window).height());wade.setMaxScreenSize($(window).width(),$(window).height());wade.setResolutionFactor(1);if(N){wade.setMinScreenSize($(window).width()*3,$(window).height()*3);wade.setMaxScreenSize($(window).width()*3,$(window).height()*3);wade.setResolutionFactor(0.5)}var a=wade.getLayerRenderMode(V);if(debug){log('\n\t\tbrowser screen size   : '+$(window).width()+'x'+$(window).height()+'\n\t\tactual min screen size: '+wade.getMinScreenWidth()+'x'+wade.getMinScreenHeight()+'\n\t\tactual max screen size: '+wade.getMaxScreenWidth()+'x'+wade.getMaxScreenHeight()+'\n\t\trender-mode           : '+a+'\n\t\tforce2D               : '+r+'\n\t\tisMobile              : '+N+'\n\t\tisSissy               : '+sissy+'\n\t\tcurrent score         : '+k+'\n\t\thighscore             : '+v+'\n\t\tlevel                 : '+u+'\n\t\tplayer health         : '+q+'\n\t\tfire rate             : '+J+'\n\t\tfire damage           : '+E)}var b={insertCoin:'- INSERT COIN -',highscoreIs:'HIGHSCORE IS %i POINTS',youScored:'YOU %s %i POINTS'};if(a==='webgl'){b=padStrings(b)}var d=new TextSprite(b.insertCoin,'36pt Highspeed','white','center');d.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,d.draw));var c=new SceneObject();c.addSprite(d,{y:320});if(k<=0||v>=k){b.highscoreIs=b.highscoreIs.replace('%i',v);c.addSprite(new TextSprite(b.highscoreIs,'24pt Highspeed','yellow','center'),{y:160})}if(k>0){var g=Base64.decode('U0NPUkVE');if(sissy){g=Base64.decode('Q0hFQVRFRA==')}var f=b.youScored.replace('%s',g);f=f.replace('%i',k);if(a==='webgl'){f=padStrings(f)}c.addSprite(new TextSprite(f,'24pt Highspeed','white','center'),{y:120});if(k>v){var j=Base64.decode('TkVXIEhJR0hTQ09SRQ==');v=k;if(sissy){j+=Base64.decode('IE5PVCBTQVZFRA==')}j+='!';if(a==='webgl'){j=padStrings(j)}var i=new TextSprite(j,'24pt Highspeed','yellow','center');c.addSprite(i,{y:160})}}if(!sissy){l={r,music:p,highscore:v};wade.storeLocalObject(D.data,l)}c.addSprite(new Sprite(e.logo),{y:-200});I=new SceneObject();var h=new TextSprite('PAUSED','32pt Highspeed','yellow','center');h.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,h.draw));I.addSprite(new Sprite(e.logo),{y:-200});I.addSprite(h,{y:160});bd.style.display='block';S.style.cursor='default';wade.addSceneObject(c);t=setTimeout(wade.app.spawnAsteroid,B);if(wade.isWebAudioSupported()){if(p&&y===null){y=wade.playAudio(s.loop,true);if(y<0){z.removeClass('music-on');z.addClass('music-off');R.title='Enable music';p=false}}}wade.app.onMouseDown=function(){if(wade.isMouseDown(0)||(wade.isMouseDown()&&(N||U))){bd.style.display='none';S.style.cursor='none';clearTimeout(t);wade.removeSceneObject(c);wade.clearScene();wade.removeUnusedLayers([1]);wade.app.startGame();wade.app.onMouseDown=0}}};this.startGame=function(){var ba=new Sprite(e.ship);var A=wade.getMousePosition();n=new SceneObject(ba,0,A.x,A.y);wade.addSceneObject(n);wade.setMainLoop(function(){O=J;if(wade.isMouseDown(2)&&sissy){O=50}var a=bb+1/O;var b=wade.getAppTime();if((wade.isMouseDown(0)||wade.isMouseDown(2)||(wade.isMouseDown()&&(N||U)))&&b>=a){bb=b;var d=n.getPosition();var c=n.getSprite().getSize();var g=new Sprite(e.shipBullet);var f=new SceneObject(g,0,d.x,d.y-c.y/2);wade.addSceneObject(f);wade.playAudio(s.shoot,false);C.push(f);f.moveTo(d.x,-500,600);f.onMoveComplete=function(){wade.removeSceneObject(this);wade.removeObjectFromArray(this,C)};if(k>0&&!sissy&&O<60){k-=10}if(k<0||k==='NaN'){k=0}}if(C.length>0){for(var j=C.length-1;j>=0;j--){var i=C[j].getOverlappingObjects();if(i.length>0){for(var h=0;h<i.length;h++){if(i[h].isEnemy){var m=i[h].getPosition();wade.app.explosion(m,1);wade.playAudio(s.hit,false);if(i[h].health>0){i[h].health-=E}if(i[h].health<=0){wade.app.explosion(m,2);wade.playAudio(s.explode,false);wade.removeSceneObject(i[h]);k+=Math.floor(i[h].initialHealth/10)*u}wade.removeSceneObject(C[j]);wade.removeObjectFromArrayByIndex(j,C);break}}}}}if(Math.floor(k/1000)>u-1&&u<5){u+=1;if(!sissy){q=100}if(K>200){K-=100}if(B>400){B-=100}if(J<50){J+=1}if(E<600){E+=(u*10)}}P.getSprite().setText(q);Z.getSprite().setText(u);Y.getSprite().setText(Math.floor(k))},'fire');wade.setMainLoop(function(){var a=n.getOverlappingObjects(false,'axis-aligned');var b=false;var d=1;if(a.length>0){for(var c=0;c<a.length;c++){if(typeof(a[c])!=='undefined'){if(a[c].isEnemy||a[c].isEnemyBullet){if(typeof(a[c])!=='undefined'&&n.overlapsObject(a[c],'pixel')){if(a[c].health>0){a[c].health-=Math.floor(E/10)}if(typeof(a[c])!=='undefined'&&(a[c].isEnemyBullet||a[c].health<=0)){wade.removeSceneObject(a[c]);wade.removeObjectFromArrayByIndex(c,a)}if(typeof(a[c])!=='undefined'){d=a[c].damage||d}b=true;break}}}}}if(b){b=false;wade.app.explosion(n.getPosition(),0);wade.playAudio(s.hit,false);if(q>0){q-=d}if(q<0||q==='NaN'){q=0}P.getSprite().setText(q)}if(q<=0){var g=wade.app.explosion(n.getPosition(),2);wade.playAudio(s.explode,false);wade.removeSceneObject(n);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');if(!sissy&&k>v){l={r,music:p,highscore:k};wade.storeLocalObject(D.data,l)}var f=setInterval(function(){if(!g.isPlaying()){x=false;clearInterval(f);clearTimeout(F);clearTimeout(t);wade.clearScene();wade.app.init()}},100)}},'die');if(!x){if(sissy){q=999}else{q=100}k=0;u=1;J=4;E=200;x=true}var L=new Sprite(e.scoreIcon);var M=new SceneObject(L,0,wade.getScreenWidth()/2-20,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(M);var T=new TextSprite(k.toString(),'32pt Highspeed','#f88','right');Y=new SceneObject(T,0,wade.getScreenWidth()/2-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(Y);var w=new Sprite(e.healthIcon);var G=new SceneObject(w,0,-120,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(G);var o=new TextSprite(q.toString(),'32pt Highspeed','#f88','center');P=new SceneObject(o,0,-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(P);var be=new Sprite(e.levelIcon);var bf=new SceneObject(be,0,20-(wade.getScreenWidth()/2),-12-wade.getScreenHeight()/2+30);wade.addSceneObject(bf);var bg=new TextSprite(u,'32pt Highspeed','#f88','left');Z=new SceneObject(bg,0,40-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(Z);F=setTimeout(wade.app.spawnEnemy,K);t=setTimeout(wade.app.spawnAsteroid,B)};this.pauseGame=function(){wade.pauseSimulation();clearTimeout(F);clearTimeout(t);wade.app.onMouseMove=null;wade.addSceneObject(I);S.style.cursor='default';return false};$(window).blur(function(){if(x&&!H){console.log('Game paused due to focus loss.');H=true;wade.app.pauseGame()}else{if(!x){console.log('Asteroid timeout cleared due to focus loss.');clearTimeout(t)}}return false});$(window).focus(function(){if(!x){t=setTimeout(wade.app.spawnAsteroid,B)}});this.onKeyDown=function(b){if(x&&b.keyCode===32){H=!H;if(H){wade.app.pauseGame()}else{S.style.cursor='none';F=setTimeout(wade.app.spawnEnemy,K);t=setTimeout(wade.app.spawnAsteroid,B);wade.removeSceneObject(I);wade.resumeSimulation();wade.app.onMouseMove=function(a){if(typeof(n)!=='undefined'){handleMouseMove(n,e,a)}}}}return false};this.onMouseMove=function(a){if(typeof(n)!=='undefined'){return handleMouseMove(n,e,a)}};this.explosion=function(a,b){if(typeof(b)==='undefined'||b===null||typeof(e.boom[b])==='undefined'){b=0}var d=new Animation(e.boom[b].file,e.boom[b].x,e.boom[b].y,e.boom[b].speed);var c=new Sprite();c.setSize(100,100);c.addAnimation('boom',d);var g=new SceneObject(c,0,a.x,a.y);wade.addSceneObject(g);g.playAnimation('boom');g.onAnimationEnd=function(){wade.removeSceneObject(this)};return d};this.getRandomCoords=function(a){return{x1:(Math.random()-0.5)*wade.getScreenWidth(),y1:-wade.getScreenHeight()/2-a.getSize().y/2,x2:(Math.random()-0.5)*wade.getScreenWidth(),y2:Math.abs(wade.getScreenHeight()/2-a.getSize().y/2)}};this.spawnAsteroid=function(){var a;var b=getRandomInt(0,9);a=new Sprite(e.asteroids[b]);var d=wade.app.getRandomCoords(a);var c=new SceneObject(a,0,d.x1,d.y1);wade.addSceneObject(c);c.moveTo(d.x2,d.y2,200);c.isEnemy=true;c.isAsteroid=true;c.health=X[b];c.initialHealth=X[b];c.damage=Math.floor(X[b]/100);c.onMoveComplete=function(){wade.removeSceneObject(this)};t=setTimeout(wade.app.spawnAsteroid,B)};this.spawnEnemy=function(){var L;var M=u-1;var T=Object.keys(e.enemies).length-1;if(M>T){M=T}var w=getRandomInt(0,M);L=new Sprite(e.enemies[w]);var G=wade.app.getRandomCoords(L);var o=new SceneObject(L,0,G.x1,G.y1);wade.addSceneObject(o);o.moveTo(G.x2,G.y2,200);o.isEnemy=true;o.isAsteroid=false;o.health=W[w];o.initialHealth=W[w];o.damage=Math.floor(W[w]/100);o.onMoveComplete=function(){wade.removeSceneObject(this)};o.originalStep=o.step;o.step=function(){this.originalStep();var a=this.getPosition();var b=n.getPosition();var d=Math.atan2(b.y-a.y,b.x-a.x)-3.14/2;this.setRotation(d)};o.fire=function(){var a=this.getSprite().getSize();var b=this.getPosition();var d=n.getPosition();var c=d.x-b.x;var g=d.y-b.y;var f=Math.sqrt(c*c+g*g);c/=f;g/=f;var j=b.x+c*a.x/2;var i=b.y+g*a.y/2;var h=j+c*3000;var m=i+g*3000;var ba=new Sprite(e.enemyBullets[w].file);var A=new SceneObject(ba,0,j,i);A.isEnemyBullet=true;A.damage=e.enemyBullets[w].damage;wade.addSceneObject(A);A.moveTo(h,m,200);A.onMoveComplete=function(){wade.removeSceneObject(this)};this.schedule(e.enemyBullets[w].delay,'fire')};o.schedule(300,'fire');F=setTimeout(wade.app.spawnEnemy,K)};this.toggleRenderer=function(){r=!r;l={r,music:p,highscore:v};wade.storeLocalObject(D.data,l);clearTimeout(F);clearTimeout(t);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');x=false;wade.clearScene();wade.app.init()};this.toggleMusic=function(){if(p){p=false;z.removeClass('music-on');z.addClass('music-off');R.title='Enable music';if(U){l={r,music:p,highscore:v};wade.storeLocalObject(D.data,l);location.reload()}else{if(y>-1){wade.stopAudio(y)}else{wade.stopAudio()}}}else{if(y>-1){wade.stopAudio(y)}else{wade.stopAudio()}y=wade.playAudio(s.loop,true);p=true;z.removeClass('music-off');z.addClass('music-on');R.title='Disable music'}l={r,music:p,highscore:v};wade.storeLocalObject(D.data,l);return false}};