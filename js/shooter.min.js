var version='1.0.6';$('#version').text(version);var cheat=false;var App=function(){'use strict';var G=G||false;var j;var H=false;var w=false;var D=null;var s=false;var U=1;var bd=0;var I=4;var N=4;var E=200;var V=[400,600,800,1500,5000];var J=2000;var A;var W=[200,200,200,300,400,400,600,500,400,600];var B=1000;var q;var C=[];var X;var i=0;var F={data:'overkill',};var O;var o=100;var Y;var t=1;var x=null;var p=false;var k=wade.retrieveLocalObject(F.data);var u=(k&&k.highscore)||0;var d={logo:'../img/logo.png',ship:'../img/ship.png',boom:{0:{file:'../img/animations/explosion/explode_4x4_ship.png',speed:30,x:4,y:4},1:{file:'../img/animations/explosion/explode_4x4_ring.png',speed:30,x:4,y:4},2:{file:'../img/animations/explosion/explode_5x3_enemy.png',speed:30,x:5,y:3}},fly_left:'../img/animations/ship/fly_left.png',fly_right:'../img/animations/ship/fly_right.png',shipBullet:'../img/bullets/bullet_ship.png',enemyBullets:{0:{file:'../img/bullets/bullet0.png',delay:600,damage:1},1:{file:'../img/bullets/bullet1.png',delay:500,damage:3},2:{file:'../img/bullets/bullet2.png',delay:400,damage:5},3:{file:'../img/bullets/bullet3.png',delay:300,damage:10},4:{file:'../img/bullets/bullet4.png',delay:200,damage:20}},enemies:{0:'../img/enemies/enemy0.png',1:'../img/enemies/enemy1.png',2:'../img/enemies/enemy2.png',3:'../img/enemies/enemy3.png',4:'../img/enemies/enemy4.png'},asteroids:{0:'../img/asteroids/asteroid0.png',1:'../img/asteroids/asteroid1.png',2:'../img/asteroids/asteroid2.png',3:'../img/asteroids/asteroid3.png',4:'../img/asteroids/asteroid4.png',5:'../img/asteroids/asteroid5.png',6:'../img/asteroids/asteroid6.png',7:'../img/asteroids/asteroid7.png',8:'../img/asteroids/asteroid8.png',9:'../img/asteroids/asteroid9.png'},healthIcon:'../img/icons/heart.png',levelIcon:'../img/icons/star.png',scoreIcon:'../img/icons/trophy.png'};var r={shoot:'../sounds/shoot.mp3',hit:'../sounds/hit.mp3',explode:'../sounds/explode.mp3',loop:'../sounds/loop.mp3'};var be=document.getElementById('toggleRendererTitle');var P=$('#toggleRendererBtn');var Q=document.getElementById('toggleMusicTitle');var y=$('#toggleMusicBtn');var K=document.getElementById('game');var bf=document.getElementById('game-icons');wade.preventIframe();wade.setLoadingBar(true,{x:0,y:0},'#333333','#222222');wade.setLoadingImages('../img/loading.svg');this.load=function(){var a=0;wade.loadImage(d.logo);wade.loadImage(d.ship);wade.loadImage(d.shipBullet);for(a=0;a<Object.keys(d.enemyBullets).length;a++){wade.loadImage(d.enemyBullets[a].file)}for(a=0;a<Object.keys(d.boom).length;a++){wade.loadImage(d.boom[a].file)}wade.loadImage(d.fly_left);wade.loadImage(d.fly_right);wade.loadImage(d.healthIcon);wade.loadImage(d.levelIcon);wade.loadImage(d.scoreIcon);for(a=0;a<Object.keys(d.enemies).length;a++){wade.loadImage(d.enemies[a])}for(a=0;a<Object.keys(d.asteroids).length;a++){wade.loadImage(d.asteroids[a])}wade.loadAudio(r.shoot);wade.loadAudio(r.hit);wade.loadAudio(r.explode);wade.loadAudio(r.loop)};this.init=function(){k=wade.retrieveLocalObject(F.data);s=(k&&k.force2d)||s;if(s){wade.setLayerRenderMode(U,'2d');P.removeClass('fa-toggle-on');P.addClass('fa-toggle-off');be.title='Enable WebGL'}else{wade.setLayerRenderMode(U,'webgl');P.removeClass('fa-toggle-off');P.addClass('fa-toggle-on');be.title='Disable WebGL'}if(wade.isWebAudioSupported()){p=(k&&k.music)||p;if(p){y.removeClass('music-off');y.addClass('music-on');Q.title='Disable music'}}else{p=false}wade.setMinScreenSize($(window).width(),$(window).height());wade.setMaxScreenSize($(window).width(),$(window).height());wade.setResolutionFactor(1);if(G){wade.setMinScreenSize($(window).width()*3,$(window).height()*3);wade.setMaxScreenSize($(window).width()*3,$(window).height()*3);wade.setResolutionFactor(0.5)}var a=wade.getLayerRenderMode(U);if(debug){log('\n\t\tbrowser screen size   : '+$(window).width()+'x'+$(window).height()+'\n\t\tactual min screen size: '+wade.getMinScreenWidth()+'x'+wade.getMinScreenHeight()+'\n\t\tactual max screen size: '+wade.getMaxScreenWidth()+'x'+wade.getMaxScreenHeight()+'\n\t\trender-mode           : '+a+'\n\t\tforce2D               : '+s+'\n\t\tisMobile              : '+G+'\n\t\tisCheater             : '+cheat+'\n\t\tcurrent score         : '+i+'\n\t\thighscore             : '+u+'\n\t\tlevel                 : '+t+'\n\t\tplayer health         : '+o+'\n\t\tfire rate             : '+I+'\n\t\tfire damage           : '+E)}var b={insertCoin:'- INSERT COIN -',highscoreIs:'HIGHSCORE IS %i POINTS',youScored:'YOU %s %i POINTS'};if(a==='webgl'){b=padStrings(b)}var e=new TextSprite(b.insertCoin,'36pt Highspeed','white','center');e.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,e.draw));var c=new SceneObject();c.addSprite(e,{y:320});if(i<=0||u>=i){b.highscoreIs=b.highscoreIs.replace('%i',u);c.addSprite(new TextSprite(b.highscoreIs,'24pt Highspeed','yellow','center'),{y:160})}if(i>0){var h='SCORED';if(cheat){h='CHEATED'}var f=b.youScored.replace('%s',h);f=f.replace('%i',i);if(a==='webgl'){f=padStrings(f)}c.addSprite(new TextSprite(f,'24pt Highspeed','white','center'),{y:120});if(i>u){var g='NEW HIGHSCORE';u=i;if(cheat){g+=' NOT SAVED'}g+='!';if(a==='webgl'){g=padStrings(g)}var n=new TextSprite(g,'24pt Highspeed','yellow','center');c.addSprite(n,{y:160})}}if(!cheat){k={force2d:s,music:p,highscore:u};wade.storeLocalObject(F.data,k)}c.addSprite(new Sprite(d.logo),{y:-200});D=new SceneObject();var l=new TextSprite('PAUSED','32pt Highspeed','yellow','center');l.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,l.draw));D.addSprite(new Sprite(d.logo),{y:-200});D.addSprite(l,{y:160});bf.style.display='block';K.style.cursor='default';wade.addSceneObject(c);q=setTimeout(wade.app.spawnAsteroid,B);if(wade.isWebAudioSupported()){if(p&&x===null){x=wade.playAudio(r.loop,true);if(x<0){y.removeClass('music-on');y.addClass('music-off');Q.title='Enable music';p=false}}}wade.app.onMouseDown=function(){if(wade.isMouseDown(0)||(wade.isMouseDown()&&G)){bf.style.display='none';K.style.cursor='none';clearTimeout(q);wade.removeSceneObject(c);wade.clearScene();wade.removeUnusedLayers([1]);wade.app.startGame();wade.app.onMouseDown=0}}};this.startGame=function(){var Z=new Sprite(d.ship);var z=wade.getMousePosition();j=new SceneObject(Z,0,z.x,z.y);wade.addSceneObject(j);wade.setMainLoop(function(){N=I;if(wade.isMouseDown(2)&&cheat){N=50}var a=bd+1/N;var b=wade.getAppTime();if((wade.isMouseDown(0)||wade.isMouseDown(2)||(wade.isMouseDown()&&G))&&b>=a){bd=b;var e=j.getPosition();var c=j.getSprite().getSize();var h=new Sprite(d.shipBullet);var f=new SceneObject(h,0,e.x,e.y-c.y/2);wade.addSceneObject(f);wade.playAudio(r.shoot,false);C.push(f);f.moveTo(e.x,-500,600);f.onMoveComplete=function(){wade.removeSceneObject(this);wade.removeObjectFromArray(this,C)};if(i>0&&!cheat&&N<60){i-=10}if(i<0||i==='NaN'){i=0}}if(C.length>0){for(var g=C.length-1;g>=0;g--){var n=C[g].getOverlappingObjects();if(n.length>0){for(var l=0;l<n.length;l++){if(n[l].isEnemy){var R=n[l].getPosition();wade.app.explosion(R,1);wade.playAudio(r.hit,false);if(n[l].health>0){n[l].health-=E}if(n[l].health<=0){wade.app.explosion(R,2);wade.playAudio(r.explode,false);wade.removeSceneObject(n[l]);i+=Math.floor(n[l].initialHealth/10)*t}wade.removeSceneObject(C[g]);wade.removeObjectFromArrayByIndex(g,C);break}}}}}if(Math.floor(i/1000)>t-1&&t<5){t+=1;if(!cheat){o=100}if(J>200){J-=100}if(B>400){B-=100}if(I<50){I+=1}if(E<600){E+=(t*10)}}O.getSprite().setText(o);Y.getSprite().setText(t);X.getSprite().setText(Math.floor(i))},'fire');wade.setMainLoop(function(){var a=j.getOverlappingObjects(false,'axis-aligned');var b=false;var e=1;if(a.length>0){for(var c=0;c<a.length;c++){if(typeof(a[c])!=='undefined'){if(a[c].isEnemy||a[c].isEnemyBullet){if(typeof(a[c])!=='undefined'&&j.overlapsObject(a[c],'pixel')){if(a[c].health>0){a[c].health-=Math.floor(E/10)}if(typeof(a[c])!=='undefined'&&(a[c].isEnemyBullet||a[c].health<=0)){wade.removeSceneObject(a[c]);wade.removeObjectFromArrayByIndex(c,a)}if(typeof(a[c])!=='undefined'){e=a[c].damage||e}b=true;break}}}}}if(b){b=false;wade.app.explosion(j.getPosition(),0);wade.playAudio(r.hit,false);if(o>0){o-=e}if(o<0||o==='NaN'){o=0}O.getSprite().setText(o)}if(o<=0){var h=wade.app.explosion(j.getPosition(),2);wade.playAudio(r.explode,false);wade.removeSceneObject(j);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');if(!cheat&&i>u){k={force2d:s,music:p,highscore:i};wade.storeLocalObject(F.data,k)}var f=setInterval(function(){if(!h.isPlaying()){w=false;clearInterval(f);clearTimeout(A);clearTimeout(q);wade.clearScene();wade.app.init()}},100)}},'die');if(!w){if(cheat){o=999}else{o=100}i=0;t=1;I=4;E=200;w=true}var L=new Sprite(d.scoreIcon);var M=new SceneObject(L,0,wade.getScreenWidth()/2-20,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(M);var S=new TextSprite(i.toString(),'32pt Highspeed','#f88','right');X=new SceneObject(S,0,wade.getScreenWidth()/2-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(X);var v=new Sprite(d.healthIcon);var ba=new SceneObject(v,0,-120,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(ba);var bb=new TextSprite(o.toString(),'32pt Highspeed','#f88','center');O=new SceneObject(bb,0,-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(O);var T=new Sprite(d.levelIcon);var bc=new SceneObject(T,0,20-(wade.getScreenWidth()/2),-12-wade.getScreenHeight()/2+30);wade.addSceneObject(bc);var m=new TextSprite(t,'32pt Highspeed','#f88','left');Y=new SceneObject(m,0,40-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(Y);A=setTimeout(wade.app.spawnEnemy,J);q=setTimeout(wade.app.spawnAsteroid,B)};$(window).blur(function(){if(w&&!H){console.log('Game paused due to focus loss.');H=true;wade.pauseSimulation();clearTimeout(A);clearTimeout(q);wade.app.onMouseMove=null;wade.addSceneObject(D);K.style.cursor='default'}else{if(!w){console.log('Asteroid timeout cleared due to focus loss.');clearTimeout(q)}}return false});$(window).focus(function(){if(!w){q=setTimeout(wade.app.spawnAsteroid,B)}});this.onKeyDown=function(b){if(w&&b.keyCode===32){H=!H;if(H){wade.pauseSimulation();clearTimeout(A);clearTimeout(q);wade.app.onMouseMove=null;wade.addSceneObject(D);K.style.cursor='default'}else{K.style.cursor='none';A=setTimeout(wade.app.spawnEnemy,J);q=setTimeout(wade.app.spawnAsteroid,B);wade.removeSceneObject(D);wade.resumeSimulation();wade.app.onMouseMove=function(a){if(typeof(j)!=='undefined'){handleMouseMove(j,d,a)}}}}return false};this.onMouseMove=function(a){if(typeof(j)!=='undefined'){return handleMouseMove(j,d,a)}};this.explosion=function(a,b){if(typeof(b)==='undefined'||b===null||typeof(d.boom[b])==='undefined'){b=0}var e=new Animation(d.boom[b].file,d.boom[b].x,d.boom[b].y,d.boom[b].speed);var c=new Sprite();c.setSize(100,100);c.addAnimation('boom',e);var h=new SceneObject(c,0,a.x,a.y);wade.addSceneObject(h);h.playAnimation('boom');h.onAnimationEnd=function(){wade.removeSceneObject(this)};return e};this.spawnAsteroid=function(){var a;var b=getRandomInt(0,9);a=new Sprite(d.asteroids[b]);var e=(Math.random()-0.5)*wade.getScreenWidth();var c=(Math.random()-0.5)*wade.getScreenWidth();var h=-wade.getScreenHeight()/2-a.getSize().y/2;var f=-h;var g=new SceneObject(a,0,e,h);wade.addSceneObject(g);g.moveTo(c,f,200);g.isEnemy=true;g.isAsteroid=true;g.health=W[b];g.initialHealth=W[b];g.damage=Math.floor(W[b]/100);g.onMoveComplete=function(){wade.removeSceneObject(this)};q=setTimeout(wade.app.spawnAsteroid,B)};this.spawnEnemy=function(){var L;var M=t-1;var S=Object.keys(d.enemies).length-1;if(M>S){M=S}var v=getRandomInt(0,M);L=new Sprite(d.enemies[v]);var ba=(Math.random()-0.5)*wade.getScreenWidth();var bb=(Math.random()-0.5)*wade.getScreenWidth();var T=-wade.getScreenHeight()/2-L.getSize().y/2;var bc=-T;var m=new SceneObject(L,0,ba,T);wade.addSceneObject(m);m.moveTo(bb,bc,200);m.isEnemy=true;m.isAsteroid=false;m.health=V[v];m.initialHealth=V[v];m.damage=Math.floor(V[v]/100);m.onMoveComplete=function(){wade.removeSceneObject(this)};m.originalStep=m.step;m.step=function(){this.originalStep();var a=this.getPosition();var b=j.getPosition();var e=Math.atan2(b.y-a.y,b.x-a.x)-3.14/2;this.setRotation(e)};m.fire=function(){var a=this.getSprite().getSize();var b=this.getPosition();var e=j.getPosition();var c=e.x-b.x;var h=e.y-b.y;var f=Math.sqrt(c*c+h*h);c/=f;h/=f;var g=b.x+c*a.x/2;var n=b.y+h*a.y/2;var l=g+c*3000;var R=n+h*3000;var Z=new Sprite(d.enemyBullets[v].file);var z=new SceneObject(Z,0,g,n);z.isEnemyBullet=true;z.damage=d.enemyBullets[v].damage;wade.addSceneObject(z);z.moveTo(l,R,200);z.onMoveComplete=function(){wade.removeSceneObject(this)};this.schedule(d.enemyBullets[v].delay,'fire')};m.schedule(300,'fire');A=setTimeout(wade.app.spawnEnemy,J)};this.toggleRenderer=function(){s=!s;k={force2d:s,music:p,highscore:u};wade.storeLocalObject(F.data,k);clearTimeout(A);clearTimeout(q);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');w=false;wade.clearScene();wade.app.init()};this.toggleMusic=function(){if(wade.isWebAudioSupported()){if(p){if(x>-1){wade.stopAudio(x)}else{wade.stopAudio()}p=false;y.removeClass('music-on');y.addClass('music-off');Q.title='Enable music'}else{if(x>-1){wade.stopAudio(x)}else{wade.stopAudio()}x=wade.playAudio(r.loop,true);p=true;y.removeClass('music-off');y.addClass('music-on');Q.title='Disable music'}k={force2d:s,music:p,highscore:u};wade.storeLocalObject(F.data,k)}}};function getRandomInt(a,b){'use strict';return Math.floor(Math.random()*(b-a+1))+a}function padStrings(a){'use strict';var b='       ';var e;if(typeof(a)==='object'){e={};for(var c in a){e[c]=b+a[c]+b}}else{e=b+a+b}return e}function handleMouseMove(a,b,e){'use strict';var c=a.getPosition();var h=a.getSprite();var f=null;if(c.x<0){if(c.x>e.screenPosition.x){f=new Animation(b.fly_left,5,1,30)}else if(c.x<e.screenPosition.x){f=new Animation(b.fly_right,5,1,30)}}else if(c.x>0){if(c.x<e.screenPosition.x){f=new Animation(b.fly_right,5,1,30)}else if(c.x>e.screenPosition.x){f=new Animation(b.fly_left,5,1,30)}}if(f!==null){h.addAnimation('fly',f);a.playAnimation('fly');a.onAnimationEnd=function(){h.setImageFile(b.ship)}}return a&&a.setPosition(e.screenPosition.x,e.screenPosition.y)}