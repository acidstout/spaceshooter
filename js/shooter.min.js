var version='1.1.2';var Base64={_0:'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',encode(input){'use strict';var output='';var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=Base64._1(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64}else if(isNaN(chr3)){enc4=64}output=output+this._0.charAt(enc1)+this._0.charAt(enc2)+this._0.charAt(enc3)+this._0.charAt(enc4)}return output},decode(input){'use strict';var output='';var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace('/[^A-Za-z0-9+/=]/g','');while(i<input.length){enc1=this._0.indexOf(input.charAt(i++));enc2=this._0.indexOf(input.charAt(i++));enc3=this._0.indexOf(input.charAt(i++));enc4=this._0.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!==64){output=output+String.fromCharCode(chr2)}if(enc4!==64){output=output+String.fromCharCode(chr3)}}output=Base64._2(output);return output},_1(string){'use strict';string=string.replace('/\r\n/g','\n');var utftext='';for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c)}else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128)}else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128)}}return utftext},_2(utftext){'use strict';var string='';var i=0,c1=0,c2=0,c3=0;while(i<utftext.length){c1=utftext.charCodeAt(i);if(c1<128){string+=String.fromCharCode(c1);i++}else if((c1>191)&&(c1<224)){c3=utftext.charCodeAt(i+1);string+=String.fromCharCode(((c1&31)<<6)|(c3&63));i+=2}else{c3=utftext.charCodeAt(i+1);c2=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c1&15)<<12)|((c3&63)<<6)|(c2&63));i+=3}}return string}};function getRandomInt(a,d){'use strict';return Math.floor(Math.random()*(d-a+1))+a}function padStrings(a){'use strict';var d='       ';var e;if(typeof(a)==='object'){e={};for(var b in a){if({}.hasOwnProperty.call(a,b)){e[b]=d+a[b]+d}}}else{e=d+a+d}return e}function handleMouseMove(a,d,e){'use strict';var b=a.getPosition();var h=a.getSprite();var g=null;if(b.x<0){if(b.x>e.screenPosition.x){g=new Animation(d.flyLeft,5,1,30)}else if(b.x<e.screenPosition.x){g=new Animation(d.flyRight,5,1,30)}}else if(b.x>0){if(b.x<e.screenPosition.x){g=new Animation(d.flyRight,5,1,30)}else if(b.x>e.screenPosition.x){g=new Animation(d.flyLeft,5,1,30)}}if(g!==null){h.addAnimation('fly',g);a.playAnimation('fly');a.onAnimationEnd=function(){h.setImageFile(d.ship)}}return a&&a.setPosition(e.screenPosition.x,e.screenPosition.y)}var App=function(){'use strict';var X=false||checkForMobileDevice();var be=false||getBrowserVersion('Trident/([0-9]{1,}[.0-9]{0,})');var q;var I=false;var v=false;var J=null;var w=false;var Y=1;var bf=0;var O=4;var P=4;var K=200;var Z=[400,600,800,1500,5000];var L=2000;var F;var ba=[200,200,200,300,400,400,600,500,400,600];var B=1000;var x;var C=[];var bb;var j=0;var Q=1000;var G={data:'overkill'};var R;var s=100;var bc;var u=1;var D=null;var m=false;var o=wade.retrieveLocalObject(G.data);const sissy=(o&&o.sissy)||false;var E=(o&&o.highscore)||0;var f={logo:'../img/logo.png',ship:'../img/ship.png',boom:{0:{file:'../img/animations/explosion/explode_4x4_ship.png',speed:30,x:4,y:4},1:{file:'../img/animations/explosion/explode_4x4_ring.png',speed:30,x:4,y:4},2:{file:'../img/animations/explosion/explode_5x3_enemy.png',speed:30,x:5,y:3}},flyLeft:'../img/animations/ship/fly_left.png',flyRight:'../img/animations/ship/fly_right.png',shipBullet:'../img/bullets/bullet_ship.png',enemyBullets:{0:{file:'../img/bullets/bullet0.png',delay:600,damage:1},1:{file:'../img/bullets/bullet1.png',delay:500,damage:3},2:{file:'../img/bullets/bullet2.png',delay:400,damage:5},3:{file:'../img/bullets/bullet3.png',delay:300,damage:10},4:{file:'../img/bullets/bullet4.png',delay:200,damage:20}},enemies:{0:'../img/enemies/enemy0.png',1:'../img/enemies/enemy1.png',2:'../img/enemies/enemy2.png',3:'../img/enemies/enemy3.png',4:'../img/enemies/enemy4.png'},asteroids:{0:'../img/asteroids/asteroid0.png',1:'../img/asteroids/asteroid1.png',2:'../img/asteroids/asteroid2.png',3:'../img/asteroids/asteroid3.png',4:'../img/asteroids/asteroid4.png',5:'../img/asteroids/asteroid5.png',6:'../img/asteroids/asteroid6.png',7:'../img/asteroids/asteroid7.png',8:'../img/asteroids/asteroid8.png',9:'../img/asteroids/asteroid9.png'},healthIcon:'../img/icons/heart.png',levelIcon:'../img/icons/star.png',scoreIcon:'../img/icons/trophy.png'};var t={shoot:'../sounds/shoot.mp3',hit:'../sounds/hit.mp3',explode:'../sounds/explode.mp3',loop:'../sounds/loop.mp3',menu:'../sounds/menu.mp3'};var bg=document.getElementById('toggleRendererTitle');var S=$('#toggleRendererBtn');var T=document.getElementById('toggleMusicTitle');var z=$('#toggleMusicBtn');var U=document.getElementById('game');var bh=document.getElementById('game-icons');$('#version').text(version+', WADE '+wade.getVersion());wade.preventIframe();wade.setLoadingBar(true,{x:0,y:0},'#333333','#222222');wade.setLoadingImages('../img/loading.svg');this.load=function(){var a=0;wade.loadImage(f.logo);wade.loadImage(f.ship);wade.loadImage(f.shipBullet);for(a=0;a<Object.keys(f.enemyBullets).length;a++){wade.loadImage(f.enemyBullets[a].file)}for(a=0;a<Object.keys(f.boom).length;a++){wade.loadImage(f.boom[a].file)}wade.loadImage(f.flyLeft);wade.loadImage(f.flyRight);wade.loadImage(f.healthIcon);wade.loadImage(f.levelIcon);wade.loadImage(f.scoreIcon);for(a=0;a<Object.keys(f.enemies).length;a++){wade.loadImage(f.enemies[a])}for(a=0;a<Object.keys(f.asteroids).length;a++){wade.loadImage(f.asteroids[a])}var d=wade.isWebAudioSupported()?'loadAudio':'preloadAudio';wade[d](t.shoot);wade[d](t.hit);wade[d](t.explode);wade[d](t.loop);wade[d](t.menu)};this.init=function(){o=wade.retrieveLocalObject(G.data);w=(o&&o.force2d)||w;wade.setLayerRenderMode(Y,'2d');S.removeClass('fa-toggle-on');S.addClass('fa-toggle-off');bg.title='Enable WebGL';if(!w){wade.setLayerRenderMode(Y,'webgl');S.removeClass('fa-toggle-off');S.addClass('fa-toggle-on');bg.title='Disable WebGL'}if(wade.isWebAudioSupported()){m=(o&&o.music)||m;if(m){z.removeClass('music-off');z.addClass('music-on');T.title='Disable music'}}else{m=false}wade.setMinScreenSize($(window).width(),$(window).height());wade.setMaxScreenSize($(window).width(),$(window).height());wade.setResolutionFactor(1);if(X){wade.setMinScreenSize($(window).width()*3,$(window).height()*3);wade.setMaxScreenSize($(window).width()*3,$(window).height()*3);wade.setResolutionFactor(0.5)}var a=wade.getLayerRenderMode(Y);var d={insertCoin:'- INSERT COIN -',highscoreIs:'HIGHSCORE IS %i POINTS',youScored:'YOU %s %i POINTS'};if(a==='webgl'){d=padStrings(d)}var e=new TextSprite(d.insertCoin,'36pt Highspeed','white','center');e.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,e.draw));var b=new SceneObject();b.addSprite(e,{y:320});wade.app.getHighestScore(j,b,d);if(j>0){var h=Base64.decode('U0NPUkVE');if(sissy){h=Base64.decode('Q0hFQVRFRA==')}else{wade.app.saveHighscore(j)}var g=d.youScored.replace('%s',h);g=g.replace('%i',j);if(a==='webgl'){g=padStrings(g)}b.addSprite(new TextSprite(g,'24pt Highspeed','white','center'),{y:120});if(j>E){var k=Base64.decode('TkVXIEhJR0hTQ09SRQ==');E=j;j=0;if(sissy){k+=Base64.decode('IE5PVCBTQVZFRA==')}k+='!';if(a==='webgl'){k=padStrings(k)}var p=new TextSprite(k,'24pt Highspeed','yellow','center');b.addSprite(p,{y:160})}}b.addSprite(new Sprite(f.logo),{y:-200});J=new SceneObject();var l=new TextSprite('PAUSED','32pt Highspeed','yellow','center');l.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,l.draw));J.addSprite(new Sprite(f.logo),{y:-200});J.addSprite(l,{y:160});bh.style.display='block';U.style.cursor='default';wade.addSceneObject(b);x=setTimeout(wade.app.spawnAsteroid,B);if(wade.isWebAudioSupported()){if(m){wade.app.musicOn()}}wade.app.onMouseDown=function(){if(wade.isMouseDown(0)||(wade.isMouseDown()&&(X||be))){bh.style.display='none';U.style.cursor='none';clearTimeout(x);wade.removeSceneObject(b);wade.clearScene();wade.removeUnusedLayers([1]);wade.app.startGame();wade.app.onMouseDown=0}}};this.getHighestScore=function(b,h,g){var k=setInterval(function(){var a={'action':'getHighestScore'}var d=JSON.stringify(a);var e=Base64.encode(d);$.ajax({url:'php/backend.php',type:'POST',data:'data='+e,success(result){if(result==null||result==''||result=='FAILED'){result=E}if(b<=0||result>b){g.highscoreIs=g.highscoreIs.replace('%i',result);h.addSprite(new TextSprite(g.highscoreIs,'24pt Highspeed','yellow','center'),{y:160})}E=result;clearTimeout(k)},error(xhr,status,code){console.warn('getHighestScore(): AJAX call returned: '+status+': '+code)}})},1000)};this.loadHighscore=function(){'use strict';var e={'action':'loadScore'}var b=JSON.stringify(e);var h=Base64.encode(b);var g='Highscore not loaded!';var k=(typeof(k)!=='undefined')?k:false;$.ajax({url:'php/backend.php',type:'POST',data:'data='+h,success(result){if(result!='FAILED'){var p=JSON.parse(result);var l='';$.each(p,function(a,d){l+='<tr><td>'+d.player+'</td><td>'+d.score+'</td></tr>'});$('#highscoreTable').html(l)}},error(xhr,status,code){console.warn('AJAX call returned: '+status+': '+code);$('.msg').html(g)}})};this.saveHighscore=function(a){'use strict';var a=(typeof(a)!=='undefined')?a:j;var d={'action':'saveScore','player':g,'score':a};var e=JSON.stringify(d);var b=Base64.encode(e);var h='Highscore not saved!';var g='Player';$.ajax({url:'php/backend.php',type:'POST',data:'data='+b,success(result){if(result=='OK'){h='Highscore saved!'}else{o={force2d:w,music:m,highscore:a};wade.storeLocalObject(G.data,o)}$('.msg').html(h)},error(xhr,status,code){console.warn('saveHighscore() returned: '+status+': '+code);$('.msg').html(h)}})};this.startGame=function(){var bd=new Sprite(f.ship);var A=wade.getMousePosition();q=new SceneObject(bd,0,A.x,A.y);wade.addSceneObject(q);wade.setMainLoop(function(){P=O;if(wade.isMouseDown(2)&&sissy){P=50}var a=bf+1/P;var d=wade.getAppTime();if((wade.isMouseDown(0)||wade.isMouseDown(2)||(wade.isMouseDown()&&(X||be)))&&d>=a){bf=d;var e=q.getPosition();var b=q.getSprite().getSize();var h=new Sprite(f.shipBullet);var g=new SceneObject(h,0,e.x,e.y-b.y/2);wade.addSceneObject(g);wade.playAudio(t.shoot,false);C.push(g);g.moveTo(e.x,-500,600);g.onMoveComplete=function(){wade.removeSceneObject(this);wade.removeObjectFromArray(this,C)};if(j>0&&!sissy&&P<60){j-=10}if(j<0||j==='NaN'){j=0}}if(C.length>0){for(var k=C.length-1;k>=0;k--){var p=C[k].getOverlappingObjects();if(p.length>0){for(var l=0;l<p.length;l++){if(p[l].isEnemy){var V=p[l].getPosition();wade.app.explosion(V,1);wade.playAudio(t.hit,false);if(p[l].health>0){p[l].health-=K}if(p[l].health<=0){wade.app.explosion(V,2);wade.playAudio(t.explode,false);wade.removeSceneObject(p[l]);j+=Math.floor(p[l].initialHealth/10)*u}wade.removeSceneObject(C[k]);wade.removeObjectFromArrayByIndex(k,C);break}}}}}if(Math.floor(j/Q)>u-1&&u<5){Q=Q*Math.pow(10,u);u+=1;if(!sissy){s=100}if(L>200){L-=100}if(B>400){B-=100}if(O<50){O+=1}if(K<600){K+=(u*10)}}R.getSprite().setText(s);bc.getSprite().setText(u);bb.getSprite().setText(Math.floor(j)+', Left: '+(Q-Math.floor(j)))},'fire');wade.setMainLoop(function(){var a=q.getOverlappingObjects(false,'axis-aligned');var d=false;var e=1;if(a.length>0){for(var b=0;b<a.length;b++){if(typeof(a[b])!=='undefined'){if(a[b].isEnemy||a[b].isEnemyBullet){if(typeof(a[b])!=='undefined'&&q.overlapsObject(a[b],'pixel')){if(a[b].health>0){a[b].health-=Math.floor(K/10)}if(typeof(a[b])!=='undefined'&&(a[b].isEnemyBullet||a[b].health<=0)){wade.removeSceneObject(a[b]);wade.removeObjectFromArrayByIndex(b,a)}if(typeof(a[b])!=='undefined'){e=a[b].damage||e}d=true;break}}}}}if(d){d=false;wade.app.explosion(q.getPosition(),0);wade.playAudio(t.hit,false);if(s>0){s-=e}if(s<0||s==='NaN'){s=0}R.getSprite().setText(s)}if(s<=0){var h=wade.app.explosion(q.getPosition(),2);wade.playAudio(t.explode,false);wade.removeSceneObject(q);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');if(!sissy&&j>E){o={force2d:w,music:m,highscore:j};wade.storeLocalObject(G.data,o)}var g=setInterval(function(){if(!h.isPlaying()){v=false;if(m){wade.app.musicOn()}clearInterval(g);clearTimeout(F);clearTimeout(x);wade.clearScene();wade.app.init()}},100)}},'die');if(!v){if(sissy){s=999}else{s=100}j=0;u=1;O=4;K=200;v=true;if(m){wade.app.musicOn()}}var M=new Sprite(f.scoreIcon);var N=new SceneObject(M,0,wade.getScreenWidth()/2-20,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(N);var W=new TextSprite(j.toString(),'32pt Highspeed','#f88','right');bb=new SceneObject(W,0,wade.getScreenWidth()/2-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(bb);var y=new Sprite(f.healthIcon);var H=new SceneObject(y,0,-120,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(H);var r=new TextSprite(s.toString(),'32pt Highspeed','#f88','center');R=new SceneObject(r,0,-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(R);var bi=new Sprite(f.levelIcon);var bj=new SceneObject(bi,0,20-(wade.getScreenWidth()/2),-12-wade.getScreenHeight()/2+30);wade.addSceneObject(bj);var bk=new TextSprite(u,'32pt Highspeed','#f88','left');bc=new SceneObject(bk,0,40-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(bc);F=setTimeout(wade.app.spawnEnemy,L);x=setTimeout(wade.app.spawnAsteroid,B)};this.pauseGame=function(){clearTimeout(x);wade.app.musicOff();if(v){clearTimeout(F);wade.app.onMouseMove=null;wade.addSceneObject(J);U.style.cursor='default'}wade.pauseSimulation();return false};$(window).blur(function(){console.log('Game paused due to focus loss.');wade.app.pauseGame();if(v&&!I){I=true}return false});$(window).focus(function(){if(!v){console.log('Game resumed due to focus gain.');x=setTimeout(wade.app.spawnAsteroid,B);if(m){wade.app.musicOn()}wade.resumeSimulation()}});this.onKeyDown=function(d){if(v&&d.keyCode===32){I=!I;if(I){console.log('Game paused by user.');wade.app.pauseGame()}else{console.log('Game resumed by user.');U.style.cursor='none';F=setTimeout(wade.app.spawnEnemy,L);x=setTimeout(wade.app.spawnAsteroid,B);wade.removeSceneObject(J);if(m){wade.app.musicOn()}wade.resumeSimulation();wade.app.onMouseMove=function(a){if(typeof(q)!=='undefined'){handleMouseMove(q,f,a)}}}}return false};this.onMouseMove=function(a){if(typeof(q)!=='undefined'){return handleMouseMove(q,f,a)}};this.explosion=function(a,d){if(typeof(d)==='undefined'||d===null||typeof(f.boom[d])==='undefined'){d=0}var e=new Animation(f.boom[d].file,f.boom[d].x,f.boom[d].y,f.boom[d].speed);var b=new Sprite();b.setSize(100,100);b.addAnimation('boom',e);var h=new SceneObject(b,0,a.x,a.y);wade.addSceneObject(h);h.playAnimation('boom');h.onAnimationEnd=function(){wade.removeSceneObject(this)};return e};this.getRandomCoords=function(a){return{x1:(Math.random()-0.5)*wade.getScreenWidth(),y1:-wade.getScreenHeight()/2-a.getSize().y/2,x2:(Math.random()-0.5)*wade.getScreenWidth(),y2:Math.abs(wade.getScreenHeight()/2-a.getSize().y/2)}};this.spawnAsteroid=function(){var a;var d=getRandomInt(0,9);a=new Sprite(f.asteroids[d]);var e=wade.app.getRandomCoords(a);var b=new SceneObject(a,0,e.x1,e.y1);wade.addSceneObject(b);b.moveTo(e.x2,e.y2,200);b.isEnemy=true;b.isAsteroid=true;b.health=ba[d];b.initialHealth=ba[d];b.damage=Math.floor(ba[d]/100);b.onMoveComplete=function(){wade.removeSceneObject(this)};x=setTimeout(wade.app.spawnAsteroid,B)};this.spawnEnemy=function(){var M;var N=u-1;var W=Object.keys(f.enemies).length-1;if(N>W){N=W}var y=getRandomInt(0,N);M=new Sprite(f.enemies[y]);var H=wade.app.getRandomCoords(M);var r=new SceneObject(M,0,H.x1,H.y1);wade.addSceneObject(r);r.moveTo(H.x2,H.y2,200);r.isEnemy=true;r.isAsteroid=false;r.health=Z[y];r.initialHealth=Z[y];r.damage=Math.floor(Z[y]/100);r.onMoveComplete=function(){wade.removeSceneObject(this)};r.originalStep=r.step;r.step=function(){this.originalStep();var a=this.getPosition();var d=q.getPosition();var e=Math.atan2(d.y-a.y,d.x-a.x)-3.14/2;this.setRotation(e)};r.fire=function(){var a=this.getSprite().getSize();var d=this.getPosition();var e=q.getPosition();var b=e.x-d.x;var h=e.y-d.y;var g=Math.sqrt(b*b+h*h);b/=g;h/=g;var k=d.x+b*a.x/2;var p=d.y+h*a.y/2;var l=k+b*3000;var V=p+h*3000;var bd=new Sprite(f.enemyBullets[y].file);var A=new SceneObject(bd,0,k,p);A.isEnemyBullet=true;A.damage=f.enemyBullets[y].damage;wade.addSceneObject(A);A.moveTo(l,V,200);A.onMoveComplete=function(){wade.removeSceneObject(this)};this.schedule(f.enemyBullets[y].delay,'fire')};r.schedule(300,'fire');F=setTimeout(wade.app.spawnEnemy,L)};this.toggleRenderer=function(){w=!w;o={force2d:w,music:m,highscore:E};wade.storeLocalObject(G.data,o);clearTimeout(F);clearTimeout(x);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');v=false;wade.clearScene();wade.app.init()};this.musicOn=function(){if(D>-1){wade.stopAudio(D)}else{wade.stopAudio()}if(v){D=wade.playAudio(t.loop,true)}else{D=wade.playAudio(t.menu,true)}if(D<0){z.removeClass('music-on');z.addClass('music-off');T.title='Enable music';m=false}return false};this.musicOff=function(){if(D>-1){wade.stopAudio(D)}else{wade.stopAudio()}return false};this.toggleMusic=function(){if(m){m=false;z.removeClass('music-on');z.addClass('music-off');T.title='Enable music';wade.app.musicOff()}else{m=true;z.removeClass('music-off');z.addClass('music-on');T.title='Disable music';wade.app.musicOn()}o={force2d:w,music:m,highscore:E};wade.storeLocalObject(G.data,o);return false}};