var cheat=false;var App=function(){var a;var i=0;var j=4;var m=4;var q=200;var h=[400,800,1200,1600];var k=2000;var c;var p=[200,200,400,400,400,600,800];var n=1000;var e;var f=[];var r;var l=0;var s;var o=100;var d;var b=1;var g={logo:"../img/logo.png",ship:"../img/ship.png",boom:"../img/animations/boom.png",bullet:"../img/bullets/bullet0.png",enemyBullet:"../img/bullets/bullet1.png",enemy0:"../img/enemies/enemy0.png",enemy1:"../img/enemies/enemy1.png",enemy2:"../img/enemies/enemy2.png",enemy3:"../img/enemies/enemy3.png",asteroid0:"../img/asteroids/asteroid0.png",asteroid1:"../img/asteroids/asteroid1.png",asteroid2:"../img/asteroids/asteroid2.png",asteroid3:"../img/asteroids/asteroid3.png",asteroid4:"../img/asteroids/asteroid4.png",asteroid5:"../img/asteroids/asteroid5.png",asteroid6:"../img/asteroids/asteroid6.png",healthIcon:"../img/icons/heart.png",levelIcon:"../img/icons/star.png",scoreIcon:"../img/icons/trophy.png"};if(cheat){o=999}this.load=function(){wade.loadImage(g.logo);wade.loadImage(g.ship);wade.loadImage(g.bullet);wade.loadImage(g.enemyBullet);wade.loadImage(g.enemy0);wade.loadImage(g.enemy1);wade.loadImage(g.enemy2);wade.loadImage(g.enemy3);wade.loadImage(g.asteroid0);wade.loadImage(g.asteroid1);wade.loadImage(g.asteroid2);wade.loadImage(g.asteroid3);wade.loadImage(g.asteroid4);wade.loadImage(g.asteroid5);wade.loadImage(g.asteroid6);wade.loadImage(g.boom);wade.loadImage(g.healthIcon);wade.loadImage(g.levelIcon);wade.loadImage(g.scoreIcon)};this.init=function(){var u=wade.retrieveLocalObject("shooterData");var w=(u&&u.highScore)||0;var t=document.getElementById("game");var x=document.getElementById("game-icons");var v=new TextSprite("Insert coin","36pt Highspeed","white","center");v.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,v.draw));var y=new SceneObject(v);y.addSprite(new TextSprite("Highscore is "+w,"24pt Highspeed","yellow","center"),{y:140});if(l>0){y.addSprite(new TextSprite("Your current score is "+l,"24pt Highspeed","white","center"),{y:175})}y.addSprite(new Sprite(g.logo),{y:-200});x.style.display="block";game.style.cursor="default";wade.addSceneObject(y);wade.app.onMouseDown=function(){wade.removeSceneObject(y);wade.app.startGame();wade.app.onMouseDown=0;x.style.display="none";game.style.cursor="none"}};this.startGame=function(){var A=new Sprite(g.ship);var D=wade.getMousePosition();a=new SceneObject(A,0,D.x,D.y);wade.addSceneObject(a);wade.setMainLoop(function(){m=j;if(wade.isMouseDown("2")&&cheat){m=60}var M=i+1/m;var F=wade.getAppTime();if(wade.isMouseDown()&&F>=M){i=F;var H=a.getPosition();var K=a.getSprite().getSize();var N=new Sprite(g.bullet);var E=new SceneObject(N,0,H.x,H.y-K.y/2);wade.addSceneObject(E);f.push(E);E.moveTo(H.x,-500,600);E.onMoveComplete=function(){wade.removeSceneObject(this);wade.removeObjectFromArray(this,f)};if(l>0&&!cheat&&m<60){l-=10}if(l<0){l=0}}if(f.length>0){for(var I=f.length-1;I>=0;I--){var L=f[I].getOverlappingObjects();if(L.length>0){for(var G=0;G<L.length;G++){if(L[G].isEnemy){var J=L[G].getPosition();wade.app.explosion(J);if(L[G].health>0){L[G].health-=q}if(L[G].health<=0){wade.removeSceneObject(L[G]);l+=Math.floor(L[G].initialHealth/10)}wade.removeSceneObject(f[I]);wade.removeObjectFromArrayByIndex(I,f);break}}}}}if(Math.floor(l/1000)>b){b+=1;o+=10;if(k>200){k-=100}if(n>400){n-=100}if(j<50){j+=1}if(q<600){q+=(b*10)}}if(cheat||o>999){o=999}s.getSprite().setText(o);d.getSprite().setText(b);r.getSprite().setText(Math.floor(l))},"fire");wade.setMainLoop(function(){var E=a.getOverlappingObjects(false,"axis-aligned");var I=false;if(E.length>0){for(var G=0;G<E.length;G++){if(E[G].isEnemy||E[G].isEnemyBullet){if(a.overlapsObject(E[G],"pixel")){wade.app.explosion(a.getPosition());I=true}}}}if(I){I=false;o--;s.getSprite().setText(o);if(o<=0){wade.removeSceneObject(a);wade.setMainLoop(null,"fire");wade.setMainLoop(null,"die");var F=wade.retrieveLocalObject("shooterData");var H=(F&&F.highScore)||0;if(l>H){F={highScore:l};wade.storeLocalObject("shooterData",F)}wade.clearScene();wade.app.init();clearTimeout(c);clearTimeout(e)}}},"die");o=100;l=0;b=1;var y=new Sprite(g.scoreIcon);var z=new SceneObject(y,0,wade.getScreenWidth()/2-20,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(z);var B=new TextSprite(l.toString(),"32pt Verdana","#f88","right");r=new SceneObject(B,0,wade.getScreenWidth()/2-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(r);var u=new Sprite(g.healthIcon);var v=new SceneObject(u,0,-120,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(v);var C=new TextSprite(o.toString(),"32pt Verdana","#f88","center");s=new SceneObject(C,0,-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(s);var w=new Sprite(g.levelIcon);var t=new SceneObject(w,0,20-(wade.getScreenWidth()/2),-12-wade.getScreenHeight()/2+30);wade.addSceneObject(t);var x=new TextSprite(b,"32pt Verdana","#f88","left");d=new SceneObject(x,0,40-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(d);c=setTimeout(wade.app.spawnEnemy,k);e=setTimeout(wade.app.spawnAsteroid,n)};this.onMouseMove=function(t){a&&a.setPosition(t.screenPosition.x,t.screenPosition.y)};this.explosion=function(u){var v=new Animation(g.boom,6,4,30);var t=new Sprite();t.setSize(100,100);t.addAnimation("boom",v);var w=new SceneObject(t,0,u.x,u.y);wade.addSceneObject(w);w.playAnimation("boom");w.onAnimationEnd=function(){wade.removeSceneObject(this)}};this.spawnAsteroid=function(){var w;var y=getRandomInt(0,6);switch(y){case 1:w=new Sprite(g.asteroid1);break;case 2:w=new Sprite(g.asteroid2);break;case 3:w=new Sprite(g.asteroid3);break;case 4:w=new Sprite(g.asteroid4);break;case 5:w=new Sprite(g.asteroid5);break;case 6:w=new Sprite(g.asteroid6);break;default:w=new Sprite(g.asteroid0);break}var u=(Math.random()-0.5)*wade.getScreenWidth();var z=(Math.random()-0.5)*wade.getScreenWidth();var t=-wade.getScreenHeight()/2-w.getSize().y/2;var x=-t;var v=new SceneObject(w,0,u,t);wade.addSceneObject(v);v.moveTo(z,x,200);v.isEnemy=true;v.health=p[y];v.initialHealth=p[y];v.onMoveComplete=function(){wade.removeSceneObject(this)};e=setTimeout(wade.app.spawnAsteroid,n)};this.spawnEnemy=function(){var w;var z=getRandomInt(0,3);switch(z){case 1:w=new Sprite(g.enemy1);break;case 2:w=new Sprite(g.enemy2);break;case 3:w=new Sprite(g.enemy3);break;default:w=new Sprite(g.enemy0);break}var v=(Math.random()-0.5)*wade.getScreenWidth();var y=(Math.random()-0.5)*wade.getScreenWidth();var t=-wade.getScreenHeight()/2-w.getSize().y/2;var x=-t;var u=new SceneObject(w,0,v,t);wade.addSceneObject(u);u.moveTo(y,x,200);u.isEnemy=true;u.health=h[z];u.initialHealth=h[z];u.onMoveComplete=function(){wade.removeSceneObject(this)};u.originalStep=u.step;u.step=function(){this.originalStep();var A=this.getPosition();var B=a.getPosition();var C=Math.atan2(B.y-A.y,B.x-A.x)-3.14/2;this.setRotation(C)};u.fire=function(){var K=this.getSprite().getSize();var G=this.getPosition();var E=a.getPosition();var L=E.x-G.x;var J=E.y-G.y;var B=Math.sqrt(L*L+J*J);L/=B;J/=B;var D=G.x+L*K.x/2;var C=G.y+J*K.y/2;var I=D+L*3000;var H=C+J*3000;var F=new Sprite(g.enemyBullet);var A=new SceneObject(F,0,D,C);A.isEnemyBullet=true;wade.addSceneObject(A);A.moveTo(I,H,200);A.onMoveComplete=function(){wade.removeSceneObject(this)};this.schedule(600,"fire")};u.schedule(300,"fire");c=setTimeout(wade.app.spawnEnemy,k)}};function getRandomInt(b,a){return Math.floor(Math.random()*(a-b+1))+b};