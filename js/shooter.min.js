var version="1.0.2";var cheat=false;var isMobileDevice=isMobileDevice();if(isMobileDevice){console.log("Detected mobile device.");$(".game-icons").css({top:"3em"})}$("#version").text(version);var App=function(){var b;var a=false;var E=false;var e=null;var y=false;var d=1;var p=0;var q=4;var t=4;var C=200;var o=[400,600,800,1500,5000];var r=2000;var f;var x=[200,200,200,300,400,400,600,500,400,600];var u=1000;var i;var j=[];var B;var s=0;var D;var w=100;var h;var c=1;var A=null;var v=false;var m={logo:"../img/logo.png",ship:"../img/ship.png",boom:{0:{file:"../img/animations/explosion/explode_4x4_ship.png",speed:30,x:4,y:4},1:{file:"../img/animations/explosion/explode_4x4_ring.png",speed:30,x:4,y:4},2:{file:"../img/animations/explosion/explode_5x3_enemy.png",speed:30,x:5,y:3}},fly_left:"../img/animations/ship/fly_left.png",fly_right:"../img/animations/ship/fly_right.png",shipBullet:"../img/bullets/bullet_ship.png",enemyBullets:{0:{file:"../img/bullets/bullet0.png",delay:600,damage:1},1:{file:"../img/bullets/bullet1.png",delay:500,damage:3},2:{file:"../img/bullets/bullet2.png",delay:400,damage:5},3:{file:"../img/bullets/bullet3.png",delay:300,damage:10},4:{file:"../img/bullets/bullet4.png",delay:200,damage:20}},enemies:{0:"../img/enemies/enemy0.png",1:"../img/enemies/enemy1.png",2:"../img/enemies/enemy2.png",3:"../img/enemies/enemy3.png",4:"../img/enemies/enemy4.png"},asteroids:{0:"../img/asteroids/asteroid0.png",1:"../img/asteroids/asteroid1.png",2:"../img/asteroids/asteroid2.png",3:"../img/asteroids/asteroid3.png",4:"../img/asteroids/asteroid4.png",5:"../img/asteroids/asteroid5.png",6:"../img/asteroids/asteroid6.png",7:"../img/asteroids/asteroid7.png",8:"../img/asteroids/asteroid8.png",9:"../img/asteroids/asteroid9.png"},healthIcon:"../img/icons/heart.png",levelIcon:"../img/icons/star.png",scoreIcon:"../img/icons/trophy.png"};var n={shoot:"../sounds/shoot.mp3",hit:"../sounds/hit.mp3",explode:"../sounds/explode.mp3",loop:"../sounds/loop.mp3"};var z=document.getElementById("toggleRendererTitle");var l=$("#toggleRendererBtn");var g=document.getElementById("toggleMusicTitle");var k=$("#toggleMusicBtn");wade.setLoadingBar(true,{x:0,y:0},"#333333","#222222");wade.setLoadingImages("../img/loading.svg");this.load=function(){wade.loadImage(m.logo);wade.loadImage(m.ship);wade.loadImage(m.shipBullet);for(var F=0;F<Object.keys(m.enemyBullets).length;F++){wade.loadImage(m.enemyBullets[F].file)}for(var F=0;F<Object.keys(m.boom).length;F++){wade.loadImage(m.boom[F].file)}wade.loadImage(m.fly_left);wade.loadImage(m.fly_right);wade.loadImage(m.healthIcon);wade.loadImage(m.levelIcon);wade.loadImage(m.scoreIcon);for(var F=0;F<Object.keys(m.enemies).length;F++){wade.loadImage(m.enemies[F])}for(var F=0;F<Object.keys(m.asteroids).length;F++){wade.loadImage(m.asteroids[F])}wade.loadAudio(n.shoot);wade.loadAudio(n.hit);wade.loadAudio(n.explode);wade.loadAudio(n.loop)};this.init=function(){var G=wade.retrieveLocalObject("force2d");y=(G&&G.force2d)||y;y=(getCookie("force2d")=="true")||y;if(y){wade.setLayerRenderMode(d,"2d");l.removeClass("fa-toggle-on");l.addClass("fa-toggle-off");z.title="Enable WebGL"}else{wade.setLayerRenderMode(d,"webgl");l.removeClass("fa-toggle-off");l.addClass("fa-toggle-on");z.title="Disable WebGL"}var M=wade.retrieveLocalObject("music");v=(M&&M.music)||v;v=(getCookie("music")=="true")||v;if(v){k.removeClass("music-off");k.addClass("music-on");g.title="Disable music"}wade.setMinScreenSize($(window).width(),$(window).height());wade.setMaxScreenSize($(window).width(),$(window).height());wade.setResolutionFactor(1);if(isMobileDevice){wade.setMinScreenSize($(window).width()*3,$(window).height()*3);wade.setMaxScreenSize($(window).width()*3,$(window).height()*3);wade.setResolutionFactor(0.5)}var W=wade.getLayerRenderMode(d);if(debug){log("browser screen size: "+$(window).width()+"x"+$(window).height()+", actual min screen size: "+wade.getMinScreenWidth()+"x"+wade.getMinScreenHeight()+", actual max screen size: "+wade.getMaxScreenWidth()+"x"+wade.getMaxScreenHeight()+", render-mode: "+W+", force2d: "+y+", isMobile: "+isMobileDevice)}var R=wade.retrieveLocalObject("shooterData");var V=(R&&R.oldHighScore)||0;var Q=(R&&R.newHighScore)||0;var K=document.getElementById("game");var U=document.getElementById("game-icons");var F=V;var S="overkill_highscore";var N=getCookie(S);if(typeof(N)!="undefined"&&N!=null){if(N>V){V=N}}if(Q>V){F=Q}var L={insertCoin:"- INSERT COIN -",highscoreIs:"HIGHSCORE IS %i POINTS",youScored:"YOU %s %i POINTS"};if(W=="webgl"){L=padStrings(L)}var J=new TextSprite(L.insertCoin,"36pt Highspeed","white","center");J.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,J.draw));var X=new SceneObject();X.addSprite(J,{y:320});if(s>0){var T="SCORED";if(cheat){T="CHEATED"}var I=L.youScored.replace("%s",T);I=I.replace("%i",s);if(W=="webgl"){I=padStrings(I)}X.addSprite(new TextSprite(I,"24pt Highspeed","white","center"),{y:120});if(Q>V){var H="NEW HIGHSCORE";if(cheat){H+=" NOT SAVED"}H+="!";if(W=="webgl"){H=padStrings(H)}var P=new TextSprite(H,"24pt Highspeed","yellow","center");X.addSprite(P,{y:160})}}if(s<=0||V>=Q){L.highscoreIs=L.highscoreIs.replace("%i",F);X.addSprite(new TextSprite(L.highscoreIs,"24pt Highspeed","yellow","center"),{y:160})}if(!cheat){setCookie(S,F,365);R={oldHighScore:F,newHighScore:Q};wade.storeLocalObject("shooterData",R)}X.addSprite(new Sprite(m.logo),{y:-200});e=new SceneObject();var O=new TextSprite("PAUSED","32pt Highspeed","yellow","center");O.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,O.draw));e.addSprite(new Sprite(m.logo),{y:-200});e.addSprite(O,{y:160});U.style.display="block";game.style.cursor="default";wade.addSceneObject(X);i=setTimeout(wade.app.spawnAsteroid,u);if(v){A=wade.playAudio(n.loop,true);if(A<0){k.removeClass("music-on");k.addClass("music-off");g.title="Enable music";v=false}}wade.app.onMouseDown=function(){if(wade.isMouseDown(0)||(wade.isMouseDown()&&isMobileDevice)){U.style.display="none";game.style.cursor="none";clearTimeout(i);wade.removeSceneObject(X);wade.clearScene();wade.app.startGame();wade.app.onMouseDown=0}}};this.startGame=function(){var M=new Sprite(m.ship);var P=wade.getMousePosition();b=new SceneObject(M,0,P.x,P.y);wade.addSceneObject(b);wade.setMainLoop(function(){t=q;if(wade.isMouseDown(2)&&cheat){t=50}var Y=p+1/t;var R=wade.getAppTime();if((wade.isMouseDown(0)||wade.isMouseDown(2)||(wade.isMouseDown()&&isMobileDevice))&&R>=Y){p=R;var T=b.getPosition();var W=b.getSprite().getSize();var Z=new Sprite(m.shipBullet);var Q=new SceneObject(Z,0,T.x,T.y-W.y/2);wade.addSceneObject(Q);wade.playAudio(n.shoot,false);j.push(Q);Q.moveTo(T.x,-500,600);Q.onMoveComplete=function(){wade.removeSceneObject(this);wade.removeObjectFromArray(this,j)};if(s>0&&!cheat&&t<60){s-=10}if(s<0||s=="NaN"){s=0}}if(j.length>0){for(var U=j.length-1;U>=0;U--){var X=j[U].getOverlappingObjects();if(X.length>0){for(var S=0;S<X.length;S++){if(X[S].isEnemy){var V=X[S].getPosition();wade.app.explosion(V,1);wade.playAudio(n.hit,false);if(X[S].health>0){X[S].health-=C}if(X[S].health<=0){wade.app.explosion(V,2);wade.playAudio(n.explode,false);wade.removeSceneObject(X[S]);s+=Math.floor(X[S].initialHealth/10)*c}wade.removeSceneObject(j[U]);wade.removeObjectFromArrayByIndex(U,j);break}}}}}if(Math.floor(s/1000)>c&&c<5){c+=1;if(!cheat){w=100}if(r>200){r-=100}if(u>400){u-=100}if(q<50){q+=1}if(C<600){C+=(c*10)}}D.getSprite().setText(w);h.getSprite().setText(c);B.getSprite().setText(Math.floor(s))},"fire");wade.setMainLoop(function(){var R=b.getOverlappingObjects(false,"axis-aligned");var W=false;var Q=1;if(R.length>0){for(var U=0;U<R.length;U++){if(typeof(R[U])!="undefined"){if(R[U].isEnemy||R[U].isEnemyBullet){if(typeof(R[U])!="undefined"&&b.overlapsObject(R[U],"pixel")){if(R[U].health>0){R[U].health-=Math.floor(C/10)}if(typeof(R[U])!="undefined"&&(R[U].isEnemyBullet||R[U].health<=0)){wade.removeSceneObject(R[U]);wade.removeObjectFromArrayByIndex(U,R)}if(typeof(R[U])!="undefined"){Q=R[U].damage||Q}W=true;break}}}}}if(W){W=false;wade.app.explosion(b.getPosition(),0);wade.playAudio(n.hit,false);if(w>0){w-=Q}if(w<0||w=="NaN"){w=0}D.getSprite().setText(w);if(w<=0){wade.app.explosion(b.getPosition(),2);wade.playAudio(n.explode,false);wade.removeSceneObject(b);wade.setMainLoop(null,"fire");wade.setMainLoop(null,"die");var S=wade.retrieveLocalObject("shooterData");var V=(S&&S.oldHighScore)||0;if(s>V){S={oldHighScore:V,newHighScore:s};wade.storeLocalObject("shooterData",S)}var T=setTimeout(function(){E=false;clearTimeout(f);clearTimeout(i);wade.clearScene();wade.app.init()},250)}}},"die");if(!E){if(cheat){w=999}else{w=100}s=0;c=1;E=true}var K=new Sprite(m.scoreIcon);var L=new SceneObject(K,0,wade.getScreenWidth()/2-20,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(L);var N=new TextSprite(s.toString(),"32pt Highspeed","#f88","right");B=new SceneObject(N,0,wade.getScreenWidth()/2-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(B);var G=new Sprite(m.healthIcon);var H=new SceneObject(G,0,-120,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(H);var O=new TextSprite(w.toString(),"32pt Highspeed","#f88","center");D=new SceneObject(O,0,-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(D);var I=new Sprite(m.levelIcon);var F=new SceneObject(I,0,20-(wade.getScreenWidth()/2),-12-wade.getScreenHeight()/2+30);wade.addSceneObject(F);var J=new TextSprite(c,"32pt Highspeed","#f88","left");h=new SceneObject(J,0,40-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(h);f=setTimeout(wade.app.spawnEnemy,r);i=setTimeout(wade.app.spawnAsteroid,u)};$(window).blur(function(){if(E&&!a){console.log("Game paused due to focus loss.");a=true;wade.pauseSimulation();clearTimeout(f);clearTimeout(i);wade.app.onMouseMove=null;wade.addSceneObject(e);game.style.cursor="default"}else{if(!E){console.log("Asteroid timeout cleared due to focus loss.");clearTimeout(i)}}return false});$(window).focus(function(){if(!E){i=setTimeout(wade.app.spawnAsteroid,u)}});this.onKeyDown=function(F){if(E&&F.keyCode==32){a=!a;if(a){wade.pauseSimulation();clearTimeout(f);clearTimeout(i);wade.app.onMouseMove=null;wade.addSceneObject(e);game.style.cursor="default"}else{game.style.cursor="none";f=setTimeout(wade.app.spawnEnemy,r);i=setTimeout(wade.app.spawnAsteroid,u);wade.removeSceneObject(e);wade.resumeSimulation();wade.app.onMouseMove=function(G){if(typeof(b)!="undefined"){handleMouseMove(b,m,G)}}}}return false};this.onMouseMove=function(F){if(typeof(b)!="undefined"){handleMouseMove(b,m,F)}};this.explosion=function(G,H){if(typeof(H)=="undefined"||H==null||typeof(m.boom[H])=="undefined"){H=0}var I=new Animation(m.boom[H].file,m.boom[H].x,m.boom[H].y,m.boom[H].speed);var F=new Sprite();F.setSize(100,100);F.addAnimation("boom",I);var J=new SceneObject(F,0,G.x,G.y);wade.addSceneObject(J);J.playAnimation("boom");J.onAnimationEnd=function(){wade.removeSceneObject(this)}};this.spawnAsteroid=function(){var I;var K=getRandomInt(0,9);I=new Sprite(m.asteroids[K]);var G=(Math.random()-0.5)*wade.getScreenWidth();var L=(Math.random()-0.5)*wade.getScreenWidth();var F=-wade.getScreenHeight()/2-I.getSize().y/2;var J=-F;var H=new SceneObject(I,0,G,F);wade.addSceneObject(H);H.moveTo(L,J,200);H.isEnemy=true;H.isAsteroid=true;H.health=x[K];H.initialHealth=x[K];H.damage=Math.floor(x[K]/100);H.onMoveComplete=function(){wade.removeSceneObject(this)};i=setTimeout(wade.app.spawnAsteroid,u)};this.spawnEnemy=function(){var K;var F=c-1;var I=Object.keys(m.enemies).length-1;if(F>I){F=I}var M=getRandomInt(0,F);K=new Sprite(m.enemies[M]);var J=(Math.random()-0.5)*wade.getScreenWidth();var N=(Math.random()-0.5)*wade.getScreenWidth();var H=-wade.getScreenHeight()/2-K.getSize().y/2;var L=-H;var G=new SceneObject(K,0,J,H);wade.addSceneObject(G);G.moveTo(N,L,200);G.isEnemy=true;G.isAsteroid=false;G.health=o[M];G.initialHealth=o[M];G.damage=Math.floor(o[M]/100);G.onMoveComplete=function(){wade.removeSceneObject(this)};G.originalStep=G.step;G.step=function(){this.originalStep();var O=this.getPosition();var P=b.getPosition();var Q=Math.atan2(P.y-O.y,P.x-O.x)-3.14/2;this.setRotation(Q)};G.fire=function(){var Y=this.getSprite().getSize();var U=this.getPosition();var S=b.getPosition();var Z=S.x-U.x;var X=S.y-U.y;var P=Math.sqrt(Z*Z+X*X);Z/=P;X/=P;var R=U.x+Z*Y.x/2;var Q=U.y+X*Y.y/2;var W=R+Z*3000;var V=Q+X*3000;var T=new Sprite(m.enemyBullets[M].file);var O=new SceneObject(T,0,R,Q);O.isEnemyBullet=true;O.damage=m.enemyBullets[M].damage;wade.addSceneObject(O);O.moveTo(W,V,200);O.onMoveComplete=function(){wade.removeSceneObject(this)};this.schedule(m.enemyBullets[M].delay,"fire")};G.schedule(300,"fire");f=setTimeout(wade.app.spawnEnemy,r)};this.toggleRenderer=function(){y=!y;var F={force2d:y};wade.storeLocalObject("force2d",F);setCookie("force2d",y,365);clearTimeout(f);clearTimeout(i);wade.setMainLoop(null,"fire");wade.setMainLoop(null,"die");E=false;wade.clearScene();wade.app.init()};this.toggleMusic=function(){if(v){if(A>-1){wade.stopAudio(A)}k.removeClass("music-on");k.addClass("music-off");g.title="Enable music"}else{A=wade.playAudio(n.loop,true);k.removeClass("music-off");k.addClass("music-on");g.title="Disable music"}v=!v;var F={music:v};wade.storeLocalObject("music",F);setCookie("music",v,365)}};function getRandomInt(b,a){return Math.floor(Math.random()*(a-b+1))+b}function padStrings(d){var c="       ";if(typeof(d)=="object"){var b={};for(var a in d){b[a]=c+d[a]+c}}else{b=c+d+c}return b}function handleMouseMove(f,a,d){var c=f.getPosition();var b=f.getSprite();var e=null;if(c.x<0){if(c.x>d.screenPosition.x){e=new Animation(a.fly_left,5,1,30)}else{if(c.x<d.screenPosition.x){e=new Animation(a.fly_right,5,1,30)}}}else{if(c.x>0){if(c.x<d.screenPosition.x){e=new Animation(a.fly_right,5,1,30)}else{if(c.x>d.screenPosition.x){e=new Animation(a.fly_left,5,1,30)}}}}if(e!=null){b.addAnimation("fly",e);f.playAnimation("fly");f.onAnimationEnd=function(){b.setImageFile(a.ship)}}f&&f.setPosition(d.screenPosition.x,d.screenPosition.y)};