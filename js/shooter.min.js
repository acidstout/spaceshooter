const version='1.0.3';const cheat=false;const isMobileDevice=checkForMobileDevice();if(isMobileDevice){console.log('Detected mobile device.');$('.game-icons').css({'top':'3em'})}$('#version').text(version);var App=function(){'use strict';var j;var H=false;var w=false;var G=null;var s=false;var Q=1;var W=0;var L=4;var M=4;var I=200;var R=[400,600,800,1500,5000];var J=2000;var B;var S=[200,200,200,300,400,400,600,500,400,600];var C=1000;var r;var D=[];var T;var k=0;var N;var q=100;var U;var t=1;var x=null;var o=false;const images={logo:'../img/logo.png',ship:'../img/ship.png',boom:{0:{file:'../img/animations/explosion/explode_4x4_ship.png',speed:30,x:4,y:4},1:{file:'../img/animations/explosion/explode_4x4_ring.png',speed:30,x:4,y:4},2:{file:'../img/animations/explosion/explode_5x3_enemy.png',speed:30,x:5,y:3}},fly_left:'../img/animations/ship/fly_left.png',fly_right:'../img/animations/ship/fly_right.png',shipBullet:'../img/bullets/bullet_ship.png',enemyBullets:{0:{file:'../img/bullets/bullet0.png',delay:600,damage:1},1:{file:'../img/bullets/bullet1.png',delay:500,damage:3},2:{file:'../img/bullets/bullet2.png',delay:400,damage:5},3:{file:'../img/bullets/bullet3.png',delay:300,damage:10},4:{file:'../img/bullets/bullet4.png',delay:200,damage:20}},enemies:{0:'../img/enemies/enemy0.png',1:'../img/enemies/enemy1.png',2:'../img/enemies/enemy2.png',3:'../img/enemies/enemy3.png',4:'../img/enemies/enemy4.png'},asteroids:{0:'../img/asteroids/asteroid0.png',1:'../img/asteroids/asteroid1.png',2:'../img/asteroids/asteroid2.png',3:'../img/asteroids/asteroid3.png',4:'../img/asteroids/asteroid4.png',5:'../img/asteroids/asteroid5.png',6:'../img/asteroids/asteroid6.png',7:'../img/asteroids/asteroid7.png',8:'../img/asteroids/asteroid8.png',9:'../img/asteroids/asteroid9.png'},healthIcon:'../img/icons/heart.png',levelIcon:'../img/icons/star.png',scoreIcon:'../img/icons/trophy.png'};const sounds={shoot:'../sounds/shoot.mp3',hit:'../sounds/hit.mp3',explode:'../sounds/explode.mp3',loop:'../sounds/loop.mp3'};var X=document.getElementById('toggleRendererTitle');var O=$('#toggleRendererBtn');var P=document.getElementById('toggleMusicTitle');var y=$('#toggleMusicBtn');wade.setLoadingBar(true,{x:0,y:0},'#333333','#222222');wade.setLoadingImages('../img/loading.svg');this.load=function(){wade.loadImage(images.logo);wade.loadImage(images.ship);wade.loadImage(images.shipBullet);for(var a=0;a<Object.keys(images.enemyBullets).length;a++){wade.loadImage(images.enemyBullets[a].file)}for(var a=0;a<Object.keys(images.boom).length;a++){wade.loadImage(images.boom[a].file)}wade.loadImage(images.fly_left);wade.loadImage(images.fly_right);wade.loadImage(images.healthIcon);wade.loadImage(images.levelIcon);wade.loadImage(images.scoreIcon);for(var a=0;a<Object.keys(images.enemies).length;a++){wade.loadImage(images.enemies[a])}for(var a=0;a<Object.keys(images.asteroids).length;a++){wade.loadImage(images.asteroids[a])}wade.loadAudio(sounds.shoot);wade.loadAudio(sounds.hit);wade.loadAudio(sounds.explode);wade.loadAudio(sounds.loop)};this.init=function(){var a=wade.retrieveLocalObject('force2d');s=(a&&a.force2d)||s;s=(getCookie('force2d')=='true')||s;if(s){wade.setLayerRenderMode(Q,'2d');O.removeClass('fa-toggle-on');O.addClass('fa-toggle-off');X.title='Enable WebGL'}else{wade.setLayerRenderMode(Q,'webgl');O.removeClass('fa-toggle-off');O.addClass('fa-toggle-on');X.title='Disable WebGL'}if(wade.isWebAudioSupported()){var c=wade.retrieveLocalObject('music');o=(c&&c.music)||o;o=(getCookie('music')=='true')||o;if(o){y.removeClass('music-off');y.addClass('music-on');P.title='Disable music'}}else{o=false}wade.setMinScreenSize($(window).width(),$(window).height());wade.setMaxScreenSize($(window).width(),$(window).height());wade.setResolutionFactor(1);if(isMobileDevice){wade.setMinScreenSize($(window).width()*3,$(window).height()*3);wade.setMaxScreenSize($(window).width()*3,$(window).height()*3);wade.setResolutionFactor(0.5)}var d=wade.getLayerRenderMode(Q);if(debug){log('browser screen size: '+$(window).width()+'x'+$(window).height()+', actual min screen size: '+wade.getMinScreenWidth()+'x'+wade.getMinScreenHeight()+', actual max screen size: '+wade.getMaxScreenWidth()+'x'+wade.getMaxScreenHeight()+', render-mode: '+d+', force2d: '+s+', isMobile: '+isMobileDevice)}var b=wade.retrieveLocalObject('shooterData');var e=(b&&b.oldHighScore)||0;var f=(b&&b.newHighScore)||0;var g=document.getElementById('game');var l=document.getElementById('game-icons');var h=e;var E='overkill_highscore';var z=getCookie(E);if(typeof(z)!='undefined'&&z!==null){if(z>e){e=z}}if(f>e){h=f}var i={insertCoin:'- INSERT COIN -',highscoreIs:'HIGHSCORE IS %i POINTS',youScored:'YOU %s %i POINTS'};if(d=='webgl'){i=padStrings(i)}var u=new TextSprite(i.insertCoin,'36pt Highspeed','white','center');u.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,u.draw));var p=new SceneObject();p.addSprite(u,{y:320});if(k>0){var F='SCORED';if(cheat){F='CHEATED'}var m=i.youScored.replace('%s',F);m=m.replace('%i',k);if(d=='webgl'){m=padStrings(m)}p.addSprite(new TextSprite(m,'24pt Highspeed','white','center'),{y:120});if(f>e){var v='NEW HIGHSCORE';if(cheat){v+=' NOT SAVED'}v+='!';if(d=='webgl'){v=padStrings(v)}var K=new TextSprite(v,'24pt Highspeed','yellow','center');p.addSprite(K,{y:160})}}if(k<=0||e>=f){i.highscoreIs=i.highscoreIs.replace('%i',h);p.addSprite(new TextSprite(i.highscoreIs,'24pt Highspeed','yellow','center'),{y:160})}if(!cheat){setCookie(E,h,365);b={oldHighScore:h,newHighScore:f};wade.storeLocalObject('shooterData',b)}p.addSprite(new Sprite(images.logo),{y:-200});G=new SceneObject();var A=new TextSprite('PAUSED','32pt Highspeed','yellow','center');A.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,A.draw));G.addSprite(new Sprite(images.logo),{y:-200});G.addSprite(A,{y:160});l.style.display='block';g.style.cursor='default';wade.addSceneObject(p);r=setTimeout(wade.app.spawnAsteroid,C);if(wade.isWebAudioSupported()){if(o&&x===null){x=wade.playAudio(sounds.loop,true);if(x<0){y.removeClass('music-on');y.addClass('music-off');P.title='Enable music';o=false}}}wade.app.onMouseDown=function(){if(wade.isMouseDown(0)||(wade.isMouseDown()&&isMobileDevice)){l.style.display='none';g.style.cursor='none';clearTimeout(r);wade.removeSceneObject(p);wade.clearScene();wade.app.startGame();wade.app.onMouseDown=0}}};this.startGame=function(){var z=new Sprite(images.ship);var i=wade.getMousePosition();j=new SceneObject(z,0,i.x,i.y);wade.addSceneObject(j);wade.setMainLoop(function(){M=L;if(wade.isMouseDown(2)&&cheat){M=50}var a=W+1/M;var c=wade.getAppTime();if((wade.isMouseDown(0)||wade.isMouseDown(2)||(wade.isMouseDown()&&isMobileDevice))&&c>=a){W=c;var d=j.getPosition();var b=j.getSprite().getSize();var e=new Sprite(images.shipBullet);var f=new SceneObject(e,0,d.x,d.y-b.y/2);wade.addSceneObject(f);wade.playAudio(sounds.shoot,false);D.push(f);f.moveTo(d.x,-500,600);f.onMoveComplete=function(){wade.removeSceneObject(this);wade.removeObjectFromArray(this,D)};if(k>0&&!cheat&&M<60){k-=10}if(k<0||k=='NaN'){k=0}}if(D.length>0){for(var g=D.length-1;g>=0;g--){var l=D[g].getOverlappingObjects();if(l.length>0){for(var h=0;h<l.length;h++){if(l[h].isEnemy){var E=l[h].getPosition();wade.app.explosion(E,1);wade.playAudio(sounds.hit,false);if(l[h].health>0){l[h].health-=I}if(l[h].health<=0){wade.app.explosion(E,2);wade.playAudio(sounds.explode,false);wade.removeSceneObject(l[h]);k+=Math.floor(l[h].initialHealth/10)*t}wade.removeSceneObject(D[g]);wade.removeObjectFromArrayByIndex(g,D);break}}}}}if(Math.floor(k/1000)>t-1&&t<5){t+=1;if(!cheat){q=100}if(J>200){J-=100}if(C>400){C-=100}if(L<50){L+=1}if(I<600){I+=(t*10)}}N.getSprite().setText(q);U.getSprite().setText(t);T.getSprite().setText(Math.floor(k))},'fire');wade.setMainLoop(function(){var a=j.getOverlappingObjects(false,'axis-aligned');var c=false;var d=1;if(a.length>0){for(var b=0;b<a.length;b++){if(typeof(a[b])!='undefined'){if(a[b].isEnemy||a[b].isEnemyBullet){if(typeof(a[b])!='undefined'&&j.overlapsObject(a[b],'pixel')){if(a[b].health>0){a[b].health-=Math.floor(I/10)}if(typeof(a[b])!='undefined'&&(a[b].isEnemyBullet||a[b].health<=0)){wade.removeSceneObject(a[b]);wade.removeObjectFromArrayByIndex(b,a)}if(typeof(a[b])!='undefined'){d=a[b].damage||d}c=true;break}}}}}if(c){c=false;wade.app.explosion(j.getPosition(),0);wade.playAudio(sounds.hit,false);if(q>0){q-=d}if(q<0||q=='NaN'){q=0}N.getSprite().setText(q);if(q<=0){wade.app.explosion(j.getPosition(),2);wade.playAudio(sounds.explode,false);wade.removeSceneObject(j);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');var e=wade.retrieveLocalObject('shooterData');var f=(e&&e.oldHighScore)||0;if(k>f){e={oldHighScore:f,newHighScore:k};wade.storeLocalObject('shooterData',e)}var g=setTimeout(function(){w=false;clearTimeout(B);clearTimeout(r);wade.clearScene();wade.app.init()},250)}}},'die');if(!w){if(cheat){q=999}else{q=100}k=0;t=1;L=4;I=200;w=true}var u=new Sprite(images.scoreIcon);var p=new SceneObject(u,0,wade.getScreenWidth()/2-20,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(p);var F=new TextSprite(k.toString(),'32pt Highspeed','#f88','right');T=new SceneObject(F,0,wade.getScreenWidth()/2-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(T);var m=new Sprite(images.healthIcon);var v=new SceneObject(m,0,-120,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(v);var K=new TextSprite(q.toString(),'32pt Highspeed','#f88','center');N=new SceneObject(K,0,-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(N);var A=new Sprite(images.levelIcon);var V=new SceneObject(A,0,20-(wade.getScreenWidth()/2),-12-wade.getScreenHeight()/2+30);wade.addSceneObject(V);var n=new TextSprite(t,'32pt Highspeed','#f88','left');U=new SceneObject(n,0,40-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(U);B=setTimeout(wade.app.spawnEnemy,J);r=setTimeout(wade.app.spawnAsteroid,C)};$(window).blur(function(){if(w&&!H){console.log('Game paused due to focus loss.');H=true;wade.pauseSimulation();clearTimeout(B);clearTimeout(r);wade.app.onMouseMove=null;wade.addSceneObject(G);gameObj.style.cursor='default'}else{if(!w){console.log('Asteroid timeout cleared due to focus loss.');clearTimeout(r)}}return false});$(window).focus(function(){if(!w){r=setTimeout(wade.app.spawnAsteroid,C)}});this.onKeyDown=function(c){if(w&&c.keyCode==32){H=!H;if(H){wade.pauseSimulation();clearTimeout(B);clearTimeout(r);wade.app.onMouseMove=null;wade.addSceneObject(G);gameObj.style.cursor='default'}else{gameObj.style.cursor='none';B=setTimeout(wade.app.spawnEnemy,J);r=setTimeout(wade.app.spawnAsteroid,C);wade.removeSceneObject(G);wade.resumeSimulation();wade.app.onMouseMove=function(a){if(typeof(j)!='undefined'){handleMouseMove(j,images,a)}}}}return false};this.onMouseMove=function(a){if(typeof(j)!='undefined'){return handleMouseMove(j,images,a)}};this.explosion=function(a,c){if(typeof(c)=='undefined'||c===null||typeof(images.boom[c])=='undefined'){c=0}var d=new Animation(images.boom[c].file,images.boom[c].x,images.boom[c].y,images.boom[c].speed);var b=new Sprite();b.setSize(100,100);b.addAnimation('boom',d);var e=new SceneObject(b,0,a.x,a.y);wade.addSceneObject(e);e.playAnimation('boom');e.onAnimationEnd=function(){wade.removeSceneObject(this)}};this.spawnAsteroid=function(){var a;var c=getRandomInt(0,9);a=new Sprite(images.asteroids[c]);var d=(Math.random()-0.5)*wade.getScreenWidth();var b=(Math.random()-0.5)*wade.getScreenWidth();var e=-wade.getScreenHeight()/2-a.getSize().y/2;var f=-e;var g=new SceneObject(a,0,d,e);wade.addSceneObject(g);g.moveTo(b,f,200);g.isEnemy=true;g.isAsteroid=true;g.health=S[c];g.initialHealth=S[c];g.damage=Math.floor(S[c]/100);g.onMoveComplete=function(){wade.removeSceneObject(this)};r=setTimeout(wade.app.spawnAsteroid,C)};this.spawnEnemy=function(){var u;var p=t-1;var F=Object.keys(images.enemies).length-1;if(p>F){p=F}var m=getRandomInt(0,p);u=new Sprite(images.enemies[m]);var v=(Math.random()-0.5)*wade.getScreenWidth();var K=(Math.random()-0.5)*wade.getScreenWidth();var A=-wade.getScreenHeight()/2-u.getSize().y/2;var V=-A;var n=new SceneObject(u,0,v,A);wade.addSceneObject(n);n.moveTo(K,V,200);n.isEnemy=true;n.isAsteroid=false;n.health=R[m];n.initialHealth=R[m];n.damage=Math.floor(R[m]/100);n.onMoveComplete=function(){wade.removeSceneObject(this)};n.originalStep=n.step;n.step=function(){this.originalStep();var a=this.getPosition();var c=j.getPosition();var d=Math.atan2(c.y-a.y,c.x-a.x)-3.14/2;this.setRotation(d)};n.fire=function(){var a=this.getSprite().getSize();var c=this.getPosition();var d=j.getPosition();var b=d.x-c.x;var e=d.y-c.y;var f=Math.sqrt(b*b+e*e);b/=f;e/=f;var g=c.x+b*a.x/2;var l=c.y+e*a.y/2;var h=g+b*3000;var E=l+e*3000;var z=new Sprite(images.enemyBullets[m].file);var i=new SceneObject(z,0,g,l);i.isEnemyBullet=true;i.damage=images.enemyBullets[m].damage;wade.addSceneObject(i);i.moveTo(h,E,200);i.onMoveComplete=function(){wade.removeSceneObject(this)};this.schedule(images.enemyBullets[m].delay,'fire')};n.schedule(300,'fire');B=setTimeout(wade.app.spawnEnemy,J)};this.toggleRenderer=function(){s=!s;var a={force2d:s};wade.storeLocalObject('force2d',a);setCookie('force2d',s,365);clearTimeout(B);clearTimeout(r);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');w=false;wade.clearScene();wade.app.init()};this.toggleMusic=function(){if(wade.isWebAudioSupported()){if(o){if(x>-1){wade.stopAudio(x)}else{wade.stopAudio()}o=false;y.removeClass('music-on');y.addClass('music-off');P.title='Enable music'}else{if(x>-1){wade.stopAudio(x)}else{wade.stopAudio()}x=wade.playAudio(sounds.loop,true);o=true;y.removeClass('music-off');y.addClass('music-on');P.title='Disable music'}var a={music:o};wade.storeLocalObject('music',a);setCookie('music',o,365)}}};function getRandomInt(a,c){return Math.floor(Math.random()*(c-a+1))+a}function padStrings(a){var c='       ';var d;if(typeof(a)=='object'){d={};for(var b in a){d[b]=c+a[b]+c}}else{d=c+a+c}return d}function handleMouseMove(a,c,d){var b=a.getPosition();var e=a.getSprite();var f=null;if(b.x<0){if(b.x>d.screenPosition.x){f=new Animation(c.fly_left,5,1,30)}else if(b.x<d.screenPosition.x){f=new Animation(c.fly_right,5,1,30)}}else if(b.x>0){if(b.x<d.screenPosition.x){f=new Animation(c.fly_right,5,1,30)}else if(b.x>d.screenPosition.x){f=new Animation(c.fly_left,5,1,30)}}if(f!==null){e.addAnimation('fly',f);a.playAnimation('fly');a.onAnimationEnd=function(){e.setImageFile(c.ship)}}return a&&a.setPosition(d.screenPosition.x,d.screenPosition.y)}