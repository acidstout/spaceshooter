var version='1.1.8';var App=function(){'use strict';var bd=false||checkForMobileDevice();var bi=false||getBrowserVersion('Trident/([0-9]{1,}[.0-9]{0,})');var p;var w=false;var x=false;var N=null;var y=false;var K=1;var bj=0;var U=4;var V=4;var O=200;var bm=1000;var be=[400,600,800,1500,5000];var P=2000;var L;var bf=[200,200,200,300,400,400,600,500,400,600];var F=1000;var z;var A={cannister:{images:['../img/powerups/cannister0.png','../img/powerups/cannister1.png','../img/powerups/cannister2.png'],values:[100,1000,10000],name:'cannister'},heart:{images:['../img/powerups/heart0.png','../img/powerups/heart1.png','../img/powerups/heart2.png'],values:[5,10,20],name:'heart'},missiles:{images:['../img/powerups/missiles0.png','../img/powerups/missiles1.png','../img/powerups/missiles2.png'],values:[25,50,100],name:'missiles'},shield:{images:['../img/powerups/shield0.png','../img/powerups/shield1.png','../img/powerups/shield2.png'],values:[4,7,10],name:'shield'},targeting:{images:['../img/powerups/targeting0.png','../img/powerups/targeting1.png','../img/powerups/targeting2.png'],values:[10,20,30],name:'targeting'}};var G=[];var t=0;var u=0;var B=0;var bg;var i=0;var Q=1000;var M={data:'overkill'};var W;var X;var Y;var R;var s=100;var bh;var C=1;var H=null;var l=false;var n=wade.retrieveLocalObject(M.data);const sissy=(n&&n.sissy)||false;var I=(n&&n.highscore)||0;var e={logo:'../img/logo.png',ship:'../img/ship.png',boom:{0:{file:'../img/animations/explosion/explode_4x4_ship.png',speed:30,x:4,y:4},1:{file:'../img/animations/explosion/explode_4x4_ring.png',speed:30,x:4,y:4},2:{file:'../img/animations/explosion/explode_5x3_enemy.png',speed:30,x:5,y:3}},flyLeft:'../img/animations/ship/fly_left.png',flyRight:'../img/animations/ship/fly_right.png',shipBullet:'../img/bullets/bullet_ship.png',shipMissile:'../img/bullets/missile_ship.png',enemyBullets:{0:{file:'../img/bullets/bullet0.png',delay:600,damage:1},1:{file:'../img/bullets/bullet1.png',delay:500,damage:3},2:{file:'../img/bullets/bullet2.png',delay:400,damage:5},3:{file:'../img/bullets/bullet3.png',delay:300,damage:10},4:{file:'../img/bullets/bullet4.png',delay:200,damage:20}},enemies:{0:'../img/enemies/enemy0.png',1:'../img/enemies/enemy1.png',2:'../img/enemies/enemy2.png',3:'../img/enemies/enemy3.png',4:'../img/enemies/enemy4.png'},asteroids:{0:'../img/asteroids/asteroid0.png',1:'../img/asteroids/asteroid1.png',2:'../img/asteroids/asteroid2.png',3:'../img/asteroids/asteroid3.png',4:'../img/asteroids/asteroid4.png',5:'../img/asteroids/asteroid5.png',6:'../img/asteroids/asteroid6.png',7:'../img/asteroids/asteroid7.png',8:'../img/asteroids/asteroid8.png',9:'../img/asteroids/asteroid9.png'},healthIcon:'../img/icons/heart.png',levelIcon:'../img/icons/star.png',scoreIcon:'../img/icons/trophy.png',missilesIcon:'../img/icons/missiles.png',shieldsIcon:'../img/icons/shields.png',targetingIcon:'../img/icons/targeting.png'};var m={shoot:'../sounds/shoot.mp3',missile:'../sounds/missile.mp3',hit:'../sounds/hit.mp3',explode:'../sounds/explode.mp3',loop:'../sounds/loop.mp3',menu:'../sounds/menu.mp3',spawn:'../sounds/spawn.mp3',powerup:'../sounds/powerup.mp3'};var bk=document.getElementById('toggleRendererTitle');var Z=$('#toggleRendererBtn');var ba=document.getElementById('toggleMusicTitle');var D=$('#toggleMusicBtn');var bb=document.getElementById('game');var bl=document.getElementById('game-icons');$('#version').text(version+', WADE '+wade.getVersion());$(window).blur(function(){if(x&&!w){console.log('Game paused due to focus loss.')}wade.app.pauseGame()});$(window).focus(function(){if(!x){console.log('Game resumed due to focus gain.');z=wade.setTimeout(wade.app.spawnAsteroid,F);if(l){wade.app.musicOn()}wade.resumeSimulation()}});wade.preventIframe();wade.setLoadingBar(true,{x:0,y:0},'#333333','#222222');wade.setLoadingImages('../img/loading.svg');this.padStrings=function(a){var b='       ';var d;if(typeof(a)==='object'){d={};for(var c in a){if({}.hasOwnProperty.call(a,c)){d[c]=b+a[c]+b}}}else{d=b+a+b}return d};this.load=function(){var a=0;for(a=0;a<Object.keys(e.asteroids).length;a++){wade.loadImage(e.asteroids[a])}wade.loadImage(e.logo);for(a=0;a<Object.keys(e.boom).length;a++){wade.loadImage(e.boom[a].file)}wade.loadImage(e.shipBullet);wade.loadImage(e.shipMissile);for(a=0;a<Object.keys(e.enemyBullets).length;a++){wade.loadImage(e.enemyBullets[a].file)}for(a=0;a<Object.keys(e.enemies).length;a++){wade.loadImage(e.enemies[a])}Object.keys(A).forEach(key=>{for(a=0;a<A[key].images.length;a++){wade.loadImage(A[key].images[a])}});wade.loadImage(e.ship);wade.loadImage(e.flyLeft);wade.loadImage(e.flyRight);wade.loadImage(e.healthIcon);wade.loadImage(e.levelIcon);wade.loadImage(e.scoreIcon);wade.loadImage(e.missilesIcon);wade.loadImage(e.shieldsIcon);wade.loadImage(e.targetingIcon);var b=wade.isWebAudioSupported()?'loadAudio':'preloadAudio';wade[b](m.shoot);wade[b](m.missile);wade[b](m.hit);wade[b](m.explode);wade[b](m.loop);wade[b](m.menu);wade[b](m.spawn);wade[b](m.powerup);var d=null;d=setInterval(function(){console.log('Loaded '+Math.round(wade.getLoadingPercentage())+'% of data.');if(wade.getLoadingPercentage()>=100){clearInterval(d)}},1000)};this.init=function(){n=wade.retrieveLocalObject(M.data);y=(n&&n.force2d)||y;wade.setLayerRenderMode(K,'2d');wade.useQuadtree(K,false);Z.removeClass('fa-toggle-on');Z.addClass('fa-toggle-off');bk.title='Enable WebGL';if(!y){wade.setLayerRenderMode(K,'webgl');Z.removeClass('fa-toggle-off');Z.addClass('fa-toggle-on');bk.title='Disable WebGL'}if(wade.isWebAudioSupported()){l=(n&&n.music)||l;if(wade.getWebAudioContext().state==='suspended'){l=false}if(l){D.removeClass('music-off');D.addClass('music-on');ba.title='Disable music'}}else{l=false}wade.setMinScreenSize($(window).width(),$(window).height());wade.setMaxScreenSize($(window).width(),$(window).height());wade.setResolutionFactor(1);if(bd){wade.setMinScreenSize($(window).width()*3,$(window).height()*3);wade.setMaxScreenSize($(window).width()*3,$(window).height()*3);wade.setResolutionFactor(0.5)}var a=wade.getLayerRenderMode(K);var b={insertCoin:'- INSERT COIN -',highscoreIs:'HIGHSCORE IS %i POINTS',youScored:'YOU %s %i POINTS'};if(a==='webgl'){b=wade.app.padStrings(b)}var d=new TextSprite(b.insertCoin,'36pt Highspeed','white','center');d.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,d.draw));var c=new SceneObject();c.addSprite(d,{y:320});wade.app.getHighestScore(i,c,b);if(i>0){var f=Base64.decode('U0NPUkVE');if(sissy){f=Base64.decode('Q0hFQVRFRA==')}else{$('#highscoreWrapper').fadeToggle();wade.app.loadHighscore(i)}var g=b.youScored.replace('%s',f);g=g.replace('%i',i);if(a==='webgl'){g=wade.app.padStrings(g)}c.addSprite(new TextSprite(g,'24pt Highspeed','white','center'),{y:120});if(i>I){var h=Base64.decode('TkVXIEhJR0hTQ09SRQ==');I=i;i=0;if(sissy){h+=Base64.decode('IE5PVCBTQVZFRA==')}h+='!';if(a==='webgl'){h=wade.app.padStrings(h)}var q=new TextSprite(h,'24pt Highspeed','yellow','center');c.addSprite(q,{y:160})}}c.addSprite(new Sprite(e.logo),{y:-200});N=new SceneObject();var j=new TextSprite('PAUSED','32pt Highspeed','yellow','center');j.setDrawFunction(wade.drawFunctions.blink_(0.5,0.5,j.draw));N.addSprite(new Sprite(e.logo),{y:-200});N.addSprite(j,{y:160});bl.style.display='block';bb.style.cursor='default';wade.addSceneObject(c);var k=null;k=setInterval(function(){if(wade.getLoadingPercentage()>=100){console.log('Initializing asteroids on main screen.');z=wade.setTimeout(wade.app.spawnAsteroid,F);clearInterval(k)}},1000);if(l){wade.app.musicOn()}wade.app.onMouseDown=function(){if(wade.isMouseDown(0)||(wade.isMouseDown()&&(bd||bi))){bl.style.display='none';bb.style.cursor='none';wade.clearTimeout(z);wade.removeSceneObject(c);wade.clearScene();wade.removeUnusedLayers([1]);wade.clearCanvas(K);wade.app.onMouseDown=0;wade.app.startGame()}}};this.getHighestScore=function(c,f,g){var h=setInterval(function(){var a={'action':'getHighestScore'};var b=JSON.stringify(a);var d=Base64.encode(b);$.ajax({url:'php/backend.php',type:'POST',data:'data='+d,success(result){if(result===null||result===''||result==='FAILED'){result=I}if(c<=0||result>c){g.highscoreIs=g.highscoreIs.replace('%i',result);f.addSprite(new TextSprite(g.highscoreIs,'24pt Highspeed','yellow','center'),{y:160})}I=result;clearInterval(h)},error(xhr,status,code){console.warn('getHighestScore(): AJAX call returned: '+status+': '+code)}})},1000)};this.loadHighscore=function(d){var c={'action':'loadScore'};var f=JSON.stringify(c);var g=Base64.encode(f);var h='Highscore not loaded!';d=(typeof(d)!=='undefined')?d:i;$.ajax({url:'php/backend.php',type:'POST',data:'data='+g,success(result){if(result!=='FAILED'){var q='';var j='<tr><td id="playerNameCell"><input type="text" class="highscore" id="playerName" maxlength="20" value="" placeholder="Enter your name"/></td><td>'+d+'</td></tr>';var k=JSON.parse(result);var J=Object.keys(k).length;var r=false;$.each(k,function(a,b){if(d>0&&d>=b.score&&!r){q+=j;r=true}if(a<9||!r){q+='<tr><td>'+b.player+'</td><td>'+b.score+'</td></tr>'}});if(J<10&&!r&&d>0){q+=j;r=true}$('#highscoreTable').html(q);if(r){$('#playerName').focus();$('#playerName').on('keypress',function(a){if(a.keyCode===13){a.preventDefault();var b=$('#playerName').val();if(b.length>0){$(this).prop('disabled',true);wade.app.saveHighscore(d,b);i=0;$('#playerName').remove();$('#playerNameCell').text(b)}return false}})}}else{console.warn('AJAX call by loadHighscore() returned: '+result)}},error(xhr,status,code){console.warn('AJAX call by loadHighscore() returned: '+status+': '+code);$('.msg').html(h)}})};this.saveHighscore=function(a,b){a=(typeof(a)!=='undefined')?a:i;b=(typeof(b)!=='undefined')?b:'Player';var d='Highscore not saved!';var c={'action':'saveScore','player':b,'score':a};var f=JSON.stringify(c);var g=Base64.encode(f);$.ajax({url:'php/backend.php',type:'POST',data:'data='+g,success(result){if(result==='OK'){d='Highscore saved!'}else{n={force2d:y,music:l,highscore:a};wade.storeLocalObject(M.data,n)}$('.msg').html(d)},error(xhr,status,code){console.warn('saveHighscore() returned: '+status+': '+code);$('.msg').html(d)}})};this.handleMouseMove=function(a,b,d){var c=a.getPosition();var f=a.getSprite();var g=null;if(c.x<0){if(c.x>d.screenPosition.x){g=new Animation(b.flyLeft,5,1,30)}else if(c.x<d.screenPosition.x){g=new Animation(b.flyRight,5,1,30)}}else if(c.x>0){if(c.x<d.screenPosition.x){g=new Animation(b.flyRight,5,1,30)}else if(c.x>d.screenPosition.x){g=new Animation(b.flyLeft,5,1,30)}}if(g!==null){f.addAnimation('fly',g);a.playAnimation('fly');a.onAnimationEnd=function(){f.setImageFile(b.ship)}}return a&&a.setPosition(d.screenPosition.x,d.screenPosition.y)};this.startGame=function(){console.log('Re-enabling quadtree optimizations.');wade.useQuadtree(K,true);var bc=new Sprite(e.ship);var v=wade.getMousePosition();p=new SceneObject(bc,0,v.x,v.y);wade.addSceneObject(p);var E=false;wade.setMainLoop(function(){V=U;if(wade.isMouseDown(2)&&sissy){V=50}var a=bj+1/V;var b=wade.getAppTime();if((wade.isMouseDown(0)||wade.isMouseDown(2)||(wade.isMouseDown()&&(bd||bi)))&&b>=a){bj=b;var d=p.getPosition();var c=p.getSprite().getSize();var f;var g;if(u>0){u--;g=m.missile;f=new Sprite(e.shipMissile);E=true}else{g=m.shoot;f=new Sprite(e.shipBullet);E=false}var h=new SceneObject(f,0,d.x,d.y-c.y/2);wade.addSceneObject(h);wade.playAudio(g,false);G.push(h);h.moveTo(d.x,-500,600);h.onMoveComplete=function(){wade.removeSceneObject(this);wade.removeObjectFromArray(this,G)};if(i>0&&!sissy&&V<60){i-=10}if(i<0||i==='NaN'){i=0}}if(G.length>0){for(var q=G.length-1;q>=0;q--){var j=G[q].getOverlappingObjects();if(j.length>0){for(var k=0;k<j.length;k++){if(j[k].isEnemy){var J=j[k].getPosition();wade.app.explosion(J,1);wade.playAudio(m.hit,false);if(j[k].health>0){if(E){j[k].health-=bm}else{j[k].health-=O}}if(j[k].health<=0){wade.app.explosion(J,2);wade.playAudio(m.explode,false);var r=j[k].isAsteroid;wade.removeSceneObject(j[k]);i+=Math.floor(j[k].initialHealth/10)*C;var S=wade.app.getRandomInt(0,9);var T=[4,9];if(r&&T.indexOf(S)>-1){wade.app.spawnPowerUp(J)}}wade.removeSceneObject(G[q]);wade.removeObjectFromArrayByIndex(q,G);break}}}}}if(Math.floor(i/Q)>0){if(i>=Q){Q=Math.pow(10,C)*Q;C+=1}if(!sissy){s+=100}if(P>200){P-=100}if(F>400){F-=100}if(U<50){U+=1}if(O<600){O+=(C*10)}}W.getSprite().setText(s);bh.getSprite().setText(C);X.getSprite().setText(u);bg.getSprite().setText(Math.floor(i)+', Left: '+(Q-Math.floor(i)));Y.getSprite().setText(t);R.getSprite().setText(B)},'fire');wade.setMainLoop(function(){var a=p.getOverlappingObjects(false,'axis-aligned');var b=false;var d=1;if(a.length>0){for(var c=0;c<a.length;c++){if(typeof(a[c])!=='undefined'){if(a[c].isEnemy||a[c].isEnemyBullet||a[c].isPowerUp){if(p.overlapsObject(a[c],'pixel')){if(a[c].isPowerUp){wade.playAudio(m.powerup,false);switch(a[c].name){case'cannister':i+=a[c].initialValue;break;case'heart':s+=a[c].initialValue;break;case'missiles':if(u<250){u+=a[c].initialValue}break;case'shield':if(t<100){t+=a[c].initialValue}break;case'targeting':if(B<10){B+=a[c].initialValue}break}wade.removeSceneObject(a[c]);wade.removeObjectFromArrayByIndex(c,a);b=false;break}if(a[c].health>0){a[c].health-=Math.floor(O/10)}d=a[c].damage||d;if(a[c].isEnemyBullet||a[c].health<=0){wade.removeSceneObject(a[c]);wade.removeObjectFromArrayByIndex(c,a)}b=true;break}}}b=false}}if(b){b=false;wade.app.explosion(p.getPosition(),0);wade.playAudio(m.hit,false);if(s>0){if(t>0){t-=d}else{s-=d}}if(t<0||t==='NaN'){t=0}if(s<0||s==='NaN'){s=0}if(u<0||u==='NaN'){u=0}W.getSprite().setText(s);X.getSprite().setText(u);Y.getSprite().setText(t);R.getSprite().setText(B)}if(s<=0){var f=wade.app.explosion(p.getPosition(),2);wade.playAudio(m.explode,false);wade.removeSceneObject(p);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');if(!sissy&&i>I){n={force2d:y,music:l,highscore:i};wade.storeLocalObject(M.data,n)}var g=setInterval(function(){if(!f.isPlaying()){x=false;if(l){wade.app.musicOn()}wade.clearTimeout(L);wade.clearTimeout(z);clearInterval(g);wade.clearScene();wade.app.init()}},100)}},'die');if(!x){if(sissy){s=999}else{s=100}i=0;C=1;U=4;O=200;x=true;if(l){wade.app.musicOn()}}var o=new Sprite(e.levelIcon);var bn=new SceneObject(o,0,20-(wade.getScreenWidth()/2),-12-wade.getScreenHeight()/2+30);wade.addSceneObject(bn);var bo=new TextSprite(C,'32pt Highspeed','#f88','left');bh=new SceneObject(bo,0,40-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(bh);var bp=new Sprite(e.targetingIcon);var bq=new SceneObject(bp,0,110-(wade.getScreenWidth()/2),-10-wade.getScreenHeight()/2+30);wade.addSceneObject(bq);var br=new TextSprite(B.toString(),'32pt Highspeed','#f88','center');R=new SceneObject(br,0,170-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(R);var bs=new Sprite(e.missilesIcon);var bt=new SceneObject(bs,0,250-(wade.getScreenWidth()/2),-10-wade.getScreenHeight()/2+30);wade.addSceneObject(bt);var bu=new TextSprite(u.toString(),'32pt Highspeed','#f88','center');X=new SceneObject(bu,0,310-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(X);var bv=new Sprite(e.shieldsIcon);var bw=new SceneObject(bv,0,390-(wade.getScreenWidth()/2),-10-wade.getScreenHeight()/2+30);wade.addSceneObject(bw);var bx=new TextSprite(t.toString(),'32pt Highspeed','#f88','center');Y=new SceneObject(bx,0,450-(wade.getScreenWidth()/2),4-wade.getScreenHeight()/2+30);wade.addSceneObject(Y);var by=new Sprite(e.healthIcon);var bz=new SceneObject(by,0,-120,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(bz);var bA=new TextSprite(s.toString(),'32pt Highspeed','#f88','center');W=new SceneObject(bA,0,-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(W);var bB=new Sprite(e.scoreIcon);var bC=new SceneObject(bB,0,wade.getScreenWidth()/2-20,-10-wade.getScreenHeight()/2+30);wade.addSceneObject(bC);var bD=new TextSprite(i.toString(),'32pt Highspeed','#f88','right');bg=new SceneObject(bD,0,wade.getScreenWidth()/2-40,4-wade.getScreenHeight()/2+30);wade.addSceneObject(bg);L=wade.setTimeout(wade.app.spawnEnemy,P);z=wade.setTimeout(wade.app.spawnAsteroid,F)};this.pauseGame=function(){wade.clearTimeout(z);wade.app.musicOff();if(x&&!w){w=true;wade.clearTimeout(L);wade.app.onMouseMove=null;wade.addSceneObject(N);bb.style.cursor='default'}wade.pauseSimulation()};this.onKeyDown=function(b){if(x&&b.keyCode===32){if(!w){console.log('Game paused by user.');wade.app.pauseGame();w=true}else{w=false;console.log('Game resumed by user.');bb.style.cursor='none';L=wade.setTimeout(wade.app.spawnEnemy,P);z=wade.setTimeout(wade.app.spawnAsteroid,F);wade.removeSceneObject(N);if(l){wade.app.musicOn()}wade.resumeSimulation();wade.app.onMouseMove=function(a){if(typeof(p)!=='undefined'){wade.app.handleMouseMove(p,e,a)}}}}return false};this.onMouseMove=function(a){if(typeof(p)!=='undefined'){return wade.app.handleMouseMove(p,e,a)}};this.explosion=function(a,b){if(typeof(b)==='undefined'||b===null||typeof(e.boom[b])==='undefined'){b=0}var d=new Animation(e.boom[b].file,e.boom[b].x,e.boom[b].y,e.boom[b].speed);var c=new Sprite();c.setSize(100,100);c.addAnimation('boom',d);var f=new SceneObject(c,0,a.x,a.y);wade.addSceneObject(f);f.playAnimation('boom');f.onAnimationEnd=function(){wade.removeSceneObject(this)};return d};this.getRandomCoords=function(a){return{x1:(Math.random()-0.5)*wade.getScreenWidth(),y1:-wade.getScreenHeight()/2-a.getSize().y/2,x2:(Math.random()-0.5)*wade.getScreenWidth(),y2:Math.abs(wade.getScreenHeight()/2-a.getSize().y/2)}};this.getRandomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};this.spawnPowerUp=function(a){var b;var d=wade.app.getRandomInt(0,2);var c=wade.app.getRandomInt(0,4);var f;switch(c){case 1:f=A.heart;break;case 2:f=A.missiles;break;case 3:f=A.shield;break;case 4:f=A.targeting;break;default:f=A.cannister;break}if(f!==A.targeting||B<=0){b=new Sprite(f.images[d]);var g=wade.app.getRandomCoords(b);var h=new SceneObject(b,0,a.x,a.y);wade.addSceneObject(h);h.moveTo(g.x2,g.y2,200);h.isEnemy=false;h.isAsteroid=false;h.isPowerUp=true;h.initialValue=f.values[d];h.name=f.name;h.damage=0;wade.playAudio(m.spawn,false);h.onMoveComplete=function(){wade.removeSceneObject(this)}}};this.spawnAsteroid=function(){console.log('spawnAsteroid, Game paused = '+w);if(w){return false}var a;var b=wade.app.getRandomInt(0,9);a=new Sprite(e.asteroids[b]);var d=wade.app.getRandomCoords(a);var c=new SceneObject(a,0,d.x1,d.y1);wade.addSceneObject(c);c.moveTo(d.x2,d.y2,200);c.isEnemy=true;c.isAsteroid=true;c.isPowerUp=false;c.health=bf[b];c.initialHealth=bf[b];c.damage=Math.floor(bf[b]/100);c.onMoveComplete=function(){wade.removeSceneObject(this)};z=wade.setTimeout(wade.app.spawnAsteroid,F)};this.spawnEnemy=function(){if(w){return false}var S;var T=C-1;var bc=Object.keys(e.enemies).length-1;if(T>bc){T=bc}var v=wade.app.getRandomInt(0,T);S=new Sprite(e.enemies[v]);var E=wade.app.getRandomCoords(S);var o=new SceneObject(S,0,E.x1,E.y1);wade.addSceneObject(o);o.moveTo(E.x2,E.y2,200);o.isEnemy=true;o.isAsteroid=false;o.isPowerUp=false;o.health=be[v];o.initialHealth=be[v];o.damage=Math.floor(be[v]/100);o.onMoveComplete=function(){wade.removeSceneObject(this)};o.originalStep=o.step;o.step=function(){this.originalStep();var a=this.getPosition();var b=p.getPosition();var d=Math.atan2(b.y-a.y,b.x-a.x)-3.14/2;this.setRotation(d)};o.fire=function(){var a=this.getSprite().getSize();var b=this.getPosition();var d=p.getPosition();var c=d.x-b.x;var f=d.y-b.y;var g=Math.sqrt(c*c+f*f);c/=g;f/=g;var h=b.x+c*a.x/2;var q=b.y+f*a.y/2;var j=h+c*3000;var k=q+f*3000;var J=new Sprite(e.enemyBullets[v].file);var r=new SceneObject(J,0,h,q);r.isEnemyBullet=true;r.damage=e.enemyBullets[v].damage;wade.addSceneObject(r);r.moveTo(j,k,200);r.onMoveComplete=function(){wade.removeSceneObject(this)};this.schedule(e.enemyBullets[v].delay,'fire')};if(B>0){wade.setTimeout(function(){B--;R.getSprite().setText(B)},1000)}else{o.schedule(300,'fire')}L=wade.setTimeout(wade.app.spawnEnemy,P)};this.toggleRenderer=function(){y=!y;n={force2d:y,music:l,highscore:I};wade.storeLocalObject(M.data,n);wade.clearTimeout(L);wade.clearTimeout(z);wade.setMainLoop(null,'fire');wade.setMainLoop(null,'die');x=false;wade.clearScene();wade.app.init()};this.musicOn=function(){if(H>-1){wade.stopAudio(H)}else{wade.stopAudio()}if(x){H=wade.playAudio(m.loop,true)}else{H=wade.playAudio(m.menu,true)}if(H<0){D.removeClass('music-on');D.addClass('music-off');ba.title='Enable music';l=false}return false};this.musicOff=function(){if(H>-1){wade.stopAudio(H)}else{wade.stopAudio()}return false};this.toggleMusic=function(){var a=wade.getWebAudioContext();if(a.state==='suspended'){a.resume().then(()=>{console.log('Audio context resumed.')})}if(l){l=false;D.removeClass('music-on');D.addClass('music-off');ba.title='Enable music';wade.app.musicOff()}else{l=true;D.removeClass('music-off');D.addClass('music-on');ba.title='Disable music';wade.app.musicOn()}n={force2d:y,music:l,highscore:I};wade.storeLocalObject(M.data,n);return false}};